const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bgr5SMnN.js","assets/index-BiV4MhTh.css"])))=>i.map(i=>d[i]);
var ts=Object.defineProperty;var qi=Ct=>{throw TypeError(Ct)};var es=(Ct,L,mt)=>L in Ct?ts(Ct,L,{enumerable:!0,configurable:!0,writable:!0,value:mt}):Ct[L]=mt;var Kt=(Ct,L,mt)=>es(Ct,typeof L!="symbol"?L+"":L,mt),ze=(Ct,L,mt)=>L.has(Ct)||qi("Cannot "+mt);var t=(Ct,L,mt)=>(ze(Ct,L,"read from private field"),mt?mt.call(Ct):L.get(Ct)),tt=(Ct,L,mt)=>L.has(Ct)?qi("Cannot add the same private member more than once"):L instanceof WeakSet?L.add(Ct):L.set(Ct,mt),Z=(Ct,L,mt,S)=>(ze(Ct,L,"write to private field"),S?S.call(Ct,mt):L.set(Ct,mt),mt),j=(Ct,L,mt)=>(ze(Ct,L,"access private method"),mt);var ae=(Ct,L,mt,S)=>({set _(G){Z(Ct,L,G,mt)},get _(){return t(Ct,L,S)}});import{d as defineComponent,r as ref,o as onMounted,j as onBeforeUnmount,w as watch,k as __vitePreload,c as createElementBlock,t as toDisplayString,b as createCommentVNode,a as createBaseVNode,f as openBlock,_ as _export_sfc,l as reactive,m as useSessionStore,q as computed,B as BASE_URL,p as paper,s as createTextVNode,x as createVNode}from"./index-Bgr5SMnN.js";function getAugmentedNamespace(Ct){if(Ct.__esModule)return Ct;var L=Ct.default;if(typeof L=="function"){var mt=function S(){return this instanceof S?Reflect.construct(L,arguments,this.constructor):L.apply(this,arguments)};mt.prototype=L.prototype}else mt={};return Object.defineProperty(mt,"__esModule",{value:!0}),Object.keys(Ct).forEach(function(S){var G=Object.getOwnPropertyDescriptor(Ct,S);Object.defineProperty(mt,S,G.get?G:{enumerable:!0,get:function(){return Ct[S]}})}),mt}function commonjsRequire(Ct){throw new Error('Could not dynamically require "'+Ct+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(L,mt){module.exports=L.pdfjsLib=mt()})(globalThis,()=>(()=>{var __webpack_modules__=[,(Ct,L)=>{var $t;Object.defineProperty(L,"__esModule",{value:!0}),L.VerbosityLevel=L.Util=L.UnknownErrorException=L.UnexpectedResponseException=L.TextRenderingMode=L.RenderingIntentFlag=L.PromiseCapability=L.PermissionFlag=L.PasswordResponses=L.PasswordException=L.PageActionEventType=L.OPS=L.MissingPDFException=L.MAX_IMAGE_SIZE_TO_CACHE=L.LINE_FACTOR=L.LINE_DESCENT_FACTOR=L.InvalidPDFException=L.ImageKind=L.IDENTITY_MATRIX=L.FormatError=L.FeatureTest=L.FONT_IDENTITY_MATRIX=L.DocumentActionEventType=L.CMapCompressionType=L.BaseException=L.BASELINE_FACTOR=L.AnnotationType=L.AnnotationReplyType=L.AnnotationPrefix=L.AnnotationMode=L.AnnotationFlag=L.AnnotationFieldFlag=L.AnnotationEditorType=L.AnnotationEditorPrefix=L.AnnotationEditorParamsType=L.AnnotationBorderStyleType=L.AnnotationActionEventType=L.AbortException=void 0,L.assert=y,L.bytesToString=ft,L.createValidAbsoluteUrl=rt,L.getModificationDate=ot,L.getUuid=kt,L.getVerbosityLevel=B,L.info=z,L.isArrayBuffer=F,L.isArrayEqual=it,L.isNodeJS=void 0,L.normalizeUnicode=xt,L.objectFromMap=Pt,L.objectSize=Et,L.setVerbosityLevel=D,L.shadow=O,L.string32=vt,L.stringToBytes=pt,L.stringToPDFString=s,L.stringToUTF8String=w,L.unreachable=Q,L.utf8StringToString=U,L.warn=M;const mt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");L.isNodeJS=mt;const S=[1,0,0,1,0,0];L.IDENTITY_MATRIX=S;const G=[.001,0,0,.001,0,0];L.FONT_IDENTITY_MATRIX=G;const bt=1e7;L.MAX_IMAGE_SIZE_TO_CACHE=bt;const et=1.35;L.LINE_FACTOR=et;const V=.35;L.LINE_DESCENT_FACTOR=V;const R=V/et;L.BASELINE_FACTOR=R;const f={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};L.RenderingIntentFlag=f;const a={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};L.AnnotationMode=a;const N="pdfjs_internal_editor_";L.AnnotationEditorPrefix=N;const x={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};L.AnnotationEditorType=x;const p={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};L.AnnotationEditorParamsType=p;const c={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};L.PermissionFlag=c;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};L.TextRenderingMode=v;const b={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};L.ImageKind=b;const m={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};L.AnnotationType=m;const u={GROUP:"Group",REPLY:"R"};L.AnnotationReplyType=u;const _={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};L.AnnotationFlag=_;const g={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};L.AnnotationFieldFlag=g;const i={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};L.AnnotationBorderStyleType=i;const e={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};L.AnnotationActionEventType=e;const n={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};L.DocumentActionEventType=n;const r={O:"PageOpen",C:"PageClose"};L.PageActionEventType=r;const d={ERRORS:0,WARNINGS:1,INFOS:5};L.VerbosityLevel=d;const T={NONE:0,BINARY:1};L.CMapCompressionType=T;const o={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};L.OPS=o;const E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};L.PasswordResponses=E;let W=d.WARNINGS;function D(St){Number.isInteger(St)&&(W=St)}function B(){return W}function z(St){W>=d.INFOS&&console.log(`Info: ${St}`)}function M(St){W>=d.WARNINGS&&console.log(`Warning: ${St}`)}function Q(St){throw new Error(St)}function y(St,ht){St||Q(ht)}function C(St){switch(St==null?void 0:St.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function rt(St,ht=null,ut=null){if(!St)return null;try{if(ut&&typeof St=="string"){if(ut.addDefaultProtocol&&St.startsWith("www.")){const Wt=St.match(/\./g);(Wt==null?void 0:Wt.length)>=2&&(St=`http://${St}`)}if(ut.tryConvertEncoding)try{St=w(St)}catch{}}const Ft=ht?new URL(St,ht):new URL(St);if(C(Ft))return Ft}catch{}return null}function O(St,ht,ut,Ft=!1){return Object.defineProperty(St,ht,{value:ut,enumerable:!Ft,configurable:!0,writable:!1}),ut}const l=function(){function ht(ut,Ft){this.constructor===ht&&Q("Cannot initialize BaseException."),this.message=ut,this.name=Ft}return ht.prototype=new Error,ht.constructor=ht,ht}();L.BaseException=l;class h extends l{constructor(ht,ut){super(ht,"PasswordException"),this.code=ut}}L.PasswordException=h;class A extends l{constructor(ht,ut){super(ht,"UnknownErrorException"),this.details=ut}}L.UnknownErrorException=A;class Y extends l{constructor(ht){super(ht,"InvalidPDFException")}}L.InvalidPDFException=Y;class K extends l{constructor(ht){super(ht,"MissingPDFException")}}L.MissingPDFException=K;class k extends l{constructor(ht,ut){super(ht,"UnexpectedResponseException"),this.status=ut}}L.UnexpectedResponseException=k;class J extends l{constructor(ht){super(ht,"FormatError")}}L.FormatError=J;class at extends l{constructor(ht){super(ht,"AbortException")}}L.AbortException=at;function ft(St){(typeof St!="object"||(St==null?void 0:St.length)===void 0)&&Q("Invalid argument for bytesToString");const ht=St.length,ut=8192;if(ht<ut)return String.fromCharCode.apply(null,St);const Ft=[];for(let Wt=0;Wt<ht;Wt+=ut){const Ht=Math.min(Wt+ut,ht),X=St.subarray(Wt,Ht);Ft.push(String.fromCharCode.apply(null,X))}return Ft.join("")}function pt(St){typeof St!="string"&&Q("Invalid argument for stringToBytes");const ht=St.length,ut=new Uint8Array(ht);for(let Ft=0;Ft<ht;++Ft)ut[Ft]=St.charCodeAt(Ft)&255;return ut}function vt(St){return String.fromCharCode(St>>24&255,St>>16&255,St>>8&255,St&255)}function Et(St){return Object.keys(St).length}function Pt(St){const ht=Object.create(null);for(const[ut,Ft]of St)ht[ut]=Ft;return ht}function ct(){const St=new Uint8Array(4);return St[0]=1,new Uint32Array(St.buffer,0,1)[0]===1}function lt(){try{return new Function(""),!0}catch{return!1}}class I{static get isLittleEndian(){return O(this,"isLittleEndian",ct())}static get isEvalSupported(){return O(this,"isEvalSupported",lt())}static get isOffscreenCanvasSupported(){return O(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?O(this,"platform",{isWin:!1,isMac:!1}):O(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ht,ut;return O(this,"isCSSRoundSupported",(ut=(ht=globalThis.CSS)==null?void 0:ht.supports)==null?void 0:ut.call(ht,"width: round(1.5px, 1px)"))}}L.FeatureTest=I;const q=[...Array(256).keys()].map(St=>St.toString(16).padStart(2,"0"));class nt{static makeHexColor(ht,ut,Ft){return`#${q[ht]}${q[ut]}${q[Ft]}`}static scaleMinMax(ht,ut){let Ft;ht[0]?(ht[0]<0&&(Ft=ut[0],ut[0]=ut[1],ut[1]=Ft),ut[0]*=ht[0],ut[1]*=ht[0],ht[3]<0&&(Ft=ut[2],ut[2]=ut[3],ut[3]=Ft),ut[2]*=ht[3],ut[3]*=ht[3]):(Ft=ut[0],ut[0]=ut[2],ut[2]=Ft,Ft=ut[1],ut[1]=ut[3],ut[3]=Ft,ht[1]<0&&(Ft=ut[2],ut[2]=ut[3],ut[3]=Ft),ut[2]*=ht[1],ut[3]*=ht[1],ht[2]<0&&(Ft=ut[0],ut[0]=ut[1],ut[1]=Ft),ut[0]*=ht[2],ut[1]*=ht[2]),ut[0]+=ht[4],ut[1]+=ht[4],ut[2]+=ht[5],ut[3]+=ht[5]}static transform(ht,ut){return[ht[0]*ut[0]+ht[2]*ut[1],ht[1]*ut[0]+ht[3]*ut[1],ht[0]*ut[2]+ht[2]*ut[3],ht[1]*ut[2]+ht[3]*ut[3],ht[0]*ut[4]+ht[2]*ut[5]+ht[4],ht[1]*ut[4]+ht[3]*ut[5]+ht[5]]}static applyTransform(ht,ut){const Ft=ht[0]*ut[0]+ht[1]*ut[2]+ut[4],Wt=ht[0]*ut[1]+ht[1]*ut[3]+ut[5];return[Ft,Wt]}static applyInverseTransform(ht,ut){const Ft=ut[0]*ut[3]-ut[1]*ut[2],Wt=(ht[0]*ut[3]-ht[1]*ut[2]+ut[2]*ut[5]-ut[4]*ut[3])/Ft,Ht=(-ht[0]*ut[1]+ht[1]*ut[0]+ut[4]*ut[1]-ut[5]*ut[0])/Ft;return[Wt,Ht]}static getAxialAlignedBoundingBox(ht,ut){const Ft=this.applyTransform(ht,ut),Wt=this.applyTransform(ht.slice(2,4),ut),Ht=this.applyTransform([ht[0],ht[3]],ut),X=this.applyTransform([ht[2],ht[1]],ut);return[Math.min(Ft[0],Wt[0],Ht[0],X[0]),Math.min(Ft[1],Wt[1],Ht[1],X[1]),Math.max(Ft[0],Wt[0],Ht[0],X[0]),Math.max(Ft[1],Wt[1],Ht[1],X[1])]}static inverseTransform(ht){const ut=ht[0]*ht[3]-ht[1]*ht[2];return[ht[3]/ut,-ht[1]/ut,-ht[2]/ut,ht[0]/ut,(ht[2]*ht[5]-ht[4]*ht[3])/ut,(ht[4]*ht[1]-ht[5]*ht[0])/ut]}static singularValueDecompose2dScale(ht){const ut=[ht[0],ht[2],ht[1],ht[3]],Ft=ht[0]*ut[0]+ht[1]*ut[2],Wt=ht[0]*ut[1]+ht[1]*ut[3],Ht=ht[2]*ut[0]+ht[3]*ut[2],X=ht[2]*ut[1]+ht[3]*ut[3],gt=(Ft+X)/2,Lt=Math.sqrt((Ft+X)**2-4*(Ft*X-Ht*Wt))/2,Dt=gt+Lt||1,Ot=gt-Lt||1;return[Math.sqrt(Dt),Math.sqrt(Ot)]}static normalizeRect(ht){const ut=ht.slice(0);return ht[0]>ht[2]&&(ut[0]=ht[2],ut[2]=ht[0]),ht[1]>ht[3]&&(ut[1]=ht[3],ut[3]=ht[1]),ut}static intersect(ht,ut){const Ft=Math.max(Math.min(ht[0],ht[2]),Math.min(ut[0],ut[2])),Wt=Math.min(Math.max(ht[0],ht[2]),Math.max(ut[0],ut[2]));if(Ft>Wt)return null;const Ht=Math.max(Math.min(ht[1],ht[3]),Math.min(ut[1],ut[3])),X=Math.min(Math.max(ht[1],ht[3]),Math.max(ut[1],ut[3]));return Ht>X?null:[Ft,Ht,Wt,X]}static bezierBoundingBox(ht,ut,Ft,Wt,Ht,X,gt,Lt){const Dt=[],Ot=[[],[]];let Rt,$,H,st,_t,yt,wt,Tt;for(let Gt=0;Gt<2;++Gt){if(Gt===0?($=6*ht-12*Ft+6*Ht,Rt=-3*ht+9*Ft-9*Ht+3*gt,H=3*Ft-3*ht):($=6*ut-12*Wt+6*X,Rt=-3*ut+9*Wt-9*X+3*Lt,H=3*Wt-3*ut),Math.abs(Rt)<1e-12){if(Math.abs($)<1e-12)continue;st=-H/$,0<st&&st<1&&Dt.push(st);continue}wt=$*$-4*H*Rt,Tt=Math.sqrt(wt),!(wt<0)&&(_t=(-$+Tt)/(2*Rt),0<_t&&_t<1&&Dt.push(_t),yt=(-$-Tt)/(2*Rt),0<yt&&yt<1&&Dt.push(yt))}let Ut=Dt.length,Nt;const It=Ut;for(;Ut--;)st=Dt[Ut],Nt=1-st,Ot[0][Ut]=Nt*Nt*Nt*ht+3*Nt*Nt*st*Ft+3*Nt*st*st*Ht+st*st*st*gt,Ot[1][Ut]=Nt*Nt*Nt*ut+3*Nt*Nt*st*Wt+3*Nt*st*st*X+st*st*st*Lt;return Ot[0][It]=ht,Ot[1][It]=ut,Ot[0][It+1]=gt,Ot[1][It+1]=Lt,Ot[0].length=Ot[1].length=It+2,[Math.min(...Ot[0]),Math.min(...Ot[1]),Math.max(...Ot[0]),Math.max(...Ot[1])]}}L.Util=nt;const P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function s(St){if(St[0]>="ï"){let ut;if(St[0]==="þ"&&St[1]==="ÿ"?ut="utf-16be":St[0]==="ÿ"&&St[1]==="þ"?ut="utf-16le":St[0]==="ï"&&St[1]==="»"&&St[2]==="¿"&&(ut="utf-8"),ut)try{const Ft=new TextDecoder(ut,{fatal:!0}),Wt=pt(St);return Ft.decode(Wt)}catch(Ft){M(`stringToPDFString: "${Ft}".`)}}const ht=[];for(let ut=0,Ft=St.length;ut<Ft;ut++){const Wt=P[St.charCodeAt(ut)];ht.push(Wt?String.fromCharCode(Wt):St.charAt(ut))}return ht.join("")}function w(St){return decodeURIComponent(escape(St))}function U(St){return unescape(encodeURIComponent(St))}function F(St){return typeof St=="object"&&(St==null?void 0:St.byteLength)!==void 0}function it(St,ht){if(St.length!==ht.length)return!1;for(let ut=0,Ft=St.length;ut<Ft;ut++)if(St[ut]!==ht[ut])return!1;return!0}function ot(St=new Date){return[St.getUTCFullYear().toString(),(St.getUTCMonth()+1).toString().padStart(2,"0"),St.getUTCDate().toString().padStart(2,"0"),St.getUTCHours().toString().padStart(2,"0"),St.getUTCMinutes().toString().padStart(2,"0"),St.getUTCSeconds().toString().padStart(2,"0")].join("")}class At{constructor(){tt(this,$t,!1);this.promise=new Promise((ht,ut)=>{this.resolve=Ft=>{Z(this,$t,!0),ht(Ft)},this.reject=Ft=>{Z(this,$t,!0),ut(Ft)}})}get settled(){return t(this,$t)}}$t=new WeakMap,L.PromiseCapability=At;let dt=null,Mt=null;function xt(St){return dt||(dt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mt=new Map([["ﬅ","ſt"]])),St.replaceAll(dt,(ht,ut,Ft)=>ut?ut.normalize("NFKC"):Mt.get(Ft))}function kt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const St=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(St);else for(let ht=0;ht<32;ht++)St[ht]=Math.floor(Math.random()*255);return ft(St)}const jt="pdfjs_internal_id_";L.AnnotationPrefix=jt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Ct,mt,S,G,oe,Pe,V,R,f,a,N,x,p,c,v,we,m,u,$e,g,i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(n){if(typeof n=="string"||n instanceof URL?n={url:n}:(0,_util.isArrayBuffer)(n)&&(n={data:n}),typeof n!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!n.url&&!n.data&&!n.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const r=new PDFDocumentLoadingTask,{docId:d}=r,T=n.url?getUrlProp(n.url):null,o=n.data?getDataProp(n.data):null,E=n.httpHeaders||null,W=n.withCredentials===!0,D=n.password??null,B=n.range instanceof PDFDataRangeTransport?n.range:null,z=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let M=n.worker instanceof PDFWorker?n.worker:null;const Q=n.verbosity,y=typeof n.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(n.docBaseUrl)?n.docBaseUrl:null,C=typeof n.cMapUrl=="string"?n.cMapUrl:null,rt=n.cMapPacked!==!1,O=n.CMapReaderFactory||DefaultCMapReaderFactory,l=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,h=n.StandardFontDataFactory||DefaultStandardFontDataFactory,A=n.stopAtErrors!==!0,Y=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,K=n.isEvalSupported!==!1,k=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!_util.isNodeJS,J=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,at=typeof n.disableFontFace=="boolean"?n.disableFontFace:_util.isNodeJS,ft=n.fontExtraProperties===!0,pt=n.enableXfa===!0,vt=n.ownerDocument||globalThis.document,Et=n.disableRange===!0,Pt=n.disableStream===!0,ct=n.disableAutoFetch===!0,lt=n.pdfBug===!0,I=B?B.length:n.length??NaN,q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!_util.isNodeJS&&!at,nt=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:O===_display_utils.DOMCMapReaderFactory&&h===_display_utils.DOMStandardFontDataFactory&&C&&l&&(0,_display_utils.isValidFetchUrl)(C,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI),P=n.canvasFactory||new DefaultCanvasFactory({ownerDocument:vt}),s=n.filterFactory||new DefaultFilterFactory({docId:d,ownerDocument:vt}),w=null;(0,_util.setVerbosityLevel)(Q);const U={canvasFactory:P,filterFactory:s};if(nt||(U.cMapReaderFactory=new O({baseUrl:C,isCompressed:rt}),U.standardFontDataFactory=new h({baseUrl:l})),!M){const ot={verbosity:Q,port:_worker_options.GlobalWorkerOptions.workerPort};M=ot.port?PDFWorker.fromPort(ot):new PDFWorker(ot),r._worker=M}const F={docId:d,apiVersion:"3.11.174",data:o,password:D,disableAutoFetch:ct,rangeChunkSize:z,length:I,docBaseUrl:y,enableXfa:pt,evaluatorOptions:{maxImageSize:Y,disableFontFace:at,ignoreErrors:A,isEvalSupported:K,isOffscreenCanvasSupported:k,canvasMaxAreaInBytes:J,fontExtraProperties:ft,useSystemFonts:q,cMapUrl:nt?C:null,standardFontDataUrl:nt?l:null}},it={ignoreErrors:A,isEvalSupported:K,disableFontFace:at,fontExtraProperties:ft,enableXfa:pt,ownerDocument:vt,disableAutoFetch:ct,pdfBug:lt,styleElement:w};return M.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");const ot=_fetchDocument(M,F),At=new Promise(function(dt){let Mt;B?Mt=new _transport_stream.PDFDataTransportStream({length:I,initialData:B.initialData,progressiveDone:B.progressiveDone,contentDispositionFilename:B.contentDispositionFilename,disableRange:Et,disableStream:Pt},B):o||(Mt=(kt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(kt):(0,_display_utils.isValidFetchUrl)(kt.url)?new _displayFetch_stream.PDFFetchStream(kt):new _displayNetwork.PDFNetworkStream(kt))({url:T,length:I,httpHeaders:E,withCredentials:W,rangeChunkSize:z,disableRange:Et,disableStream:Pt})),dt(Mt)});return Promise.all([ot,At]).then(function([dt,Mt]){if(r.destroyed)throw new Error("Loading aborted");const xt=new _message_handler.MessageHandler(d,dt,M.port),kt=new WorkerTransport(xt,r,Mt,it,U);r._transport=kt,xt.send("Ready",null)})}).catch(r._capability.reject),r}async function _fetchDocument(n,r){if(n.destroyed)throw new Error("Worker was destroyed");const d=await n.messageHandler.sendWithPromise("GetDocRequest",r,r.data?[r.data.buffer]:null);if(n.destroyed)throw new Error("Worker was destroyed");return d}function getUrlProp(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(_util.isNodeJS&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(n){if(_util.isNodeJS&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return(0,_util.stringToBytes)(n);if(typeof n=="object"&&!isNaN(n==null?void 0:n.length)||(0,_util.isArrayBuffer)(n))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const L=class L{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ae(L,Ct)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var r,d,T;this.destroyed=!0;try{(r=this._worker)!=null&&r.port&&(this._worker._pendingDestroy=!0),await((d=this._transport)==null?void 0:d.destroy())}catch(o){throw(T=this._worker)!=null&&T.port&&delete this._worker._pendingDestroy,o}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};Ct=new WeakMap,tt(L,Ct,0);let PDFDocumentLoadingTask=L;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(r,d,T=!1,o=null){this.length=r,this.initialData=d,this.progressiveDone=T,this.contentDispositionFilename=o,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(r){this._rangeListeners.push(r)}addProgressListener(r){this._progressListeners.push(r)}addProgressiveReadListener(r){this._progressiveReadListeners.push(r)}addProgressiveDoneListener(r){this._progressiveDoneListeners.push(r)}onDataRange(r,d){for(const T of this._rangeListeners)T(r,d)}onDataProgress(r,d){this._readyCapability.promise.then(()=>{for(const T of this._progressListeners)T(r,d)})}onDataProgressiveRead(r){this._readyCapability.promise.then(()=>{for(const d of this._progressiveReadListeners)d(r)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const r of this._progressiveDoneListeners)r()})}transportReady(){this._readyCapability.resolve()}requestDataRange(r,d){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(r,d){this._pdfInfo=r,this._transport=d,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(T=>{if(!T)return T;const o=[];for(const E in T)o.push(...T[E]);return o}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(r){return this._transport.getPage(r)}getPageIndex(r){return this._transport.getPageIndex(r)}getDestinations(){return this._transport.getDestinations()}getDestination(r){return this._transport.getDestination(r)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(r=!1){return this._transport.startCleanup(r||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(r,d,T,o=!1){tt(this,G);tt(this,mt,null);tt(this,S,!1);this._pageIndex=r,this._pageInfo=d,this._transport=T,this._stats=o?new _display_utils.StatTimer:null,this._pdfBug=o,this.commonObjs=T.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:r,rotation:d=this.rotate,offsetX:T=0,offsetY:o=0,dontFlip:E=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:r,rotation:d,offsetX:T,offsetY:o,dontFlip:E})}getAnnotations({intent:r="display"}={}){const d=this._transport.getRenderingIntent(r);return this._transport.getAnnotations(this._pageIndex,d.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var r;return((r=this._transport._htmlForXfa)==null?void 0:r.children[this._pageIndex])||null}render({canvasContext:r,viewport:d,intent:T="display",annotationMode:o=_util.AnnotationMode.ENABLE,transform:E=null,background:W=null,optionalContentConfigPromise:D=null,annotationCanvasMap:B=null,pageColors:z=null,printAnnotationStorage:M=null}){var h,A;(h=this._stats)==null||h.time("Overall");const Q=this._transport.getRenderingIntent(T,o,M);Z(this,S,!1),j(this,G,Pe).call(this),D||(D=this._transport.getOptionalContentConfig());let y=this._intentStates.get(Q.cacheKey);y||(y=Object.create(null),this._intentStates.set(Q.cacheKey,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const C=!!(Q.renderingIntent&_util.RenderingIntentFlag.PRINT);y.displayReadyCapability||(y.displayReadyCapability=new _util.PromiseCapability,y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(A=this._stats)==null||A.time("Page Request"),this._pumpOperatorList(Q));const rt=Y=>{var K,k;y.renderTasks.delete(O),(this._maybeCleanupAfterRender||C)&&Z(this,S,!0),j(this,G,oe).call(this,!C),Y?(O.capability.reject(Y),this._abortOperatorList({intentState:y,reason:Y instanceof Error?Y:new Error(Y)})):O.capability.resolve(),(K=this._stats)==null||K.timeEnd("Rendering"),(k=this._stats)==null||k.timeEnd("Overall")},O=new InternalRenderTask({callback:rt,params:{canvasContext:r,viewport:d,transform:E,background:W},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:B,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:z});(y.renderTasks||(y.renderTasks=new Set)).add(O);const l=O.task;return Promise.all([y.displayReadyCapability.promise,D]).then(([Y,K])=>{var k;if(this.destroyed){rt();return}(k=this._stats)==null||k.time("Rendering"),O.initializeGraphics({transparency:Y,optionalContentConfig:K}),O.operatorListChanged()}).catch(rt),l}getOperatorList({intent:r="display",annotationMode:d=_util.AnnotationMode.ENABLE,printAnnotationStorage:T=null}={}){var B;function o(){W.operatorList.lastChunk&&(W.opListReadCapability.resolve(W.operatorList),W.renderTasks.delete(D))}const E=this._transport.getRenderingIntent(r,d,T,!0);let W=this._intentStates.get(E.cacheKey);W||(W=Object.create(null),this._intentStates.set(E.cacheKey,W));let D;return W.opListReadCapability||(D=Object.create(null),D.operatorListChanged=o,W.opListReadCapability=new _util.PromiseCapability,(W.renderTasks||(W.renderTasks=new Set)).add(D),W.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(B=this._stats)==null||B.time("Page Request"),this._pumpOperatorList(E)),W.opListReadCapability.promise}streamTextContent({includeMarkedContent:r=!1,disableNormalization:d=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:r===!0,disableNormalization:d===!0},{highWaterMark:100,size(o){return o.items.length}})}getTextContent(r={}){if(this._transport._htmlForXfa)return this.getXfa().then(T=>_xfa_text.XfaText.textContent(T));const d=this.streamTextContent(r);return new Promise(function(T,o){function E(){W.read().then(function({value:B,done:z}){if(z){T(D);return}Object.assign(D.styles,B.styles),D.items.push(...B.items),E()},o)}const W=d.getReader(),D={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const r=[];for(const d of this._intentStates.values())if(this._abortOperatorList({intentState:d,reason:new Error("Page was destroyed."),force:!0}),!d.opListReadCapability)for(const T of d.renderTasks)r.push(T.completed),T.cancel();return this.objs.clear(),Z(this,S,!1),j(this,G,Pe).call(this),Promise.all(r)}cleanup(r=!1){Z(this,S,!0);const d=j(this,G,oe).call(this,!1);return r&&d&&this._stats&&(this._stats=new _display_utils.StatTimer),d}_startRenderPage(r,d){var o,E;const T=this._intentStates.get(d);T&&((o=this._stats)==null||o.timeEnd("Page Request"),(E=T.displayReadyCapability)==null||E.resolve(r))}_renderPageChunk(r,d){for(let T=0,o=r.length;T<o;T++)d.operatorList.fnArray.push(r.fnArray[T]),d.operatorList.argsArray.push(r.argsArray[T]);d.operatorList.lastChunk=r.lastChunk,d.operatorList.separateAnnots=r.separateAnnots;for(const T of d.renderTasks)T.operatorListChanged();r.lastChunk&&j(this,G,oe).call(this,!0)}_pumpOperatorList({renderingIntent:r,cacheKey:d,annotationStorageSerializable:T}){const{map:o,transfers:E}=T,D=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:r,cacheKey:d,annotationStorage:o},E).getReader(),B=this._intentStates.get(d);B.streamReader=D;const z=()=>{D.read().then(({value:M,done:Q})=>{if(Q){B.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(M,B),z())},M=>{if(B.streamReader=null,!this._transport.destroyed){if(B.operatorList){B.operatorList.lastChunk=!0;for(const Q of B.renderTasks)Q.operatorListChanged();j(this,G,oe).call(this,!0)}if(B.displayReadyCapability)B.displayReadyCapability.reject(M);else if(B.opListReadCapability)B.opListReadCapability.reject(M);else throw M}})};z()}_abortOperatorList({intentState:r,reason:d,force:T=!1}){if(r.streamReader){if(r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null),!T){if(r.renderTasks.size>0)return;if(d instanceof _display_utils.RenderingCancelledException){let o=RENDERING_CANCELLED_TIMEOUT;d.extraDelay>0&&d.extraDelay<1e3&&(o+=d.extraDelay),r.streamReaderCancelTimeout=setTimeout(()=>{r.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:r,reason:d,force:!0})},o);return}}if(r.streamReader.cancel(new _util.AbortException(d.message)).catch(()=>{}),r.streamReader=null,!this._transport.destroyed){for(const[o,E]of this._intentStates)if(E===r){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}mt=new WeakMap,S=new WeakMap,G=new WeakSet,oe=function(r=!1){if(j(this,G,Pe).call(this),!t(this,S)||this.destroyed)return!1;if(r)return Z(this,mt,setTimeout(()=>{Z(this,mt,null),j(this,G,oe).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:d,operatorList:T}of this._intentStates.values())if(d.size>0||!T.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Z(this,S,!1),!0},Pe=function(){t(this,mt)&&(clearTimeout(t(this,mt)),Z(this,mt,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){tt(this,V,new Set);tt(this,R,Promise.resolve())}postMessage(r,d){const T={data:structuredClone(r,d?{transfer:d}:null)};t(this,R).then(()=>{for(const o of t(this,V))o.call(this,T)})}addEventListener(r,d){t(this,V).add(d)}removeEventListener(r,d){t(this,V).delete(d)}terminate(){t(this,V).clear()}}V=new WeakMap,R=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const n=(f=document==null?void 0:document.currentScript)==null?void 0:f.src;n&&(PDFWorkerUtil.fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(n,r){let d;try{if(d=new URL(n),!d.origin||d.origin==="null")return!1}catch{return!1}const T=new URL(r,d);return d.origin===T.origin},PDFWorkerUtil.createCDNWrapper=function(n){const r=`importScripts("${n}");`;return URL.createObjectURL(new Blob([r]))}}const _PDFWorker=class _PDFWorker{constructor({name:n=null,port:r=null,verbosity:d=(0,_util.getVerbosityLevel)()}={}){var T;if(this.name=n,this.destroyed=!1,this.verbosity=d,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,r){if((T=t(_PDFWorker,a))!=null&&T.has(r))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,a)||Z(_PDFWorker,a,new WeakMap)).set(r,this),this._initializeFromPort(r);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(n){this._port=n,this._messageHandler=new _message_handler.MessageHandler("main","worker",n),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:n}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,n)||(n=PDFWorkerUtil.createCDNWrapper(new URL(n,window.location).href));const r=new Worker(n),d=new _message_handler.MessageHandler("main","worker",r),T=()=>{r.removeEventListener("error",o),d.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=()=>{this._webWorker||T()};r.addEventListener("error",o),d.on("test",W=>{if(r.removeEventListener("error",o),this.destroyed){T();return}W?(this._messageHandler=d,this._port=r,this._webWorker=r,this._readyCapability.resolve(),d.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),d.destroy(),r.terminate())}),d.on("ready",W=>{if(r.removeEventListener("error",o),this.destroyed){T();return}try{E()}catch{this._setupFakeWorker()}});const E=()=>{const W=new Uint8Array;d.send("test",W,[W.buffer])};E();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(n=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const r=new LoopbackPort;this._port=r;const d=`fake${PDFWorkerUtil.fakeWorkerId++}`,T=new _message_handler.MessageHandler(d+"_worker",d,r);n.setup(T,r);const o=new _message_handler.MessageHandler(d,d+"_worker",r);this._messageHandler=o,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})}).catch(n=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${n.message}".`))})}destroy(){var n;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(n=t(_PDFWorker,a))==null||n.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(n){var d;if(!(n!=null&&n.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const r=(d=t(this,a))==null?void 0:d.get(n.port);if(r){if(r._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return r}return new _PDFWorker(n)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var n;try{return((n=globalThis.pdfjsWorker)==null?void 0:n.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};a=new WeakMap,tt(_PDFWorker,a);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(r,d,T,o,E){tt(this,v);tt(this,N,new Map);tt(this,x,new Map);tt(this,p,new Map);tt(this,c,null);this.messageHandler=r,this.loadingTask=d,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this._params=o,this.canvasFactory=E.canvasFactory,this.filterFactory=E.filterFactory,this.cMapReaderFactory=E.cMapReaderFactory,this.standardFontDataFactory=E.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=T,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(r,d=_util.AnnotationMode.ENABLE,T=null,o=!1){let E=_util.RenderingIntentFlag.DISPLAY,W=_annotation_storage.SerializableEmpty;switch(r){case"any":E=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":E=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${r}`)}switch(d){case _util.AnnotationMode.DISABLE:E+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:E+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:E+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,W=(E&_util.RenderingIntentFlag.PRINT&&T instanceof _annotation_storage.PrintAnnotationStorage?T:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${d}`)}return o&&(E+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:E,cacheKey:`${E}_${W.hash}`,annotationStorageSerializable:W}}destroy(){var T;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(T=t(this,c))==null||T.reject(new Error("Worker was destroyed during onPassword callback"));const r=[];for(const o of t(this,x).values())r.push(o._destroy());t(this,x).clear(),t(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const d=this.messageHandler.sendWithPromise("Terminate",null);return r.push(d),Promise.all(r).then(()=>{var o;this.commonObjs.clear(),this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(),(o=this._networkStream)==null||o.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:r,loadingTask:d}=this;r.on("GetReader",(T,o)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=E=>{this._lastProgress={loaded:E.loaded,total:E.total}},o.onPull=()=>{this._fullReader.read().then(function({value:E,done:W}){if(W){o.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{o.error(E)})},o.onCancel=E=>{this._fullReader.cancel(E),o.ready.catch(W=>{if(!this.destroyed)throw W})}}),r.on("ReaderHeadersReady",T=>{const o=new _util.PromiseCapability,E=this._fullReader;return E.headersReady.then(()=>{var W;(!E.isStreamingSupported||!E.isRangeSupported)&&(this._lastProgress&&((W=d.onProgress)==null||W.call(d,this._lastProgress)),E.onProgress=D=>{var B;(B=d.onProgress)==null||B.call(d,{loaded:D.loaded,total:D.total})}),o.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},o.reject),o.promise}),r.on("GetRangeReader",(T,o)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const E=this._networkStream.getRangeReader(T.begin,T.end);if(!E){o.close();return}o.onPull=()=>{E.read().then(function({value:W,done:D}){if(D){o.close();return}(0,_util.assert)(W instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(W),1,[W])}).catch(W=>{o.error(W)})},o.onCancel=W=>{E.cancel(W),o.ready.catch(D=>{if(!this.destroyed)throw D})}}),r.on("GetDoc",({pdfInfo:T})=>{this._numPages=T.numPages,this._htmlForXfa=T.htmlForXfa,delete T.htmlForXfa,d._capability.resolve(new PDFDocumentProxy(T,this))}),r.on("DocException",function(T){let o;switch(T.name){case"PasswordException":o=new _util.PasswordException(T.message,T.code);break;case"InvalidPDFException":o=new _util.InvalidPDFException(T.message);break;case"MissingPDFException":o=new _util.MissingPDFException(T.message);break;case"UnexpectedResponseException":o=new _util.UnexpectedResponseException(T.message,T.status);break;case"UnknownErrorException":o=new _util.UnknownErrorException(T.message,T.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}d._capability.reject(o)}),r.on("PasswordRequest",T=>{if(Z(this,c,new _util.PromiseCapability),d.onPassword){const o=E=>{E instanceof Error?t(this,c).reject(E):t(this,c).resolve({password:E})};try{d.onPassword(o,T.code)}catch(E){t(this,c).reject(E)}}else t(this,c).reject(new _util.PasswordException(T.message,T.code));return t(this,c).promise}),r.on("DataLoaded",T=>{var o;(o=d.onProgress)==null||o.call(d,{loaded:T.length,total:T.length}),this.downloadInfoCapability.resolve(T)}),r.on("StartRenderPage",T=>{if(this.destroyed)return;t(this,x).get(T.pageIndex)._startRenderPage(T.transparency,T.cacheKey)}),r.on("commonobj",([T,o,E])=>{var W;if(!this.destroyed&&!this.commonObjs.has(T))switch(o){case"Font":const D=this._params;if("error"in E){const M=E.error;(0,_util.warn)(`Error during font loading: ${M}`),this.commonObjs.resolve(T,M);break}const B=D.pdfBug&&((W=globalThis.FontInspector)!=null&&W.enabled)?(M,Q)=>globalThis.FontInspector.fontAdded(M,Q):null,z=new _font_loader.FontFaceObject(E,{isEvalSupported:D.isEvalSupported,disableFontFace:D.disableFontFace,ignoreErrors:D.ignoreErrors,inspectFont:B});this.fontLoader.bind(z).catch(M=>r.sendWithPromise("FontFallback",{id:T})).finally(()=>{!D.fontExtraProperties&&z.data&&(z.data=null),this.commonObjs.resolve(T,z)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(T,E);break;default:throw new Error(`Got unknown common object type ${o}`)}}),r.on("obj",([T,o,E,W])=>{var B;if(this.destroyed)return;const D=t(this,x).get(o);if(!D.objs.has(T))switch(E){case"Image":if(D.objs.resolve(T,W),W){let z;if(W.bitmap){const{width:M,height:Q}=W;z=M*Q*4}else z=((B=W.data)==null?void 0:B.length)||0;z>_util.MAX_IMAGE_SIZE_TO_CACHE&&(D._maybeCleanupAfterRender=!0)}break;case"Pattern":D.objs.resolve(T,W);break;default:throw new Error(`Got unknown object type ${E}`)}}),r.on("DocProgress",T=>{var o;this.destroyed||(o=d.onProgress)==null||o.call(d,{loaded:T.loaded,total:T.total})}),r.on("FetchBuiltInCMap",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(T):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),r.on("FetchStandardFontData",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(T):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var T;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:r,transfers:d}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:r,filename:((T=this._fullReader)==null?void 0:T.filename)??null},d).finally(()=>{this.annotationStorage.resetModified()})}getPage(r){if(!Number.isInteger(r)||r<=0||r>this._numPages)return Promise.reject(new Error("Invalid page request."));const d=r-1,T=t(this,p).get(d);if(T)return T;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:d}).then(E=>{if(this.destroyed)throw new Error("Transport destroyed");const W=new PDFPageProxy(d,E,this,this._params.pdfBug);return t(this,x).set(d,W),W});return t(this,p).set(d,o),o}getPageIndex(r){return typeof r!="object"||r===null||!Number.isInteger(r.num)||r.num<0||!Number.isInteger(r.gen)||r.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:r.num,gen:r.gen})}getAnnotations(r,d){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:r,intent:d})}getFieldObjects(){return j(this,v,we).call(this,"GetFieldObjects")}hasJSActions(){return j(this,v,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(r){return typeof r!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:r})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return j(this,v,we).call(this,"GetDocJSActions")}getPageJSActions(r){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:r})}getStructTree(r){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:r})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(r=>new _optional_content_config.OptionalContentConfig(r))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const r="GetMetadata",d=t(this,N).get(r);if(d)return d;const T=this.messageHandler.sendWithPromise(r,null).then(o=>{var E,W;return{info:o[0],metadata:o[1]?new _metadata.Metadata(o[1]):null,contentDispositionFilename:((E=this._fullReader)==null?void 0:E.filename)??null,contentLength:((W=this._fullReader)==null?void 0:W.contentLength)??null}});return t(this,N).set(r,T),T}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(r=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const d of t(this,x).values())if(!d.cleanup())throw new Error(`startCleanup: Page ${d.pageNumber} is currently rendering.`);this.commonObjs.clear(),r||this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:r,enableXfa:d}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:r,enableXfa:d})}}N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakSet,we=function(r,d=null){const T=t(this,N).get(r);if(T)return T;const o=this.messageHandler.sendWithPromise(r,d);return t(this,N).set(r,o),o};class PDFObjects{constructor(){tt(this,u);tt(this,m,Object.create(null))}get(r,d=null){if(d){const o=j(this,u,$e).call(this,r);return o.capability.promise.then(()=>d(o.data)),null}const T=t(this,m)[r];if(!(T!=null&&T.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${r}.`);return T.data}has(r){const d=t(this,m)[r];return(d==null?void 0:d.capability.settled)||!1}resolve(r,d=null){const T=j(this,u,$e).call(this,r);T.data=d,T.capability.resolve()}clear(){var r;for(const d in t(this,m)){const{data:T}=t(this,m)[d];(r=T==null?void 0:T.bitmap)==null||r.close()}Z(this,m,Object.create(null))}}m=new WeakMap,u=new WeakSet,$e=function(r){var d;return(d=t(this,m))[r]||(d[r]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(r){tt(this,g,null);Z(this,g,r),this.onContinue=null}get promise(){return t(this,g).capability.promise}cancel(r=0){t(this,g).cancel(null,r)}get separateAnnots(){const{separateAnnots:r}=t(this,g).operatorList;if(!r)return!1;const{annotationCanvasMap:d}=t(this,g);return r.form||r.canvas&&(d==null?void 0:d.size)>0}}g=new WeakMap,exports.RenderTask=RenderTask;const e=class e{constructor({callback:r,params:d,objs:T,commonObjs:o,annotationCanvasMap:E,operatorList:W,pageIndex:D,canvasFactory:B,filterFactory:z,useRequestAnimationFrame:M=!1,pdfBug:Q=!1,pageColors:y=null}){this.callback=r,this.params=d,this.objs=T,this.commonObjs=o,this.annotationCanvasMap=E,this.operatorListIdx=null,this.operatorList=W,this._pageIndex=D,this.canvasFactory=B,this.filterFactory=z,this._pdfBug=Q,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=M===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=d.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:r=!1,optionalContentConfig:d}){var D,B;if(this.cancelled)return;if(this._canvas){if(t(e,i).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(e,i).add(this._canvas)}this._pdfBug&&((D=globalThis.StepperManager)!=null&&D.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:T,viewport:o,transform:E,background:W}=this.params;this.gfx=new _canvas.CanvasGraphics(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:d},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:E,viewport:o,transparency:r,background:W}),this.operatorListIdx=0,this.graphicsReady=!0,(B=this.graphicsReadyCallback)==null||B.call(this)}cancel(r=null,d=0){var T;this.running=!1,this.cancelled=!0,(T=this.gfx)==null||T.endDrawing(),t(e,i).delete(this._canvas),this.callback(r||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,d))}operatorListChanged(){var r;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(r=this.stepper)==null||r.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(e,i).delete(this._canvas),this.callback())))}};i=new WeakMap,tt(e,i,new WeakSet);let InternalRenderTask=e;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(Ct,L,mt)=>{var f,a,N,Yi,p;Object.defineProperty(L,"__esModule",{value:!0}),L.SerializableEmpty=L.PrintAnnotationStorage=L.AnnotationStorage=void 0;var S=mt(1),G=mt(4),bt=mt(8);const et=Object.freeze({map:null,hash:"",transfers:void 0});L.SerializableEmpty=et;class V{constructor(){tt(this,N);tt(this,f,!1);tt(this,a,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,b){const m=t(this,a).get(v);return m===void 0?b:Object.assign(b,m)}getRawValue(v){return t(this,a).get(v)}remove(v){if(t(this,a).delete(v),t(this,a).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const b of t(this,a).values())if(b instanceof G.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,b){const m=t(this,a).get(v);let u=!1;if(m!==void 0)for(const[_,g]of Object.entries(b))m[_]!==g&&(u=!0,m[_]=g);else u=!0,t(this,a).set(v,b);u&&j(this,N,Yi).call(this),b instanceof G.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(b.constructor._type)}has(v){return t(this,a).has(v)}getAll(){return t(this,a).size>0?(0,S.objectFromMap)(t(this,a)):null}setAll(v){for(const[b,m]of Object.entries(v))this.setValue(b,m)}get size(){return t(this,a).size}resetModified(){t(this,f)&&(Z(this,f,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new R(this)}get serializable(){if(t(this,a).size===0)return et;const v=new Map,b=new bt.MurmurHash3_64,m=[],u=Object.create(null);let _=!1;for(const[g,i]of t(this,a)){const e=i instanceof G.AnnotationEditor?i.serialize(!1,u):i;e&&(v.set(g,e),b.update(`${g}:${JSON.stringify(e)}`),_||(_=!!e.bitmap))}if(_)for(const g of v.values())g.bitmap&&m.push(g.bitmap);return v.size>0?{map:v,hash:b.hexdigest(),transfers:m}:et}}f=new WeakMap,a=new WeakMap,N=new WeakSet,Yi=function(){t(this,f)||(Z(this,f,!0),typeof this.onSetModified=="function"&&this.onSetModified())},L.AnnotationStorage=V;class R extends V{constructor(b){super();tt(this,p);const{map:m,hash:u,transfers:_}=b.serializable,g=structuredClone(m,_?{transfer:_}:null);Z(this,p,{map:g,hash:u,transfers:_})}get print(){(0,S.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,p)}}p=new WeakMap,L.PrintAnnotationStorage=R},(Ct,L,mt)=>{var R,f,a,N,x,p,c,v,b,m,u,_,g,i,e,Ge,Xe,d,qe,Ye,Ki,Ji,Qi,Ke,Zi;Object.defineProperty(L,"__esModule",{value:!0}),L.AnnotationEditor=void 0;var S=mt(5),G=mt(1),bt=mt(6);const M=class M{constructor(y){tt(this,e);tt(this,R,"");tt(this,f,!1);tt(this,a,null);tt(this,N,null);tt(this,x,null);tt(this,p,!1);tt(this,c,null);tt(this,v,this.focusin.bind(this));tt(this,b,this.focusout.bind(this));tt(this,m,!1);tt(this,u,!1);tt(this,_,!1);Kt(this,"_initialOptions",Object.create(null));Kt(this,"_uiManager",null);Kt(this,"_focusEventsAllowed",!0);Kt(this,"_l10nPromise",null);tt(this,g,!1);tt(this,i,M._zIndex++);this.constructor===M&&(0,G.unreachable)("Cannot initialize AnnotationEditor."),this.parent=y.parent,this.id=y.id,this.width=this.height=null,this.pageIndex=y.parent.pageIndex,this.name=y.name,this.div=null,this._uiManager=y.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=y.isCentered,this._structTreeParentId=null;const{rotation:C,rawDims:{pageWidth:rt,pageHeight:O,pageX:l,pageY:h}}=this.parent.viewport;this.rotation=C,this.pageRotation=(360+C-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[rt,O],this.pageTranslation=[l,h];const[A,Y]=this.parentDimensions;this.x=y.x/A,this.y=y.y/Y,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,G.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(y){const C=new V({id:y.parent.getNextId(),parent:y.parent,uiManager:y._uiManager});C.annotationElementId=y.annotationElementId,C.deleted=!0,C._uiManager.addToAnnotationStorage(C)}static initialize(y,C=null){if(M._l10nPromise||(M._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(O=>[O,y.get(O)]))),C!=null&&C.strings)for(const O of C.strings)M._l10nPromise.set(O,y.get(O));if(M._borderLineWidth!==-1)return;const rt=getComputedStyle(document.documentElement);M._borderLineWidth=parseFloat(rt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(y,C){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(y){return!1}static paste(y,C){(0,G.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,g)}set _isDraggable(y){var C;Z(this,g,y),(C=this.div)==null||C.classList.toggle("draggable",y)}center(){const[y,C]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*C/(y*2),this.y+=this.width*y/(C*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*C/(y*2),this.y-=this.width*y/(C*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(y){this._uiManager.addCommands(y)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,i)}setParent(y){y!==null&&(this.pageIndex=y.pageIndex,this.pageDimensions=y.pageDimensions),this.parent=y}focusin(y){this._focusEventsAllowed&&(t(this,m)?Z(this,m,!1):this.parent.setSelected(this))}focusout(y){var rt;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const C=y.relatedTarget;C!=null&&C.closest(`#${this.id}`)||(y.preventDefault(),(rt=this.parent)!=null&&rt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(y,C,rt,O){const[l,h]=this.parentDimensions;[rt,O]=this.screenToPageTranslation(rt,O),this.x=(y+rt)/l,this.y=(C+O)/h,this.fixAndSetPosition()}translate(y,C){j(this,e,Ge).call(this,this.parentDimensions,y,C)}translateInPage(y,C){j(this,e,Ge).call(this,this.pageDimensions,y,C),this.div.scrollIntoView({block:"nearest"})}drag(y,C){const[rt,O]=this.parentDimensions;if(this.x+=y/rt,this.y+=C/O,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:K,y:k}=this.div.getBoundingClientRect();this.parent.findNewParent(this,K,k)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:h}=this;const[A,Y]=j(this,e,Xe).call(this);l+=A,h+=Y,this.div.style.left=`${(100*l).toFixed(2)}%`,this.div.style.top=`${(100*h).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[y,C]=this.pageDimensions;let{x:rt,y:O,width:l,height:h}=this;switch(l*=y,h*=C,rt*=y,O*=C,this.rotation){case 0:rt=Math.max(0,Math.min(y-l,rt)),O=Math.max(0,Math.min(C-h,O));break;case 90:rt=Math.max(0,Math.min(y-h,rt)),O=Math.min(C,Math.max(l,O));break;case 180:rt=Math.min(y,Math.max(l,rt)),O=Math.min(C,Math.max(h,O));break;case 270:rt=Math.min(y,Math.max(h,rt)),O=Math.max(0,Math.min(C-l,O));break}this.x=rt/=y,this.y=O/=C;const[A,Y]=j(this,e,Xe).call(this);rt+=A,O+=Y;const{style:K}=this.div;K.left=`${(100*rt).toFixed(2)}%`,K.top=`${(100*O).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(y,C){var rt;return j(rt=M,d,qe).call(rt,y,C,this.parentRotation)}pageTranslationToScreen(y,C){var rt;return j(rt=M,d,qe).call(rt,y,C,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:y,pageDimensions:[C,rt]}=this,O=C*y,l=rt*y;return G.FeatureTest.isCSSRoundSupported?[Math.round(O),Math.round(l)]:[O,l]}setDims(y,C){var l;const[rt,O]=this.parentDimensions;this.div.style.width=`${(100*y/rt).toFixed(2)}%`,t(this,p)||(this.div.style.height=`${(100*C/O).toFixed(2)}%`),(l=t(this,a))==null||l.classList.toggle("small",y<M.SMALL_EDITOR_SIZE||C<M.SMALL_EDITOR_SIZE)}fixDims(){const{style:y}=this.div,{height:C,width:rt}=y,O=rt.endsWith("%"),l=!t(this,p)&&C.endsWith("%");if(O&&l)return;const[h,A]=this.parentDimensions;O||(y.width=`${(100*parseFloat(rt)/h).toFixed(2)}%`),!t(this,p)&&!l&&(y.height=`${(100*parseFloat(C)/A).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,a))return;const y=Z(this,a,document.createElement("button"));y.className="altText";const C=await M._l10nPromise.get("editor_alt_text_button_label");y.textContent=C,y.setAttribute("aria-label",C),y.tabIndex="0",y.addEventListener("contextmenu",bt.noContextMenu),y.addEventListener("pointerdown",rt=>rt.stopPropagation()),y.addEventListener("click",rt=>{rt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),y.addEventListener("keydown",rt=>{rt.target===y&&rt.key==="Enter"&&(rt.preventDefault(),this._uiManager.editAltText(this))}),j(this,e,Ke).call(this),this.div.append(y),M.SMALL_EDITOR_SIZE||(M.SMALL_EDITOR_SIZE=Math.min(128,Math.round(y.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,R),decorative:t(this,f)}}set altTextData({altText:y,decorative:C}){t(this,R)===y&&t(this,f)===C||(Z(this,R,y),Z(this,f,C),j(this,e,Ke).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,v)),this.div.addEventListener("focusout",t(this,b));const[y,C]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*C/y).toFixed(2)}%`,this.div.style.maxHeight=`${(100*y/C).toFixed(2)}%`);const[rt,O]=this.getInitialTranslation();return this.translate(rt,O),(0,S.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(y){const{isMac:C}=G.FeatureTest.platform;if(y.button!==0||y.ctrlKey&&C){y.preventDefault();return}Z(this,m,!0),j(this,e,Zi).call(this,y)}moveInDOM(){var y;(y=this.parent)==null||y.moveEditorInDOM(this)}_setParentAndPosition(y,C,rt){y.changeParent(this),this.x=C,this.y=rt,this.fixAndSetPosition()}getRect(y,C){const rt=this.parentScale,[O,l]=this.pageDimensions,[h,A]=this.pageTranslation,Y=y/rt,K=C/rt,k=this.x*O,J=this.y*l,at=this.width*O,ft=this.height*l;switch(this.rotation){case 0:return[k+Y+h,l-J-K-ft+A,k+Y+at+h,l-J-K+A];case 90:return[k+K+h,l-J+Y+A,k+K+ft+h,l-J+Y+at+A];case 180:return[k-Y-at+h,l-J+K+A,k-Y+h,l-J+K+ft+A];case 270:return[k-K-ft+h,l-J-Y-at+A,k-K+h,l-J-Y+A];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(y,C){const[rt,O,l,h]=y,A=l-rt,Y=h-O;switch(this.rotation){case 0:return[rt,C-h,A,Y];case 90:return[rt,C-O,Y,A];case 180:return[l,C-O,A,Y];case 270:return[l,C-h,Y,A];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Z(this,_,!0)}disableEditMode(){Z(this,_,!1)}isInEditMode(){return t(this,_)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var y,C;(y=this.div)==null||y.addEventListener("focusin",t(this,v)),(C=this.div)==null||C.addEventListener("focusout",t(this,b))}serialize(y=!1,C=null){(0,G.unreachable)("An editor must be serializable")}static deserialize(y,C,rt){const O=new this.prototype.constructor({parent:C,id:C.getNextId(),uiManager:rt});O.rotation=y.rotation;const[l,h]=O.pageDimensions,[A,Y,K,k]=O.getRectInCurrentCoords(y.rect,h);return O.x=A/l,O.y=Y/h,O.width=K/l,O.height=k/h,O}remove(){var y;this.div.removeEventListener("focusin",t(this,v)),this.div.removeEventListener("focusout",t(this,b)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(y=t(this,a))==null||y.remove(),Z(this,a,null),Z(this,N,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(j(this,e,Ki).call(this),t(this,c).classList.remove("hidden"))}select(){var y;this.makeResizable(),(y=this.div)==null||y.classList.add("selectedEditor")}unselect(){var y,C,rt;(y=t(this,c))==null||y.classList.add("hidden"),(C=this.div)==null||C.classList.remove("selectedEditor"),(rt=this.div)!=null&&rt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(y,C){}disableEditing(){t(this,a)&&(t(this,a).hidden=!0)}enableEditing(){t(this,a)&&(t(this,a).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,u)}set isEditing(y){Z(this,u,y),this.parent&&(y?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(y,C){Z(this,p,!0);const rt=y/C,{style:O}=this.div;O.aspectRatio=rt,O.height="auto"}static get MIN_SIZE(){return 16}};R=new WeakMap,f=new WeakMap,a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap,u=new WeakMap,_=new WeakMap,g=new WeakMap,i=new WeakMap,e=new WeakSet,Ge=function([y,C],rt,O){[rt,O]=this.screenToPageTranslation(rt,O),this.x+=rt/y,this.y+=O/C,this.fixAndSetPosition()},Xe=function(){const[y,C]=this.parentDimensions,{_borderLineWidth:rt}=M,O=rt/y,l=rt/C;switch(this.rotation){case 90:return[-O,l];case 180:return[O,l];case 270:return[O,-l];default:return[-O,-l]}},d=new WeakSet,qe=function(y,C,rt){switch(rt){case 90:return[C,-y];case 180:return[-y,-C];case 270:return[-C,y];default:return[y,C]}},Ye=function(y){switch(y){case 90:{const[C,rt]=this.pageDimensions;return[0,-C/rt,rt/C,0]}case 180:return[-1,0,0,-1];case 270:{const[C,rt]=this.pageDimensions;return[0,C/rt,-rt/C,0]}default:return[1,0,0,1]}},Ki=function(){if(t(this,c))return;Z(this,c,document.createElement("div")),t(this,c).classList.add("resizers");const y=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||y.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const C of y){const rt=document.createElement("div");t(this,c).append(rt),rt.classList.add("resizer",C),rt.addEventListener("pointerdown",j(this,e,Ji).bind(this,C)),rt.addEventListener("contextmenu",bt.noContextMenu)}this.div.prepend(t(this,c))},Ji=function(y,C){C.preventDefault();const{isMac:rt}=G.FeatureTest.platform;if(C.button!==0||C.ctrlKey&&rt)return;const O=j(this,e,Qi).bind(this,y),l=this._isDraggable;this._isDraggable=!1;const h={passive:!0,capture:!0};window.addEventListener("pointermove",O,h);const A=this.x,Y=this.y,K=this.width,k=this.height,J=this.parent.div.style.cursor,at=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(C.target).cursor;const ft=()=>{this._isDraggable=l,window.removeEventListener("pointerup",ft),window.removeEventListener("blur",ft),window.removeEventListener("pointermove",O,h),this.parent.div.style.cursor=J,this.div.style.cursor=at;const pt=this.x,vt=this.y,Et=this.width,Pt=this.height;pt===A&&vt===Y&&Et===K&&Pt===k||this.addCommands({cmd:()=>{this.width=Et,this.height=Pt,this.x=pt,this.y=vt;const[ct,lt]=this.parentDimensions;this.setDims(ct*Et,lt*Pt),this.fixAndSetPosition()},undo:()=>{this.width=K,this.height=k,this.x=A,this.y=Y;const[ct,lt]=this.parentDimensions;this.setDims(ct*K,lt*k),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ft),window.addEventListener("blur",ft)},Qi=function(y,C){const[rt,O]=this.parentDimensions,l=this.x,h=this.y,A=this.width,Y=this.height,K=M.MIN_SIZE/rt,k=M.MIN_SIZE/O,J=xt=>Math.round(xt*1e4)/1e4,at=j(this,e,Ye).call(this,this.rotation),ft=(xt,kt)=>[at[0]*xt+at[2]*kt,at[1]*xt+at[3]*kt],pt=j(this,e,Ye).call(this,360-this.rotation),vt=(xt,kt)=>[pt[0]*xt+pt[2]*kt,pt[1]*xt+pt[3]*kt];let Et,Pt,ct=!1,lt=!1;switch(y){case"topLeft":ct=!0,Et=(xt,kt)=>[0,0],Pt=(xt,kt)=>[xt,kt];break;case"topMiddle":Et=(xt,kt)=>[xt/2,0],Pt=(xt,kt)=>[xt/2,kt];break;case"topRight":ct=!0,Et=(xt,kt)=>[xt,0],Pt=(xt,kt)=>[0,kt];break;case"middleRight":lt=!0,Et=(xt,kt)=>[xt,kt/2],Pt=(xt,kt)=>[0,kt/2];break;case"bottomRight":ct=!0,Et=(xt,kt)=>[xt,kt],Pt=(xt,kt)=>[0,0];break;case"bottomMiddle":Et=(xt,kt)=>[xt/2,kt],Pt=(xt,kt)=>[xt/2,0];break;case"bottomLeft":ct=!0,Et=(xt,kt)=>[0,kt],Pt=(xt,kt)=>[xt,0];break;case"middleLeft":lt=!0,Et=(xt,kt)=>[0,kt/2],Pt=(xt,kt)=>[xt,kt/2];break}const I=Et(A,Y),q=Pt(A,Y);let nt=ft(...q);const P=J(l+nt[0]),s=J(h+nt[1]);let w=1,U=1,[F,it]=this.screenToPageTranslation(C.movementX,C.movementY);if([F,it]=vt(F/rt,it/O),ct){const xt=Math.hypot(A,Y);w=U=Math.max(Math.min(Math.hypot(q[0]-I[0]-F,q[1]-I[1]-it)/xt,1/A,1/Y),K/A,k/Y)}else lt?w=Math.max(K,Math.min(1,Math.abs(q[0]-I[0]-F)))/A:U=Math.max(k,Math.min(1,Math.abs(q[1]-I[1]-it)))/Y;const ot=J(A*w),At=J(Y*U);nt=ft(...Pt(ot,At));const dt=P-nt[0],Mt=s-nt[1];this.width=ot,this.height=At,this.x=dt,this.y=Mt,this.setDims(rt*ot,O*At),this.fixAndSetPosition()},Ke=async function(){var rt;const y=t(this,a);if(!y)return;if(!t(this,R)&&!t(this,f)){y.classList.remove("done"),(rt=t(this,N))==null||rt.remove();return}M._l10nPromise.get("editor_alt_text_edit_button_label").then(O=>{y.setAttribute("aria-label",O)});let C=t(this,N);if(!C){Z(this,N,C=document.createElement("span")),C.className="tooltip",C.setAttribute("role","tooltip");const O=C.id=`alt-text-tooltip-${this.id}`;y.setAttribute("aria-describedby",O);const l=100;y.addEventListener("mouseenter",()=>{Z(this,x,setTimeout(()=>{Z(this,x,null),t(this,N).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},l))}),y.addEventListener("mouseleave",()=>{var h;clearTimeout(t(this,x)),Z(this,x,null),(h=t(this,N))==null||h.classList.remove("show")})}y.classList.add("done"),C.innerText=t(this,f)?await M._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,R),C.parentNode||y.append(C)},Zi=function(y){if(!this._isDraggable)return;const C=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let rt,O;C&&(rt={passive:!0,capture:!0},O=h=>{const[A,Y]=this.screenToPageTranslation(h.movementX,h.movementY);this._uiManager.dragSelectedEditors(A,Y)},window.addEventListener("pointermove",O,rt));const l=()=>{if(window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),C&&window.removeEventListener("pointermove",O,rt),Z(this,m,!1),!this._uiManager.endDragSession()){const{isMac:h}=G.FeatureTest.platform;y.ctrlKey&&!h||y.shiftKey||y.metaKey&&h?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",l),window.addEventListener("blur",l)},tt(M,d),Kt(M,"_borderLineWidth",-1),Kt(M,"_colorManager",new S.ColorManager),Kt(M,"_zIndex",1),Kt(M,"SMALL_EDITOR_SIZE",0);let et=M;L.AnnotationEditor=et;class V extends et{constructor(y){super(y),this.annotationElementId=y.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(Ct,L,mt)=>{var p,c,v,b,m,Je,g,i,e,n,r,tn,o,E,W,D,B,z,M,Q,y,C,rt,O,l,h,A,Y,K,k,J,at,ft,pt,vt,Et,Pt,ct,lt,I,q,nt,P,s,w,U,F,en,Qe,Ze,Ce,ti,ei,Zt,fe,nn,sn,ii,pe,ni;Object.defineProperty(L,"__esModule",{value:!0}),L.KeyboardManager=L.CommandManager=L.ColorManager=L.AnnotationEditorUIManager=void 0,L.bindEvents=bt,L.opacityToHex=et;var S=mt(1),G=mt(6);function bt(Ht,X,gt){for(const Lt of gt)X.addEventListener(Lt,Ht[Lt].bind(Ht))}function et(Ht){return Math.round(Math.min(255,Math.max(1,255*Ht))).toString(16).padStart(2,"0")}class V{constructor(){tt(this,p,0)}getId(){return`${S.AnnotationEditorPrefix}${ae(this,p)._++}`}}p=new WeakMap;const _=class _{constructor(){tt(this,m);tt(this,c,(0,S.getUuid)());tt(this,v,0);tt(this,b,null)}static get _isSVGFittingCanvas(){const X='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Lt=new OffscreenCanvas(1,3).getContext("2d"),Dt=new Image;Dt.src=X;const Ot=Dt.decode().then(()=>(Lt.drawImage(Dt,0,0,1,1,0,0,1,3),new Uint32Array(Lt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,S.shadow)(this,"_isSVGFittingCanvas",Ot)}async getFromFile(X){const{lastModified:gt,name:Lt,size:Dt,type:Ot}=X;return j(this,m,Je).call(this,`${gt}_${Lt}_${Dt}_${Ot}`,X)}async getFromUrl(X){return j(this,m,Je).call(this,X,X)}async getFromId(X){t(this,b)||Z(this,b,new Map);const gt=t(this,b).get(X);return gt?gt.bitmap?(gt.refCounter+=1,gt):gt.file?this.getFromFile(gt.file):this.getFromUrl(gt.url):null}getSvgUrl(X){const gt=t(this,b).get(X);return gt!=null&&gt.isSvg?gt.svgUrl:null}deleteId(X){t(this,b)||Z(this,b,new Map);const gt=t(this,b).get(X);gt&&(gt.refCounter-=1,gt.refCounter===0&&(gt.bitmap=null))}isValidId(X){return X.startsWith(`image_${t(this,c)}_`)}};c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakSet,Je=async function(X,gt){t(this,b)||Z(this,b,new Map);let Lt=t(this,b).get(X);if(Lt===null)return null;if(Lt!=null&&Lt.bitmap)return Lt.refCounter+=1,Lt;try{Lt||(Lt={bitmap:null,id:`image_${t(this,c)}_${ae(this,v)._++}`,refCounter:0,isSvg:!1});let Dt;if(typeof gt=="string"){Lt.url=gt;const Ot=await fetch(gt);if(!Ot.ok)throw new Error(Ot.statusText);Dt=await Ot.blob()}else Dt=Lt.file=gt;if(Dt.type==="image/svg+xml"){const Ot=_._isSVGFittingCanvas,Rt=new FileReader,$=new Image,H=new Promise((st,_t)=>{$.onload=()=>{Lt.bitmap=$,Lt.isSvg=!0,st()},Rt.onload=async()=>{const yt=Lt.svgUrl=Rt.result;$.src=await Ot?`${yt}#svgView(preserveAspectRatio(none))`:yt},$.onerror=Rt.onerror=_t});Rt.readAsDataURL(Dt),await H}else Lt.bitmap=await createImageBitmap(Dt);Lt.refCounter=1}catch(Dt){console.error(Dt),Lt=null}return t(this,b).set(X,Lt),Lt&&t(this,b).set(Lt.id,Lt),Lt};let R=_;class f{constructor(X=128){tt(this,g,[]);tt(this,i,!1);tt(this,e);tt(this,n,-1);Z(this,e,X)}add({cmd:X,undo:gt,mustExec:Lt,type:Dt=NaN,overwriteIfSameType:Ot=!1,keepUndo:Rt=!1}){if(Lt&&X(),t(this,i))return;const $={cmd:X,undo:gt,type:Dt};if(t(this,n)===-1){t(this,g).length>0&&(t(this,g).length=0),Z(this,n,0),t(this,g).push($);return}if(Ot&&t(this,g)[t(this,n)].type===Dt){Rt&&($.undo=t(this,g)[t(this,n)].undo),t(this,g)[t(this,n)]=$;return}const H=t(this,n)+1;H===t(this,e)?t(this,g).splice(0,1):(Z(this,n,H),H<t(this,g).length&&t(this,g).splice(H)),t(this,g).push($)}undo(){t(this,n)!==-1&&(Z(this,i,!0),t(this,g)[t(this,n)].undo(),Z(this,i,!1),Z(this,n,t(this,n)-1))}redo(){t(this,n)<t(this,g).length-1&&(Z(this,n,t(this,n)+1),Z(this,i,!0),t(this,g)[t(this,n)].cmd(),Z(this,i,!1))}hasSomethingToUndo(){return t(this,n)!==-1}hasSomethingToRedo(){return t(this,n)<t(this,g).length-1}destroy(){Z(this,g,null)}}g=new WeakMap,i=new WeakMap,e=new WeakMap,n=new WeakMap,L.CommandManager=f;class a{constructor(X){tt(this,r);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gt}=S.FeatureTest.platform;for(const[Lt,Dt,Ot={}]of X)for(const Rt of Lt){const $=Rt.startsWith("mac+");gt&&$?(this.callbacks.set(Rt.slice(4),{callback:Dt,options:Ot}),this.allKeys.add(Rt.split("+").at(-1))):!gt&&!$&&(this.callbacks.set(Rt,{callback:Dt,options:Ot}),this.allKeys.add(Rt.split("+").at(-1)))}}exec(X,gt){if(!this.allKeys.has(gt.key))return;const Lt=this.callbacks.get(j(this,r,tn).call(this,gt));if(!Lt)return;const{callback:Dt,options:{bubbles:Ot=!1,args:Rt=[],checker:$=null}}=Lt;$&&!$(X,gt)||(Dt.bind(X,...Rt)(),Ot||(gt.stopPropagation(),gt.preventDefault()))}}r=new WeakSet,tn=function(X){X.altKey&&this.buffer.push("alt"),X.ctrlKey&&this.buffer.push("ctrl"),X.metaKey&&this.buffer.push("meta"),X.shiftKey&&this.buffer.push("shift"),this.buffer.push(X.key);const gt=this.buffer.join("+");return this.buffer.length=0,gt},L.KeyboardManager=a;const T=class T{get _colors(){const X=new Map([["CanvasText",null],["Canvas",null]]);return(0,G.getColorValues)(X),(0,S.shadow)(this,"_colors",X)}convert(X){const gt=(0,G.getRGB)(X);if(!window.matchMedia("(forced-colors: active)").matches)return gt;for(const[Lt,Dt]of this._colors)if(Dt.every((Ot,Rt)=>Ot===gt[Rt]))return T._colorsMapping.get(Lt);return gt}getHexCode(X){const gt=this._colors.get(X);return gt?S.Util.makeHexColor(...gt):X}};Kt(T,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let N=T;L.ColorManager=N;const Wt=class Wt{constructor(X,gt,Lt,Dt,Ot,Rt){tt(this,F);tt(this,o,null);tt(this,E,new Map);tt(this,W,new Map);tt(this,D,null);tt(this,B,null);tt(this,z,new f);tt(this,M,0);tt(this,Q,new Set);tt(this,y,null);tt(this,C,null);tt(this,rt,new Set);tt(this,O,null);tt(this,l,new V);tt(this,h,!1);tt(this,A,!1);tt(this,Y,null);tt(this,K,S.AnnotationEditorType.NONE);tt(this,k,new Set);tt(this,J,null);tt(this,at,this.blur.bind(this));tt(this,ft,this.focus.bind(this));tt(this,pt,this.copy.bind(this));tt(this,vt,this.cut.bind(this));tt(this,Et,this.paste.bind(this));tt(this,Pt,this.keydown.bind(this));tt(this,ct,this.onEditingAction.bind(this));tt(this,lt,this.onPageChanging.bind(this));tt(this,I,this.onScaleChanging.bind(this));tt(this,q,this.onRotationChanging.bind(this));tt(this,nt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});tt(this,P,[0,0]);tt(this,s,null);tt(this,w,null);tt(this,U,null);Z(this,w,X),Z(this,U,gt),Z(this,D,Lt),this._eventBus=Dt,this._eventBus._on("editingaction",t(this,ct)),this._eventBus._on("pagechanging",t(this,lt)),this._eventBus._on("scalechanging",t(this,I)),this._eventBus._on("rotationchanging",t(this,q)),Z(this,B,Ot.annotationStorage),Z(this,O,Ot.filterFactory),Z(this,J,Rt),this.viewParameters={realScale:G.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const X=Wt.prototype,gt=Ot=>{const{activeElement:Rt}=document;return Rt&&t(Ot,w).contains(Rt)&&Ot.hasSomethingToControl()},Lt=this.TRANSLATE_SMALL,Dt=this.TRANSLATE_BIG;return(0,S.shadow)(this,"_keyboardManager",new a([[["ctrl+a","mac+meta+a"],X.selectAll],[["ctrl+z","mac+meta+z"],X.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],X.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],X.delete],[["Escape","mac+Escape"],X.unselectAll],[["ArrowLeft","mac+ArrowLeft"],X.translateSelectedEditors,{args:[-Lt,0],checker:gt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],X.translateSelectedEditors,{args:[-Dt,0],checker:gt}],[["ArrowRight","mac+ArrowRight"],X.translateSelectedEditors,{args:[Lt,0],checker:gt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],X.translateSelectedEditors,{args:[Dt,0],checker:gt}],[["ArrowUp","mac+ArrowUp"],X.translateSelectedEditors,{args:[0,-Lt],checker:gt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],X.translateSelectedEditors,{args:[0,-Dt],checker:gt}],[["ArrowDown","mac+ArrowDown"],X.translateSelectedEditors,{args:[0,Lt],checker:gt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],X.translateSelectedEditors,{args:[0,Dt],checker:gt}]]))}destroy(){j(this,F,Ce).call(this),j(this,F,Qe).call(this),this._eventBus._off("editingaction",t(this,ct)),this._eventBus._off("pagechanging",t(this,lt)),this._eventBus._off("scalechanging",t(this,I)),this._eventBus._off("rotationchanging",t(this,q));for(const X of t(this,W).values())X.destroy();t(this,W).clear(),t(this,E).clear(),t(this,rt).clear(),Z(this,o,null),t(this,k).clear(),t(this,z).destroy(),t(this,D).destroy()}get hcmFilter(){return(0,S.shadow)(this,"hcmFilter",t(this,J)?t(this,O).addHCMFilter(t(this,J).foreground,t(this,J).background):"none")}get direction(){return(0,S.shadow)(this,"direction",getComputedStyle(t(this,w)).direction)}editAltText(X){var gt;(gt=t(this,D))==null||gt.editAltText(this,X)}onPageChanging({pageNumber:X}){Z(this,M,X-1)}focusMainContainer(){t(this,w).focus()}findParent(X,gt){for(const Lt of t(this,W).values()){const{x:Dt,y:Ot,width:Rt,height:$}=Lt.div.getBoundingClientRect();if(X>=Dt&&X<=Dt+Rt&&gt>=Ot&&gt<=Ot+$)return Lt}return null}disableUserSelect(X=!1){t(this,U).classList.toggle("noUserSelect",X)}addShouldRescale(X){t(this,rt).add(X)}removeShouldRescale(X){t(this,rt).delete(X)}onScaleChanging({scale:X}){this.commitOrRemove(),this.viewParameters.realScale=X*G.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gt of t(this,rt))gt.onScaleChanging()}onRotationChanging({pagesRotation:X}){this.commitOrRemove(),this.viewParameters.rotation=X}addToAnnotationStorage(X){!X.isEmpty()&&t(this,B)&&!t(this,B).has(X.id)&&t(this,B).setValue(X.id,X)}blur(){if(!this.hasSelection)return;const{activeElement:X}=document;for(const gt of t(this,k))if(gt.div.contains(X)){Z(this,Y,[gt,X]),gt._focusEventsAllowed=!1;break}}focus(){if(!t(this,Y))return;const[X,gt]=t(this,Y);Z(this,Y,null),gt.addEventListener("focusin",()=>{X._focusEventsAllowed=!0},{once:!0}),gt.focus()}addEditListeners(){j(this,F,Ze).call(this),j(this,F,ti).call(this)}removeEditListeners(){j(this,F,Ce).call(this),j(this,F,ei).call(this)}copy(X){var Lt;if(X.preventDefault(),(Lt=t(this,o))==null||Lt.commitOrRemove(),!this.hasSelection)return;const gt=[];for(const Dt of t(this,k)){const Ot=Dt.serialize(!0);Ot&&gt.push(Ot)}gt.length!==0&&X.clipboardData.setData("application/pdfjs",JSON.stringify(gt))}cut(X){this.copy(X),this.delete()}paste(X){X.preventDefault();const{clipboardData:gt}=X;for(const Ot of gt.items)for(const Rt of t(this,C))if(Rt.isHandlingMimeForPasting(Ot.type)){Rt.paste(Ot,this.currentLayer);return}let Lt=gt.getData("application/pdfjs");if(!Lt)return;try{Lt=JSON.parse(Lt)}catch(Ot){(0,S.warn)(`paste: "${Ot.message}".`);return}if(!Array.isArray(Lt))return;this.unselectAll();const Dt=this.currentLayer;try{const Ot=[];for(const H of Lt){const st=Dt.deserialize(H);if(!st)return;Ot.push(st)}const Rt=()=>{for(const H of Ot)j(this,F,ii).call(this,H);j(this,F,ni).call(this,Ot)},$=()=>{for(const H of Ot)H.remove()};this.addCommands({cmd:Rt,undo:$,mustExec:!0})}catch(Ot){(0,S.warn)(`paste: "${Ot.message}".`)}}keydown(X){var gt;(gt=this.getActive())!=null&&gt.shouldGetKeyboardEvents()||Wt._keyboardManager.exec(this,X)}onEditingAction(X){["undo","redo","delete","selectAll"].includes(X.name)&&this[X.name]()}setEditingState(X){X?(j(this,F,en).call(this),j(this,F,Ze).call(this),j(this,F,ti).call(this),j(this,F,Zt).call(this,{isEditing:t(this,K)!==S.AnnotationEditorType.NONE,isEmpty:j(this,F,pe).call(this),hasSomethingToUndo:t(this,z).hasSomethingToUndo(),hasSomethingToRedo:t(this,z).hasSomethingToRedo(),hasSelectedEditor:!1})):(j(this,F,Qe).call(this),j(this,F,Ce).call(this),j(this,F,ei).call(this),j(this,F,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(X){if(!t(this,C)){Z(this,C,X);for(const gt of t(this,C))j(this,F,fe).call(this,gt.defaultPropertiesToUpdate)}}getId(){return t(this,l).getId()}get currentLayer(){return t(this,W).get(t(this,M))}getLayer(X){return t(this,W).get(X)}get currentPageIndex(){return t(this,M)}addLayer(X){t(this,W).set(X.pageIndex,X),t(this,h)?X.enable():X.disable()}removeLayer(X){t(this,W).delete(X.pageIndex)}updateMode(X,gt=null){if(t(this,K)!==X){if(Z(this,K,X),X===S.AnnotationEditorType.NONE){this.setEditingState(!1),j(this,F,sn).call(this);return}this.setEditingState(!0),j(this,F,nn).call(this),this.unselectAll();for(const Lt of t(this,W).values())Lt.updateMode(X);if(gt){for(const Lt of t(this,E).values())if(Lt.annotationElementId===gt){this.setSelected(Lt),Lt.enterInEditMode();break}}}}updateToolbar(X){X!==t(this,K)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:X})}updateParams(X,gt){if(t(this,C)){if(X===S.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(X);return}for(const Lt of t(this,k))Lt.updateParams(X,gt);for(const Lt of t(this,C))Lt.updateDefaultParams(X,gt)}}enableWaiting(X=!1){if(t(this,A)!==X){Z(this,A,X);for(const gt of t(this,W).values())X?gt.disableClick():gt.enableClick(),gt.div.classList.toggle("waiting",X)}}getEditors(X){const gt=[];for(const Lt of t(this,E).values())Lt.pageIndex===X&&gt.push(Lt);return gt}getEditor(X){return t(this,E).get(X)}addEditor(X){t(this,E).set(X.id,X)}removeEditor(X){var gt;t(this,E).delete(X.id),this.unselect(X),(!X.annotationElementId||!t(this,Q).has(X.annotationElementId))&&((gt=t(this,B))==null||gt.remove(X.id))}addDeletedAnnotationElement(X){t(this,Q).add(X.annotationElementId),X.deleted=!0}isDeletedAnnotationElement(X){return t(this,Q).has(X)}removeDeletedAnnotationElement(X){t(this,Q).delete(X.annotationElementId),X.deleted=!1}setActiveEditor(X){t(this,o)!==X&&(Z(this,o,X),X&&j(this,F,fe).call(this,X.propertiesToUpdate))}toggleSelected(X){if(t(this,k).has(X)){t(this,k).delete(X),X.unselect(),j(this,F,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,k).add(X),X.select(),j(this,F,fe).call(this,X.propertiesToUpdate),j(this,F,Zt).call(this,{hasSelectedEditor:!0})}setSelected(X){for(const gt of t(this,k))gt!==X&&gt.unselect();t(this,k).clear(),t(this,k).add(X),X.select(),j(this,F,fe).call(this,X.propertiesToUpdate),j(this,F,Zt).call(this,{hasSelectedEditor:!0})}isSelected(X){return t(this,k).has(X)}unselect(X){X.unselect(),t(this,k).delete(X),j(this,F,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,k).size!==0}undo(){t(this,z).undo(),j(this,F,Zt).call(this,{hasSomethingToUndo:t(this,z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:j(this,F,pe).call(this)})}redo(){t(this,z).redo(),j(this,F,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,z).hasSomethingToRedo(),isEmpty:j(this,F,pe).call(this)})}addCommands(X){t(this,z).add(X),j(this,F,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:j(this,F,pe).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const X=[...t(this,k)],gt=()=>{for(const Dt of X)Dt.remove()},Lt=()=>{for(const Dt of X)j(this,F,ii).call(this,Dt)};this.addCommands({cmd:gt,undo:Lt,mustExec:!0})}commitOrRemove(){var X;(X=t(this,o))==null||X.commitOrRemove()}hasSomethingToControl(){return t(this,o)||this.hasSelection}selectAll(){for(const X of t(this,k))X.commit();j(this,F,ni).call(this,t(this,E).values())}unselectAll(){if(t(this,o)){t(this,o).commitOrRemove();return}if(this.hasSelection){for(const X of t(this,k))X.unselect();t(this,k).clear(),j(this,F,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(X,gt,Lt=!1){if(Lt||this.commitOrRemove(),!this.hasSelection)return;t(this,P)[0]+=X,t(this,P)[1]+=gt;const[Dt,Ot]=t(this,P),Rt=[...t(this,k)],$=1e3;t(this,s)&&clearTimeout(t(this,s)),Z(this,s,setTimeout(()=>{Z(this,s,null),t(this,P)[0]=t(this,P)[1]=0,this.addCommands({cmd:()=>{for(const H of Rt)t(this,E).has(H.id)&&H.translateInPage(Dt,Ot)},undo:()=>{for(const H of Rt)t(this,E).has(H.id)&&H.translateInPage(-Dt,-Ot)},mustExec:!1})},$));for(const H of Rt)H.translateInPage(X,gt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Z(this,y,new Map);for(const X of t(this,k))t(this,y).set(X,{savedX:X.x,savedY:X.y,savedPageIndex:X.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,y))return!1;this.disableUserSelect(!1);const X=t(this,y);Z(this,y,null);let gt=!1;for(const[{x:Dt,y:Ot,pageIndex:Rt},$]of X)$.newX=Dt,$.newY=Ot,$.newPageIndex=Rt,gt||(gt=Dt!==$.savedX||Ot!==$.savedY||Rt!==$.savedPageIndex);if(!gt)return!1;const Lt=(Dt,Ot,Rt,$)=>{if(t(this,E).has(Dt.id)){const H=t(this,W).get($);H?Dt._setParentAndPosition(H,Ot,Rt):(Dt.pageIndex=$,Dt.x=Ot,Dt.y=Rt)}};return this.addCommands({cmd:()=>{for(const[Dt,{newX:Ot,newY:Rt,newPageIndex:$}]of X)Lt(Dt,Ot,Rt,$)},undo:()=>{for(const[Dt,{savedX:Ot,savedY:Rt,savedPageIndex:$}]of X)Lt(Dt,Ot,Rt,$)},mustExec:!0}),!0}dragSelectedEditors(X,gt){if(t(this,y))for(const Lt of t(this,y).keys())Lt.drag(X,gt)}rebuild(X){if(X.parent===null){const gt=this.getLayer(X.pageIndex);gt?(gt.changeParent(X),gt.addOrRebuild(X)):(this.addEditor(X),this.addToAnnotationStorage(X),X.rebuild())}else X.parent.addOrRebuild(X)}isActive(X){return t(this,o)===X}getActive(){return t(this,o)}getMode(){return t(this,K)}get imageManager(){return(0,S.shadow)(this,"imageManager",new R)}};o=new WeakMap,E=new WeakMap,W=new WeakMap,D=new WeakMap,B=new WeakMap,z=new WeakMap,M=new WeakMap,Q=new WeakMap,y=new WeakMap,C=new WeakMap,rt=new WeakMap,O=new WeakMap,l=new WeakMap,h=new WeakMap,A=new WeakMap,Y=new WeakMap,K=new WeakMap,k=new WeakMap,J=new WeakMap,at=new WeakMap,ft=new WeakMap,pt=new WeakMap,vt=new WeakMap,Et=new WeakMap,Pt=new WeakMap,ct=new WeakMap,lt=new WeakMap,I=new WeakMap,q=new WeakMap,nt=new WeakMap,P=new WeakMap,s=new WeakMap,w=new WeakMap,U=new WeakMap,F=new WeakSet,en=function(){window.addEventListener("focus",t(this,ft)),window.addEventListener("blur",t(this,at))},Qe=function(){window.removeEventListener("focus",t(this,ft)),window.removeEventListener("blur",t(this,at))},Ze=function(){window.addEventListener("keydown",t(this,Pt),{capture:!0})},Ce=function(){window.removeEventListener("keydown",t(this,Pt),{capture:!0})},ti=function(){document.addEventListener("copy",t(this,pt)),document.addEventListener("cut",t(this,vt)),document.addEventListener("paste",t(this,Et))},ei=function(){document.removeEventListener("copy",t(this,pt)),document.removeEventListener("cut",t(this,vt)),document.removeEventListener("paste",t(this,Et))},Zt=function(X){Object.entries(X).some(([Lt,Dt])=>t(this,nt)[Lt]!==Dt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,nt),X)})},fe=function(X){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:X})},nn=function(){if(!t(this,h)){Z(this,h,!0);for(const X of t(this,W).values())X.enable()}},sn=function(){if(this.unselectAll(),t(this,h)){Z(this,h,!1);for(const X of t(this,W).values())X.disable()}},ii=function(X){const gt=t(this,W).get(X.pageIndex);gt?gt.addOrRebuild(X):this.addEditor(X)},pe=function(){if(t(this,E).size===0)return!0;if(t(this,E).size===1)for(const X of t(this,E).values())return X.isEmpty();return!1},ni=function(X){t(this,k).clear();for(const gt of X)gt.isEmpty()||(t(this,k).add(gt),gt.select());j(this,F,Zt).call(this,{hasSelectedEditor:!0})},Kt(Wt,"TRANSLATE_SMALL",1),Kt(Wt,"TRANSLATE_BIG",10);let x=Wt;L.AnnotationEditorUIManager=x},(Ct,L,mt)=>{var M,Q,y,C,rt,O,l,h,A,Y,K,k,le,ce,si,Te,xe,ge,me;Object.defineProperty(L,"__esModule",{value:!0}),L.StatTimer=L.RenderingCancelledException=L.PixelsPerInch=L.PageViewport=L.PDFDateString=L.DOMStandardFontDataFactory=L.DOMSVGFactory=L.DOMFilterFactory=L.DOMCanvasFactory=L.DOMCMapReaderFactory=void 0,L.deprecated=n,L.getColorValues=E,L.getCurrentTransform=W,L.getCurrentTransformInverse=D,L.getFilenameFromUrl=m,L.getPdfFilenameFromUrl=u,L.getRGB=o,L.getXfaPageViewport=T,L.isDataScheme=v,L.isPdfFile=b,L.isValidFetchUrl=g,L.loadScript=e,L.noContextMenu=i,L.setLayerDimensions=B;var S=mt(7),G=mt(1);const bt="http://www.w3.org/2000/svg",z=class z{};Kt(z,"CSS",96),Kt(z,"PDF",72),Kt(z,"PDF_TO_CSS_UNITS",z.CSS/z.PDF);let et=z;L.PixelsPerInch=et;class V extends S.BaseFilterFactory{constructor({docId:I,ownerDocument:q=globalThis.document}={}){super();tt(this,k);tt(this,M);tt(this,Q);tt(this,y);tt(this,C);tt(this,rt);tt(this,O);tt(this,l);tt(this,h);tt(this,A);tt(this,Y);tt(this,K,0);Z(this,y,I),Z(this,C,q)}addFilter(I){if(!I)return"none";let q=t(this,k,le).get(I);if(q)return q;let nt,P,s,w;if(I.length===1){const ot=I[0],At=new Array(256);for(let dt=0;dt<256;dt++)At[dt]=ot[dt]/255;w=nt=P=s=At.join(",")}else{const[ot,At,dt]=I,Mt=new Array(256),xt=new Array(256),kt=new Array(256);for(let jt=0;jt<256;jt++)Mt[jt]=ot[jt]/255,xt[jt]=At[jt]/255,kt[jt]=dt[jt]/255;nt=Mt.join(","),P=xt.join(","),s=kt.join(","),w=`${nt}${P}${s}`}if(q=t(this,k,le).get(w),q)return t(this,k,le).set(I,q),q;const U=`g_${t(this,y)}_transfer_map_${ae(this,K)._++}`,F=`url(#${U})`;t(this,k,le).set(I,F),t(this,k,le).set(w,F);const it=j(this,k,Te).call(this,U);return j(this,k,ge).call(this,nt,P,s,it),F}addHCMFilter(I,q){var At;const nt=`${I}-${q}`;if(t(this,O)===nt)return t(this,l);if(Z(this,O,nt),Z(this,l,"none"),(At=t(this,rt))==null||At.remove(),!I||!q)return t(this,l);const P=j(this,k,me).call(this,I);I=G.Util.makeHexColor(...P);const s=j(this,k,me).call(this,q);if(q=G.Util.makeHexColor(...s),t(this,k,ce).style.color="",I==="#000000"&&q==="#ffffff"||I===q)return t(this,l);const w=new Array(256);for(let dt=0;dt<=255;dt++){const Mt=dt/255;w[dt]=Mt<=.03928?Mt/12.92:((Mt+.055)/1.055)**2.4}const U=w.join(","),F=`g_${t(this,y)}_hcm_filter`,it=Z(this,h,j(this,k,Te).call(this,F));j(this,k,ge).call(this,U,U,U,it),j(this,k,si).call(this,it);const ot=(dt,Mt)=>{const xt=P[dt]/255,kt=s[dt]/255,jt=new Array(Mt+1);for(let $t=0;$t<=Mt;$t++)jt[$t]=xt+$t/Mt*(kt-xt);return jt.join(",")};return j(this,k,ge).call(this,ot(0,5),ot(1,5),ot(2,5),it),Z(this,l,`url(#${F})`),t(this,l)}addHighlightHCMFilter(I,q,nt,P){var kt;const s=`${I}-${q}-${nt}-${P}`;if(t(this,A)===s)return t(this,Y);if(Z(this,A,s),Z(this,Y,"none"),(kt=t(this,h))==null||kt.remove(),!I||!q)return t(this,Y);const[w,U]=[I,q].map(j(this,k,me).bind(this));let F=Math.round(.2126*w[0]+.7152*w[1]+.0722*w[2]),it=Math.round(.2126*U[0]+.7152*U[1]+.0722*U[2]),[ot,At]=[nt,P].map(j(this,k,me).bind(this));it<F&&([F,it,ot,At]=[it,F,At,ot]),t(this,k,ce).style.color="";const dt=(jt,$t,St)=>{const ht=new Array(256),ut=(it-F)/St,Ft=jt/255,Wt=($t-jt)/(255*St);let Ht=0;for(let X=0;X<=St;X++){const gt=Math.round(F+X*ut),Lt=Ft+X*Wt;for(let Dt=Ht;Dt<=gt;Dt++)ht[Dt]=Lt;Ht=gt+1}for(let X=Ht;X<256;X++)ht[X]=ht[Ht-1];return ht.join(",")},Mt=`g_${t(this,y)}_hcm_highlight_filter`,xt=Z(this,h,j(this,k,Te).call(this,Mt));return j(this,k,si).call(this,xt),j(this,k,ge).call(this,dt(ot[0],At[0],5),dt(ot[1],At[1],5),dt(ot[2],At[2],5),xt),Z(this,Y,`url(#${Mt})`),t(this,Y)}destroy(I=!1){I&&(t(this,l)||t(this,Y))||(t(this,Q)&&(t(this,Q).parentNode.parentNode.remove(),Z(this,Q,null)),t(this,M)&&(t(this,M).clear(),Z(this,M,null)),Z(this,K,0))}}M=new WeakMap,Q=new WeakMap,y=new WeakMap,C=new WeakMap,rt=new WeakMap,O=new WeakMap,l=new WeakMap,h=new WeakMap,A=new WeakMap,Y=new WeakMap,K=new WeakMap,k=new WeakSet,le=function(){return t(this,M)||Z(this,M,new Map)},ce=function(){if(!t(this,Q)){const I=t(this,C).createElement("div"),{style:q}=I;q.visibility="hidden",q.contain="strict",q.width=q.height=0,q.position="absolute",q.top=q.left=0,q.zIndex=-1;const nt=t(this,C).createElementNS(bt,"svg");nt.setAttribute("width",0),nt.setAttribute("height",0),Z(this,Q,t(this,C).createElementNS(bt,"defs")),I.append(nt),nt.append(t(this,Q)),t(this,C).body.append(I)}return t(this,Q)},si=function(I){const q=t(this,C).createElementNS(bt,"feColorMatrix");q.setAttribute("type","matrix"),q.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),I.append(q)},Te=function(I){const q=t(this,C).createElementNS(bt,"filter");return q.setAttribute("color-interpolation-filters","sRGB"),q.setAttribute("id",I),t(this,k,ce).append(q),q},xe=function(I,q,nt){const P=t(this,C).createElementNS(bt,q);P.setAttribute("type","discrete"),P.setAttribute("tableValues",nt),I.append(P)},ge=function(I,q,nt,P){const s=t(this,C).createElementNS(bt,"feComponentTransfer");P.append(s),j(this,k,xe).call(this,s,"feFuncR",I),j(this,k,xe).call(this,s,"feFuncG",q),j(this,k,xe).call(this,s,"feFuncB",nt)},me=function(I){return t(this,k,ce).style.color=I,o(getComputedStyle(t(this,k,ce)).getPropertyValue("color"))},L.DOMFilterFactory=V;class R extends S.BaseCanvasFactory{constructor({ownerDocument:lt=globalThis.document}={}){super(),this._document=lt}_createCanvas(lt,I){const q=this._document.createElement("canvas");return q.width=lt,q.height=I,q}}L.DOMCanvasFactory=R;async function f(ct,lt=!1){if(g(ct,document.baseURI)){const I=await fetch(ct);if(!I.ok)throw new Error(I.statusText);return lt?new Uint8Array(await I.arrayBuffer()):(0,G.stringToBytes)(await I.text())}return new Promise((I,q)=>{const nt=new XMLHttpRequest;nt.open("GET",ct,!0),lt&&(nt.responseType="arraybuffer"),nt.onreadystatechange=()=>{if(nt.readyState===XMLHttpRequest.DONE){if(nt.status===200||nt.status===0){let P;if(lt&&nt.response?P=new Uint8Array(nt.response):!lt&&nt.responseText&&(P=(0,G.stringToBytes)(nt.responseText)),P){I(P);return}}q(new Error(nt.statusText))}},nt.send(null)})}class a extends S.BaseCMapReaderFactory{_fetchData(lt,I){return f(lt,this.isCompressed).then(q=>({cMapData:q,compressionType:I}))}}L.DOMCMapReaderFactory=a;class N extends S.BaseStandardFontDataFactory{_fetchData(lt){return f(lt,!0)}}L.DOMStandardFontDataFactory=N;class x extends S.BaseSVGFactory{_createSVG(lt){return document.createElementNS(bt,lt)}}L.DOMSVGFactory=x;class p{constructor({viewBox:lt,scale:I,rotation:q,offsetX:nt=0,offsetY:P=0,dontFlip:s=!1}){this.viewBox=lt,this.scale=I,this.rotation=q,this.offsetX=nt,this.offsetY=P;const w=(lt[2]+lt[0])/2,U=(lt[3]+lt[1])/2;let F,it,ot,At;switch(q%=360,q<0&&(q+=360),q){case 180:F=-1,it=0,ot=0,At=1;break;case 90:F=0,it=1,ot=1,At=0;break;case 270:F=0,it=-1,ot=-1,At=0;break;case 0:F=1,it=0,ot=0,At=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(ot=-ot,At=-At);let dt,Mt,xt,kt;F===0?(dt=Math.abs(U-lt[1])*I+nt,Mt=Math.abs(w-lt[0])*I+P,xt=(lt[3]-lt[1])*I,kt=(lt[2]-lt[0])*I):(dt=Math.abs(w-lt[0])*I+nt,Mt=Math.abs(U-lt[1])*I+P,xt=(lt[2]-lt[0])*I,kt=(lt[3]-lt[1])*I),this.transform=[F*I,it*I,ot*I,At*I,dt-F*I*w-ot*I*U,Mt-it*I*w-At*I*U],this.width=xt,this.height=kt}get rawDims(){const{viewBox:lt}=this;return(0,G.shadow)(this,"rawDims",{pageWidth:lt[2]-lt[0],pageHeight:lt[3]-lt[1],pageX:lt[0],pageY:lt[1]})}clone({scale:lt=this.scale,rotation:I=this.rotation,offsetX:q=this.offsetX,offsetY:nt=this.offsetY,dontFlip:P=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:lt,rotation:I,offsetX:q,offsetY:nt,dontFlip:P})}convertToViewportPoint(lt,I){return G.Util.applyTransform([lt,I],this.transform)}convertToViewportRectangle(lt){const I=G.Util.applyTransform([lt[0],lt[1]],this.transform),q=G.Util.applyTransform([lt[2],lt[3]],this.transform);return[I[0],I[1],q[0],q[1]]}convertToPdfPoint(lt,I){return G.Util.applyInverseTransform([lt,I],this.transform)}}L.PageViewport=p;class c extends G.BaseException{constructor(lt,I=0){super(lt,"RenderingCancelledException"),this.extraDelay=I}}L.RenderingCancelledException=c;function v(ct){const lt=ct.length;let I=0;for(;I<lt&&ct[I].trim()==="";)I++;return ct.substring(I,I+5).toLowerCase()==="data:"}function b(ct){return typeof ct=="string"&&/\.pdf$/i.test(ct)}function m(ct,lt=!1){return lt||([ct]=ct.split(/[#?]/,1)),ct.substring(ct.lastIndexOf("/")+1)}function u(ct,lt="document.pdf"){if(typeof ct!="string")return lt;if(v(ct))return(0,G.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),lt;const I=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,nt=I.exec(ct);let P=q.exec(nt[1])||q.exec(nt[2])||q.exec(nt[3]);if(P&&(P=P[0],P.includes("%")))try{P=q.exec(decodeURIComponent(P))[0]}catch{}return P||lt}class _{constructor(){Kt(this,"started",Object.create(null));Kt(this,"times",[])}time(lt){lt in this.started&&(0,G.warn)(`Timer is already running for ${lt}`),this.started[lt]=Date.now()}timeEnd(lt){lt in this.started||(0,G.warn)(`Timer has not been started for ${lt}`),this.times.push({name:lt,start:this.started[lt],end:Date.now()}),delete this.started[lt]}toString(){const lt=[];let I=0;for(const{name:q}of this.times)I=Math.max(q.length,I);for(const{name:q,start:nt,end:P}of this.times)lt.push(`${q.padEnd(I)} ${P-nt}ms
`);return lt.join("")}}L.StatTimer=_;function g(ct,lt){try{const{protocol:I}=lt?new URL(ct,lt):new URL(ct);return I==="http:"||I==="https:"}catch{return!1}}function i(ct){ct.preventDefault()}function e(ct,lt=!1){return new Promise((I,q)=>{const nt=document.createElement("script");nt.src=ct,nt.onload=function(P){lt&&nt.remove(),I(P)},nt.onerror=function(){q(new Error(`Cannot load script at: ${nt.src}`))},(document.head||document.documentElement).append(nt)})}function n(ct){console.log("Deprecated API usage: "+ct)}let r;class d{static toDateObject(lt){if(!lt||typeof lt!="string")return null;r||(r=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const I=r.exec(lt);if(!I)return null;const q=parseInt(I[1],10);let nt=parseInt(I[2],10);nt=nt>=1&&nt<=12?nt-1:0;let P=parseInt(I[3],10);P=P>=1&&P<=31?P:1;let s=parseInt(I[4],10);s=s>=0&&s<=23?s:0;let w=parseInt(I[5],10);w=w>=0&&w<=59?w:0;let U=parseInt(I[6],10);U=U>=0&&U<=59?U:0;const F=I[7]||"Z";let it=parseInt(I[8],10);it=it>=0&&it<=23?it:0;let ot=parseInt(I[9],10)||0;return ot=ot>=0&&ot<=59?ot:0,F==="-"?(s+=it,w+=ot):F==="+"&&(s-=it,w-=ot),new Date(Date.UTC(q,nt,P,s,w,U))}}L.PDFDateString=d;function T(ct,{scale:lt=1,rotation:I=0}){const{width:q,height:nt}=ct.attributes.style,P=[0,0,parseInt(q),parseInt(nt)];return new p({viewBox:P,scale:lt,rotation:I})}function o(ct){if(ct.startsWith("#")){const lt=parseInt(ct.slice(1),16);return[(lt&16711680)>>16,(lt&65280)>>8,lt&255]}return ct.startsWith("rgb(")?ct.slice(4,-1).split(",").map(lt=>parseInt(lt)):ct.startsWith("rgba(")?ct.slice(5,-1).split(",").map(lt=>parseInt(lt)).slice(0,3):((0,G.warn)(`Not a valid color format: "${ct}"`),[0,0,0])}function E(ct){const lt=document.createElement("span");lt.style.visibility="hidden",document.body.append(lt);for(const I of ct.keys()){lt.style.color=I;const q=window.getComputedStyle(lt).color;ct.set(I,o(q))}lt.remove()}function W(ct){const{a:lt,b:I,c:q,d:nt,e:P,f:s}=ct.getTransform();return[lt,I,q,nt,P,s]}function D(ct){const{a:lt,b:I,c:q,d:nt,e:P,f:s}=ct.getTransform().invertSelf();return[lt,I,q,nt,P,s]}function B(ct,lt,I=!1,q=!0){if(lt instanceof p){const{pageWidth:nt,pageHeight:P}=lt.rawDims,{style:s}=ct,w=G.FeatureTest.isCSSRoundSupported,U=`var(--scale-factor) * ${nt}px`,F=`var(--scale-factor) * ${P}px`,it=w?`round(${U}, 1px)`:`calc(${U})`,ot=w?`round(${F}, 1px)`:`calc(${F})`;!I||lt.rotation%180===0?(s.width=it,s.height=ot):(s.width=ot,s.height=it)}q&&ct.setAttribute("data-main-rotation",lt.rotation)}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.BaseStandardFontDataFactory=L.BaseSVGFactory=L.BaseFilterFactory=L.BaseCanvasFactory=L.BaseCMapReaderFactory=void 0;var S=mt(1);class G{constructor(){this.constructor===G&&(0,S.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(a){return"none"}addHCMFilter(a,N){return"none"}addHighlightHCMFilter(a,N,x,p){return"none"}destroy(a=!1){}}L.BaseFilterFactory=G;class bt{constructor(){this.constructor===bt&&(0,S.unreachable)("Cannot initialize BaseCanvasFactory.")}create(a,N){if(a<=0||N<=0)throw new Error("Invalid canvas size");const x=this._createCanvas(a,N);return{canvas:x,context:x.getContext("2d")}}reset(a,N,x){if(!a.canvas)throw new Error("Canvas is not specified");if(N<=0||x<=0)throw new Error("Invalid canvas size");a.canvas.width=N,a.canvas.height=x}destroy(a){if(!a.canvas)throw new Error("Canvas is not specified");a.canvas.width=0,a.canvas.height=0,a.canvas=null,a.context=null}_createCanvas(a,N){(0,S.unreachable)("Abstract method `_createCanvas` called.")}}L.BaseCanvasFactory=bt;class et{constructor({baseUrl:a=null,isCompressed:N=!0}){this.constructor===et&&(0,S.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=a,this.isCompressed=N}async fetch({name:a}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!a)throw new Error("CMap name must be specified.");const N=this.baseUrl+a+(this.isCompressed?".bcmap":""),x=this.isCompressed?S.CMapCompressionType.BINARY:S.CMapCompressionType.NONE;return this._fetchData(N,x).catch(p=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})}_fetchData(a,N){(0,S.unreachable)("Abstract method `_fetchData` called.")}}L.BaseCMapReaderFactory=et;class V{constructor({baseUrl:a=null}){this.constructor===V&&(0,S.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=a}async fetch({filename:a}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!a)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${a}`;return this._fetchData(N).catch(x=>{throw new Error(`Unable to load font data at: ${N}`)})}_fetchData(a){(0,S.unreachable)("Abstract method `_fetchData` called.")}}L.BaseStandardFontDataFactory=V;class R{constructor(){this.constructor===R&&(0,S.unreachable)("Cannot initialize BaseSVGFactory.")}create(a,N,x=!1){if(a<=0||N<=0)throw new Error("Invalid SVG dimensions");const p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),x||(p.setAttribute("width",`${a}px`),p.setAttribute("height",`${N}px`)),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${a} ${N}`),p}createElement(a){if(typeof a!="string")throw new Error("Invalid SVG element type");return this._createSVG(a)}_createSVG(a){(0,S.unreachable)("Abstract method `_createSVG` called.")}}L.BaseSVGFactory=R},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.MurmurHash3_64=void 0;var S=mt(1);const G=3285377520,bt=4294901760,et=65535;class V{constructor(f){this.h1=f?f&4294967295:G,this.h2=f?f&4294967295:G}update(f){let a,N;if(typeof f=="string"){a=new Uint8Array(f.length*2),N=0;for(let n=0,r=f.length;n<r;n++){const d=f.charCodeAt(n);d<=255?a[N++]=d:(a[N++]=d>>>8,a[N++]=d&255)}}else if((0,S.isArrayBuffer)(f))a=f.slice(),N=a.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const x=N>>2,p=N-x*4,c=new Uint32Array(a.buffer,0,x);let v=0,b=0,m=this.h1,u=this.h2;const _=3432918353,g=461845907,i=_&et,e=g&et;for(let n=0;n<x;n++)n&1?(v=c[n],v=v*_&bt|v*i&et,v=v<<15|v>>>17,v=v*g&bt|v*e&et,m^=v,m=m<<13|m>>>19,m=m*5+3864292196):(b=c[n],b=b*_&bt|b*i&et,b=b<<15|b>>>17,b=b*g&bt|b*e&et,u^=b,u=u<<13|u>>>19,u=u*5+3864292196);switch(v=0,p){case 3:v^=a[x*4+2]<<16;case 2:v^=a[x*4+1]<<8;case 1:v^=a[x*4],v=v*_&bt|v*i&et,v=v<<15|v>>>17,v=v*g&bt|v*e&et,x&1?m^=v:u^=v}this.h1=m,this.h2=u}hexdigest(){let f=this.h1,a=this.h2;return f^=a>>>1,f=f*3981806797&bt|f*36045&et,a=a*4283543511&bt|((a<<16|f>>>16)*2950163797&bt)>>>16,f^=a>>>1,f=f*444984403&bt|f*60499&et,a=a*3301882366&bt|((a<<16|f>>>16)*3120437893&bt)>>>16,f^=a>>>1,(f>>>0).toString(16).padStart(8,"0")+(a>>>0).toString(16).padStart(8,"0")}}L.MurmurHash3_64=V},(Ct,L,mt)=>{var et;Object.defineProperty(L,"__esModule",{value:!0}),L.FontLoader=L.FontFaceObject=void 0;var S=mt(1);class G{constructor({ownerDocument:R=globalThis.document,styleElement:f=null}){tt(this,et,new Set);this._document=R,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(R){this.nativeFontFaces.add(R),this._document.fonts.add(R)}removeNativeFontFace(R){this.nativeFontFaces.delete(R),this._document.fonts.delete(R)}insertRule(R){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(R,f.cssRules.length)}clear(){for(const R of this.nativeFontFaces)this._document.fonts.delete(R);this.nativeFontFaces.clear(),t(this,et).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(R){if(!(!R||t(this,et).has(R.loadedName))){if((0,S.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:f,src:a,style:N}=R,x=new FontFace(f,a,N);this.addNativeFontFace(x);try{await x.load(),t(this,et).add(f)}catch{(0,S.warn)(`Cannot load system font: ${R.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(x)}return}(0,S.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(R){if(R.attached||R.missingFile&&!R.systemFontInfo)return;if(R.attached=!0,R.systemFontInfo){await this.loadSystemFont(R.systemFontInfo);return}if(this.isFontLoadingAPISupported){const a=R.createNativeFontFace();if(a){this.addNativeFontFace(a);try{await a.loaded}catch(N){throw(0,S.warn)(`Failed to load font '${a.family}': '${N}'.`),R.disableFontFace=!0,N}}return}const f=R.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(a=>{const N=this._queueLoadingCallback(a);this._prepareFontLoadEvent(R,N)})}}get isFontLoadingAPISupported(){var f;const R=!!((f=this._document)!=null&&f.fonts);return(0,S.shadow)(this,"isFontLoadingAPISupported",R)}get isSyncFontLoadingSupported(){let R=!1;return(S.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(R=!0),(0,S.shadow)(this,"isSyncFontLoadingSupported",R)}_queueLoadingCallback(R){function f(){for((0,S.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;a.length>0&&a[0].done;){const x=a.shift();setTimeout(x.callback,0)}}const{loadingRequests:a}=this,N={done:!1,complete:f,callback:R};return a.push(N),N}get _loadTestFont(){const R=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,S.shadow)(this,"_loadTestFont",R)}_prepareFontLoadEvent(R,f){function a(o,E){return o.charCodeAt(E)<<24|o.charCodeAt(E+1)<<16|o.charCodeAt(E+2)<<8|o.charCodeAt(E+3)&255}function N(o,E,W,D){const B=o.substring(0,E),z=o.substring(E+W);return B+D+z}let x,p;const c=this._document.createElement("canvas");c.width=1,c.height=1;const v=c.getContext("2d");let b=0;function m(o,E){if(++b>30){(0,S.warn)("Load test font never loaded."),E();return}if(v.font="30px "+o,v.fillText(".",0,20),v.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(m.bind(null,o,E))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=N(_,976,u.length,u);const i=16,e=1482184792;let n=a(_,i);for(x=0,p=u.length-3;x<p;x+=4)n=n-e+a(u,x)|0;x<u.length&&(n=n-e+a(u+"XXX",x)|0),_=N(_,i,4,(0,S.string32)(n));const r=`url(data:font/opentype;base64,${btoa(_)});`,d=`@font-face {font-family:"${u}";src:${r}}`;this.insertRule(d);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const o of[R.loadedName,u]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=o,T.append(E)}this._document.body.append(T),m(u,()=>{T.remove(),f.complete()})}}et=new WeakMap,L.FontLoader=G;class bt{constructor(R,{isEvalSupported:f=!0,disableFontFace:a=!1,ignoreErrors:N=!1,inspectFont:x=null}){this.compiledGlyphs=Object.create(null);for(const p in R)this[p]=R[p];this.isEvalSupported=f!==!1,this.disableFontFace=a===!0,this.ignoreErrors=N===!0,this._inspectFont=x}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let R;if(!this.cssFontInfo)R=new FontFace(this.loadedName,this.data,{});else{const a={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(a.style=`oblique ${this.cssFontInfo.italicAngle}deg`),R=new FontFace(this.cssFontInfo.fontFamily,this.data,a)}return(f=this._inspectFont)==null||f.call(this,this),R}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const R=(0,S.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(R)});`;let a;if(!this.cssFontInfo)a=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let x=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(x+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),a=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${x}src:${f}}`}return(N=this._inspectFont)==null||N.call(this,this,f),a}getPathGenerator(R,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let a;try{a=R.get(this.loadedName+"_path_"+f)}catch(N){if(!this.ignoreErrors)throw N;return(0,S.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[f]=function(x,p){}}if(this.isEvalSupported&&S.FeatureTest.isEvalSupported){const N=[];for(const x of a){const p=x.args!==void 0?x.args.join(","):"";N.push("c.",x.cmd,"(",p,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",N.join(""))}return this.compiledGlyphs[f]=function(N,x){for(const p of a)p.cmd==="scale"&&(p.args=[x,-x]),N[p.cmd].apply(N,p.args)}}}L.FontFaceObject=bt},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.NodeStandardFontDataFactory=L.NodeFilterFactory=L.NodeCanvasFactory=L.NodeCMapReaderFactory=void 0;var S=mt(7);mt(1);const G=function(f){return new Promise((a,N)=>{require$$5.readFile(f,(p,c)=>{if(p||!c){N(new Error(p));return}a(new Uint8Array(c))})})};class bt extends S.BaseFilterFactory{}L.NodeFilterFactory=bt;class et extends S.BaseCanvasFactory{_createCanvas(a,N){return require$$5.createCanvas(a,N)}}L.NodeCanvasFactory=et;class V extends S.BaseCMapReaderFactory{_fetchData(a,N){return G(a).then(x=>({cMapData:x,compressionType:N}))}}L.NodeCMapReaderFactory=V;class R extends S.BaseStandardFontDataFactory{_fetchData(a){return G(a)}}L.NodeStandardFontDataFactory=R},(Ct,L,mt)=>{var Q,ri,ai;Object.defineProperty(L,"__esModule",{value:!0}),L.CanvasGraphics=void 0;var S=mt(1),G=mt(6),bt=mt(12),et=mt(13);const V=16,R=100,f=4096,a=15,N=10,x=1e3,p=16;function c(O,l){if(O._removeMirroring)throw new Error("Context is already forwarding operations.");O.__originalSave=O.save,O.__originalRestore=O.restore,O.__originalRotate=O.rotate,O.__originalScale=O.scale,O.__originalTranslate=O.translate,O.__originalTransform=O.transform,O.__originalSetTransform=O.setTransform,O.__originalResetTransform=O.resetTransform,O.__originalClip=O.clip,O.__originalMoveTo=O.moveTo,O.__originalLineTo=O.lineTo,O.__originalBezierCurveTo=O.bezierCurveTo,O.__originalRect=O.rect,O.__originalClosePath=O.closePath,O.__originalBeginPath=O.beginPath,O._removeMirroring=()=>{O.save=O.__originalSave,O.restore=O.__originalRestore,O.rotate=O.__originalRotate,O.scale=O.__originalScale,O.translate=O.__originalTranslate,O.transform=O.__originalTransform,O.setTransform=O.__originalSetTransform,O.resetTransform=O.__originalResetTransform,O.clip=O.__originalClip,O.moveTo=O.__originalMoveTo,O.lineTo=O.__originalLineTo,O.bezierCurveTo=O.__originalBezierCurveTo,O.rect=O.__originalRect,O.closePath=O.__originalClosePath,O.beginPath=O.__originalBeginPath,delete O._removeMirroring},O.save=function(){l.save(),this.__originalSave()},O.restore=function(){l.restore(),this.__originalRestore()},O.translate=function(A,Y){l.translate(A,Y),this.__originalTranslate(A,Y)},O.scale=function(A,Y){l.scale(A,Y),this.__originalScale(A,Y)},O.transform=function(A,Y,K,k,J,at){l.transform(A,Y,K,k,J,at),this.__originalTransform(A,Y,K,k,J,at)},O.setTransform=function(A,Y,K,k,J,at){l.setTransform(A,Y,K,k,J,at),this.__originalSetTransform(A,Y,K,k,J,at)},O.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},O.rotate=function(A){l.rotate(A),this.__originalRotate(A)},O.clip=function(A){l.clip(A),this.__originalClip(A)},O.moveTo=function(h,A){l.moveTo(h,A),this.__originalMoveTo(h,A)},O.lineTo=function(h,A){l.lineTo(h,A),this.__originalLineTo(h,A)},O.bezierCurveTo=function(h,A,Y,K,k,J){l.bezierCurveTo(h,A,Y,K,k,J),this.__originalBezierCurveTo(h,A,Y,K,k,J)},O.rect=function(h,A,Y,K){l.rect(h,A,Y,K),this.__originalRect(h,A,Y,K)},O.closePath=function(){l.closePath(),this.__originalClosePath()},O.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class v{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,h,A){let Y;return this.cache[l]!==void 0?(Y=this.cache[l],this.canvasFactory.reset(Y,h,A)):(Y=this.canvasFactory.create(h,A),this.cache[l]=Y),Y}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const h=this.cache[l];this.canvasFactory.destroy(h),delete this.cache[l]}}}function b(O,l,h,A,Y,K,k,J,at,ft){const[pt,vt,Et,Pt,ct,lt]=(0,G.getCurrentTransform)(O);if(vt===0&&Et===0){const nt=k*pt+ct,P=Math.round(nt),s=J*Pt+lt,w=Math.round(s),U=(k+at)*pt+ct,F=Math.abs(Math.round(U)-P)||1,it=(J+ft)*Pt+lt,ot=Math.abs(Math.round(it)-w)||1;return O.setTransform(Math.sign(pt),0,0,Math.sign(Pt),P,w),O.drawImage(l,h,A,Y,K,0,0,F,ot),O.setTransform(pt,vt,Et,Pt,ct,lt),[F,ot]}if(pt===0&&Pt===0){const nt=J*Et+ct,P=Math.round(nt),s=k*vt+lt,w=Math.round(s),U=(J+ft)*Et+ct,F=Math.abs(Math.round(U)-P)||1,it=(k+at)*vt+lt,ot=Math.abs(Math.round(it)-w)||1;return O.setTransform(0,Math.sign(vt),Math.sign(Et),0,P,w),O.drawImage(l,h,A,Y,K,0,0,ot,F),O.setTransform(pt,vt,Et,Pt,ct,lt),[ot,F]}O.drawImage(l,h,A,Y,K,k,J,at,ft);const I=Math.hypot(pt,vt),q=Math.hypot(Et,Pt);return[I*at,q*ft]}function m(O){const{width:l,height:h}=O;if(l>x||h>x)return null;const A=1e3,Y=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),K=l+1;let k=new Uint8Array(K*(h+1)),J,at,ft;const pt=l+7&-8;let vt=new Uint8Array(pt*h),Et=0;for(const q of O.data){let nt=128;for(;nt>0;)vt[Et++]=q&nt?0:255,nt>>=1}let Pt=0;for(Et=0,vt[Et]!==0&&(k[0]=1,++Pt),at=1;at<l;at++)vt[Et]!==vt[Et+1]&&(k[at]=vt[Et]?2:1,++Pt),Et++;for(vt[Et]!==0&&(k[at]=2,++Pt),J=1;J<h;J++){Et=J*pt,ft=J*K,vt[Et-pt]!==vt[Et]&&(k[ft]=vt[Et]?1:8,++Pt);let q=(vt[Et]?4:0)+(vt[Et-pt]?8:0);for(at=1;at<l;at++)q=(q>>2)+(vt[Et+1]?4:0)+(vt[Et-pt+1]?8:0),Y[q]&&(k[ft+at]=Y[q],++Pt),Et++;if(vt[Et-pt]!==vt[Et]&&(k[ft+at]=vt[Et]?2:4,++Pt),Pt>A)return null}for(Et=pt*(h-1),ft=J*K,vt[Et]!==0&&(k[ft]=8,++Pt),at=1;at<l;at++)vt[Et]!==vt[Et+1]&&(k[ft+at]=vt[Et]?4:8,++Pt),Et++;if(vt[Et]!==0&&(k[ft+at]=4,++Pt),Pt>A)return null;const ct=new Int32Array([0,K,-1,0,-K,0,0,0,1]),lt=new Path2D;for(J=0;Pt&&J<=h;J++){let q=J*K;const nt=q+l;for(;q<nt&&!k[q];)q++;if(q===nt)continue;lt.moveTo(q%K,J);const P=q;let s=k[q];do{const w=ct[s];do q+=w;while(!k[q]);const U=k[q];U!==5&&U!==10?(s=U,k[q]=0):(s=U&51*s>>4,k[q]&=s>>2|s<<2),lt.lineTo(q%K,q/K|0),k[q]||--Pt}while(P!==q);--J}return vt=null,k=null,function(q){q.save(),q.scale(1/l,-1/h),q.translate(0,-h),q.fill(lt),q.beginPath(),q.restore()}}class u{constructor(l,h){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=S.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=S.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=S.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,h])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,h){this.x=l,this.y=h}updatePathMinMax(l,h,A){[h,A]=S.Util.applyTransform([h,A],l),this.minX=Math.min(this.minX,h),this.minY=Math.min(this.minY,A),this.maxX=Math.max(this.maxX,h),this.maxY=Math.max(this.maxY,A)}updateRectMinMax(l,h){const A=S.Util.applyTransform(h,l),Y=S.Util.applyTransform(h.slice(2),l);this.minX=Math.min(this.minX,A[0],Y[0]),this.minY=Math.min(this.minY,A[1],Y[1]),this.maxX=Math.max(this.maxX,A[0],Y[0]),this.maxY=Math.max(this.maxY,A[1],Y[1])}updateScalingPathMinMax(l,h){S.Util.scaleMinMax(l,h),this.minX=Math.min(this.minX,h[0]),this.maxX=Math.max(this.maxX,h[1]),this.minY=Math.min(this.minY,h[2]),this.maxY=Math.max(this.maxY,h[3])}updateCurvePathMinMax(l,h,A,Y,K,k,J,at,ft,pt){const vt=S.Util.bezierBoundingBox(h,A,Y,K,k,J,at,ft);if(pt){pt[0]=Math.min(pt[0],vt[0],vt[2]),pt[1]=Math.max(pt[1],vt[0],vt[2]),pt[2]=Math.min(pt[2],vt[1],vt[3]),pt[3]=Math.max(pt[3],vt[1],vt[3]);return}this.updateRectMinMax(l,vt)}getPathBoundingBox(l=bt.PathType.FILL,h=null){const A=[this.minX,this.minY,this.maxX,this.maxY];if(l===bt.PathType.STROKE){h||(0,S.unreachable)("Stroke bounding box must include transform.");const Y=S.Util.singularValueDecompose2dScale(h),K=Y[0]*this.lineWidth/2,k=Y[1]*this.lineWidth/2;A[0]-=K,A[1]-=k,A[2]+=K,A[3]+=k}return A}updateClipFromPath(){const l=S.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=bt.PathType.FILL,h=null){return S.Util.intersect(this.clipBox,this.getPathBoundingBox(l,h))}}function _(O,l){if(typeof ImageData<"u"&&l instanceof ImageData){O.putImageData(l,0,0);return}const h=l.height,A=l.width,Y=h%p,K=(h-Y)/p,k=Y===0?K:K+1,J=O.createImageData(A,p);let at=0,ft;const pt=l.data,vt=J.data;let Et,Pt,ct,lt;if(l.kind===S.ImageKind.GRAYSCALE_1BPP){const I=pt.byteLength,q=new Uint32Array(vt.buffer,0,vt.byteLength>>2),nt=q.length,P=A+7>>3,s=4294967295,w=S.FeatureTest.isLittleEndian?4278190080:255;for(Et=0;Et<k;Et++){for(ct=Et<K?p:Y,ft=0,Pt=0;Pt<ct;Pt++){const U=I-at;let F=0;const it=U>P?A:U*8-7,ot=it&-8;let At=0,dt=0;for(;F<ot;F+=8)dt=pt[at++],q[ft++]=dt&128?s:w,q[ft++]=dt&64?s:w,q[ft++]=dt&32?s:w,q[ft++]=dt&16?s:w,q[ft++]=dt&8?s:w,q[ft++]=dt&4?s:w,q[ft++]=dt&2?s:w,q[ft++]=dt&1?s:w;for(;F<it;F++)At===0&&(dt=pt[at++],At=128),q[ft++]=dt&At?s:w,At>>=1}for(;ft<nt;)q[ft++]=0;O.putImageData(J,0,Et*p)}}else if(l.kind===S.ImageKind.RGBA_32BPP){for(Pt=0,lt=A*p*4,Et=0;Et<K;Et++)vt.set(pt.subarray(at,at+lt)),at+=lt,O.putImageData(J,0,Pt),Pt+=p;Et<k&&(lt=A*Y*4,vt.set(pt.subarray(at,at+lt)),O.putImageData(J,0,Pt))}else if(l.kind===S.ImageKind.RGB_24BPP)for(ct=p,lt=A*ct,Et=0;Et<k;Et++){for(Et>=K&&(ct=Y,lt=A*ct),ft=0,Pt=lt;Pt--;)vt[ft++]=pt[at++],vt[ft++]=pt[at++],vt[ft++]=pt[at++],vt[ft++]=255;O.putImageData(J,0,Et*p)}else throw new Error(`bad image kind: ${l.kind}`)}function g(O,l){if(l.bitmap){O.drawImage(l.bitmap,0,0);return}const h=l.height,A=l.width,Y=h%p,K=(h-Y)/p,k=Y===0?K:K+1,J=O.createImageData(A,p);let at=0;const ft=l.data,pt=J.data;for(let vt=0;vt<k;vt++){const Et=vt<K?p:Y;({srcPos:at}=(0,et.convertBlackAndWhiteToRGBA)({src:ft,srcPos:at,dest:pt,width:A,height:Et,nonBlackColor:0})),O.putImageData(J,0,vt*p)}}function i(O,l){const h=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const A of h)O[A]!==void 0&&(l[A]=O[A]);O.setLineDash!==void 0&&(l.setLineDash(O.getLineDash()),l.lineDashOffset=O.lineDashOffset)}function e(O){if(O.strokeStyle=O.fillStyle="#000000",O.fillRule="nonzero",O.globalAlpha=1,O.lineWidth=1,O.lineCap="butt",O.lineJoin="miter",O.miterLimit=10,O.globalCompositeOperation="source-over",O.font="10px sans-serif",O.setLineDash!==void 0&&(O.setLineDash([]),O.lineDashOffset=0),!S.isNodeJS){const{filter:l}=O;l!=="none"&&l!==""&&(O.filter="none")}}function n(O,l,h,A){const Y=O.length;for(let K=3;K<Y;K+=4){const k=O[K];if(k===0)O[K-3]=l,O[K-2]=h,O[K-1]=A;else if(k<255){const J=255-k;O[K-3]=O[K-3]*k+l*J>>8,O[K-2]=O[K-2]*k+h*J>>8,O[K-1]=O[K-1]*k+A*J>>8}}}function r(O,l,h){const A=O.length,Y=1/255;for(let K=3;K<A;K+=4){const k=h?h[O[K]]:O[K];l[K]=l[K]*k*Y|0}}function d(O,l,h){const A=O.length;for(let Y=3;Y<A;Y+=4){const K=O[Y-3]*77+O[Y-2]*152+O[Y-1]*28;l[Y]=h?l[Y]*h[K>>8]>>8:l[Y]*K>>16}}function T(O,l,h,A,Y,K,k,J,at,ft,pt){const vt=!!K,Et=vt?K[0]:0,Pt=vt?K[1]:0,ct=vt?K[2]:0,lt=Y==="Luminosity"?d:r,q=Math.min(A,Math.ceil(1048576/h));for(let nt=0;nt<A;nt+=q){const P=Math.min(q,A-nt),s=O.getImageData(J-ft,nt+(at-pt),h,P),w=l.getImageData(J,nt+at,h,P);vt&&n(s.data,Et,Pt,ct),lt(s.data,w.data,k),l.putImageData(w,J,nt+at)}}function o(O,l,h,A){const Y=A[0],K=A[1],k=A[2]-Y,J=A[3]-K;k===0||J===0||(T(l.context,h,k,J,l.subtype,l.backdrop,l.transferMap,Y,K,l.offsetX,l.offsetY),O.save(),O.globalAlpha=1,O.globalCompositeOperation="source-over",O.setTransform(1,0,0,1,0,0),O.drawImage(h.canvas,0,0),O.restore())}function E(O,l){const h=S.Util.singularValueDecompose2dScale(O);h[0]=Math.fround(h[0]),h[1]=Math.fround(h[1]);const A=Math.fround((globalThis.devicePixelRatio||1)*G.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:h[0]<=A||h[1]<=A}const W=["butt","round","square"],D=["miter","round","bevel"],B={},z={},rt=class rt{constructor(l,h,A,Y,K,{optionalContentConfig:k,markedContentStack:J=null},at,ft){tt(this,Q);this.ctx=l,this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=h,this.objs=A,this.canvasFactory=Y,this.filterFactory=K,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=J||[],this.optionalContentConfig=k,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=at,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ft,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,h=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):h}beginDrawing({transform:l,viewport:h,transparency:A=!1,background:Y=null}){const K=this.ctx.canvas.width,k=this.ctx.canvas.height,J=this.ctx.fillStyle;if(this.ctx.fillStyle=Y||"#ffffff",this.ctx.fillRect(0,0,K,k),this.ctx.fillStyle=J,A){const at=this.cachedCanvases.getCanvas("transparent",K,k);this.compositeCtx=this.ctx,this.transparentCanvas=at.canvas,this.ctx=at.context,this.ctx.save(),this.ctx.transform(...(0,G.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),e(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...h.transform),this.viewportScale=h.scale,this.baseTransform=(0,G.getCurrentTransform)(this.ctx)}executeOperatorList(l,h,A,Y){const K=l.argsArray,k=l.fnArray;let J=h||0;const at=K.length;if(at===J)return J;const ft=at-J>N&&typeof A=="function",pt=ft?Date.now()+a:0;let vt=0;const Et=this.commonObjs,Pt=this.objs;let ct;for(;;){if(Y!==void 0&&J===Y.nextBreakPoint)return Y.breakIt(J,A),J;if(ct=k[J],ct!==S.OPS.dependency)this[ct].apply(this,K[J]);else for(const lt of K[J]){const I=lt.startsWith("g_")?Et:Pt;if(!I.has(lt))return I.get(lt,A),J}if(J++,J===at)return J;if(ft&&++vt>N){if(Date.now()>pt)return A(),J;vt=0}}}endDrawing(){j(this,Q,ri).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const h of l.values())typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement&&(h.width=h.height=0);l.clear()}this._cachedBitmapsMap.clear(),j(this,Q,ai).call(this)}_scaleImage(l,h){const A=l.width,Y=l.height;let K=Math.max(Math.hypot(h[0],h[1]),1),k=Math.max(Math.hypot(h[2],h[3]),1),J=A,at=Y,ft="prescale1",pt,vt;for(;K>2&&J>1||k>2&&at>1;){let Et=J,Pt=at;K>2&&J>1&&(Et=J>=16384?Math.floor(J/2)-1||1:Math.ceil(J/2),K/=J/Et),k>2&&at>1&&(Pt=at>=16384?Math.floor(at/2)-1||1:Math.ceil(at)/2,k/=at/Pt),pt=this.cachedCanvases.getCanvas(ft,Et,Pt),vt=pt.context,vt.clearRect(0,0,Et,Pt),vt.drawImage(l,0,0,J,at,0,0,Et,Pt),l=pt.canvas,J=Et,at=Pt,ft=ft==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:J,paintHeight:at}}_createMaskCanvas(l){const h=this.ctx,{width:A,height:Y}=l,K=this.current.fillColor,k=this.current.patternFill,J=(0,G.getCurrentTransform)(h);let at,ft,pt,vt;if((l.bitmap||l.data)&&l.count>1){const F=l.bitmap||l.data.buffer;ft=JSON.stringify(k?J:[J.slice(0,4),K]),at=this._cachedBitmapsMap.get(F),at||(at=new Map,this._cachedBitmapsMap.set(F,at));const it=at.get(ft);if(it&&!k){const ot=Math.round(Math.min(J[0],J[2])+J[4]),At=Math.round(Math.min(J[1],J[3])+J[5]);return{canvas:it,offsetX:ot,offsetY:At}}pt=it}pt||(vt=this.cachedCanvases.getCanvas("maskCanvas",A,Y),g(vt.context,l));let Et=S.Util.transform(J,[1/A,0,0,-1/Y,0,0]);Et=S.Util.transform(Et,[1,0,0,1,0,-Y]);const Pt=S.Util.applyTransform([0,0],Et),ct=S.Util.applyTransform([A,Y],Et),lt=S.Util.normalizeRect([Pt[0],Pt[1],ct[0],ct[1]]),I=Math.round(lt[2]-lt[0])||1,q=Math.round(lt[3]-lt[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",I,q),P=nt.context,s=Math.min(Pt[0],ct[0]),w=Math.min(Pt[1],ct[1]);P.translate(-s,-w),P.transform(...Et),pt||(pt=this._scaleImage(vt.canvas,(0,G.getCurrentTransformInverse)(P)),pt=pt.img,at&&k&&at.set(ft,pt)),P.imageSmoothingEnabled=E((0,G.getCurrentTransform)(P),l.interpolate),b(P,pt,0,0,pt.width,pt.height,0,0,A,Y),P.globalCompositeOperation="source-in";const U=S.Util.transform((0,G.getCurrentTransformInverse)(P),[1,0,0,1,-s,-w]);return P.fillStyle=k?K.getPattern(h,this,U,bt.PathType.FILL):K,P.fillRect(0,0,A,Y),at&&!k&&(this.cachedCanvases.delete("fillCanvas"),at.set(ft,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(s),offsetY:Math.round(w)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=W[l]}setLineJoin(l){this.ctx.lineJoin=D[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,h){const A=this.ctx;A.setLineDash!==void 0&&(A.setLineDash(l),A.lineDashOffset=h)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[h,A]of l)switch(h){case"LW":this.setLineWidth(A);break;case"LC":this.setLineCap(A);break;case"LJ":this.setLineJoin(A);break;case"ML":this.setMiterLimit(A);break;case"D":this.setDash(A[0],A[1]);break;case"RI":this.setRenderingIntent(A);break;case"FL":this.setFlatness(A);break;case"Font":this.setFont(A[0],A[1]);break;case"CA":this.current.strokeAlpha=A;break;case"ca":this.current.fillAlpha=A,this.ctx.globalAlpha=A;break;case"BM":this.ctx.globalCompositeOperation=A;break;case"SMask":this.current.activeSMask=A?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(A);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,h=this.ctx.canvas.height,A="smaskGroupAt"+this.groupLevel,Y=this.cachedCanvases.getCanvas(A,l,h);this.suspendedCtx=this.ctx,this.ctx=Y.context;const K=this.ctx;K.setTransform(...(0,G.getCurrentTransform)(this.suspendedCtx)),i(this.suspendedCtx,K),c(K,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),i(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const h=this.current.activeSMask,A=this.suspendedCtx;o(A,h,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(i(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),i(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(l,h,A,Y,K,k){this.ctx.transform(l,h,A,Y,K,k),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(l,h,A){const Y=this.ctx,K=this.current;let k=K.x,J=K.y,at,ft;const pt=(0,G.getCurrentTransform)(Y),vt=pt[0]===0&&pt[3]===0||pt[1]===0&&pt[2]===0,Et=vt?A.slice(0):null;for(let Pt=0,ct=0,lt=l.length;Pt<lt;Pt++)switch(l[Pt]|0){case S.OPS.rectangle:k=h[ct++],J=h[ct++];const I=h[ct++],q=h[ct++],nt=k+I,P=J+q;Y.moveTo(k,J),I===0||q===0?Y.lineTo(nt,P):(Y.lineTo(nt,J),Y.lineTo(nt,P),Y.lineTo(k,P)),vt||K.updateRectMinMax(pt,[k,J,nt,P]),Y.closePath();break;case S.OPS.moveTo:k=h[ct++],J=h[ct++],Y.moveTo(k,J),vt||K.updatePathMinMax(pt,k,J);break;case S.OPS.lineTo:k=h[ct++],J=h[ct++],Y.lineTo(k,J),vt||K.updatePathMinMax(pt,k,J);break;case S.OPS.curveTo:at=k,ft=J,k=h[ct+4],J=h[ct+5],Y.bezierCurveTo(h[ct],h[ct+1],h[ct+2],h[ct+3],k,J),K.updateCurvePathMinMax(pt,at,ft,h[ct],h[ct+1],h[ct+2],h[ct+3],k,J,Et),ct+=6;break;case S.OPS.curveTo2:at=k,ft=J,Y.bezierCurveTo(k,J,h[ct],h[ct+1],h[ct+2],h[ct+3]),K.updateCurvePathMinMax(pt,at,ft,k,J,h[ct],h[ct+1],h[ct+2],h[ct+3],Et),k=h[ct+2],J=h[ct+3],ct+=4;break;case S.OPS.curveTo3:at=k,ft=J,k=h[ct+2],J=h[ct+3],Y.bezierCurveTo(h[ct],h[ct+1],k,J,k,J),K.updateCurvePathMinMax(pt,at,ft,h[ct],h[ct+1],k,J,k,J,Et),ct+=4;break;case S.OPS.closePath:Y.closePath();break}vt&&K.updateScalingPathMinMax(pt,Et),K.setCurrentPoint(k,J)}closePath(){this.ctx.closePath()}stroke(l=!0){const h=this.ctx,A=this.current.strokeColor;h.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof A=="object"&&(A!=null&&A.getPattern)?(h.save(),h.strokeStyle=A.getPattern(h,this,(0,G.getCurrentTransformInverse)(h),bt.PathType.STROKE),this.rescaleAndStroke(!1),h.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),h.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const h=this.ctx,A=this.current.fillColor,Y=this.current.patternFill;let K=!1;Y&&(h.save(),h.fillStyle=A.getPattern(h,this,(0,G.getCurrentTransformInverse)(h),bt.PathType.FILL),K=!0);const k=this.current.getClippedPathBoundingBox();this.contentVisible&&k!==null&&(this.pendingEOFill?(h.fill("evenodd"),this.pendingEOFill=!1):h.fill()),K&&h.restore(),l&&this.consumePath(k)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=B}eoClip(){this.pendingClip=z}beginText(){this.current.textMatrix=S.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,h=this.ctx;if(l===void 0){h.beginPath();return}h.save(),h.beginPath();for(const A of l)h.setTransform(...A.transform),h.translate(A.x,A.y),A.addToPath(h,A.fontSize);h.restore(),h.clip(),h.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,h){var pt;const A=this.commonObjs.get(l),Y=this.current;if(!A)throw new Error(`Can't find font for ${l}`);if(Y.fontMatrix=A.fontMatrix||S.FONT_IDENTITY_MATRIX,(Y.fontMatrix[0]===0||Y.fontMatrix[3]===0)&&(0,S.warn)("Invalid font matrix for font "+l),h<0?(h=-h,Y.fontDirection=-1):Y.fontDirection=1,this.current.font=A,this.current.fontSize=h,A.isType3Font)return;const K=A.loadedName||"sans-serif",k=((pt=A.systemFontInfo)==null?void 0:pt.css)||`"${K}", ${A.fallbackName}`;let J="normal";A.black?J="900":A.bold&&(J="bold");const at=A.italic?"italic":"normal";let ft=h;h<V?ft=V:h>R&&(ft=R),this.current.fontSizeScale=h/ft,this.ctx.font=`${at} ${J} ${ft}px ${k}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,h){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=h}setLeadingMoveText(l,h){this.setLeading(-h),this.moveText(l,h)}setTextMatrix(l,h,A,Y,K,k){this.current.textMatrix=[l,h,A,Y,K,k],this.current.textMatrixScale=Math.hypot(l,h),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,h,A,Y){const K=this.ctx,k=this.current,J=k.font,at=k.textRenderingMode,ft=k.fontSize/k.fontSizeScale,pt=at&S.TextRenderingMode.FILL_STROKE_MASK,vt=!!(at&S.TextRenderingMode.ADD_TO_PATH_FLAG),Et=k.patternFill&&!J.missingFile;let Pt;(J.disableFontFace||vt||Et)&&(Pt=J.getPathGenerator(this.commonObjs,l)),J.disableFontFace||Et?(K.save(),K.translate(h,A),K.beginPath(),Pt(K,ft),Y&&K.setTransform(...Y),(pt===S.TextRenderingMode.FILL||pt===S.TextRenderingMode.FILL_STROKE)&&K.fill(),(pt===S.TextRenderingMode.STROKE||pt===S.TextRenderingMode.FILL_STROKE)&&K.stroke(),K.restore()):((pt===S.TextRenderingMode.FILL||pt===S.TextRenderingMode.FILL_STROKE)&&K.fillText(l,h,A),(pt===S.TextRenderingMode.STROKE||pt===S.TextRenderingMode.FILL_STROKE)&&K.strokeText(l,h,A)),vt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,G.getCurrentTransform)(K),x:h,y:A,fontSize:ft,addToPath:Pt})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const h=l.getImageData(0,0,10,10).data;let A=!1;for(let Y=3;Y<h.length;Y+=4)if(h[Y]>0&&h[Y]<255){A=!0;break}return(0,S.shadow)(this,"isFontSubpixelAAEnabled",A)}showText(l){const h=this.current,A=h.font;if(A.isType3Font)return this.showType3Text(l);const Y=h.fontSize;if(Y===0)return;const K=this.ctx,k=h.fontSizeScale,J=h.charSpacing,at=h.wordSpacing,ft=h.fontDirection,pt=h.textHScale*ft,vt=l.length,Et=A.vertical,Pt=Et?1:-1,ct=A.defaultVMetrics,lt=Y*h.fontMatrix[0],I=h.textRenderingMode===S.TextRenderingMode.FILL&&!A.disableFontFace&&!h.patternFill;K.save(),K.transform(...h.textMatrix),K.translate(h.x,h.y+h.textRise),ft>0?K.scale(pt,-1):K.scale(pt,1);let q;if(h.patternFill){K.save();const U=h.fillColor.getPattern(K,this,(0,G.getCurrentTransformInverse)(K),bt.PathType.FILL);q=(0,G.getCurrentTransform)(K),K.restore(),K.fillStyle=U}let nt=h.lineWidth;const P=h.textMatrixScale;if(P===0||nt===0){const U=h.textRenderingMode&S.TextRenderingMode.FILL_STROKE_MASK;(U===S.TextRenderingMode.STROKE||U===S.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=P;if(k!==1&&(K.scale(k,k),nt/=k),K.lineWidth=nt,A.isInvalidPDFjsFont){const U=[];let F=0;for(const it of l)U.push(it.unicode),F+=it.width;K.fillText(U.join(""),0,0),h.x+=F*lt*pt,K.restore(),this.compose();return}let s=0,w;for(w=0;w<vt;++w){const U=l[w];if(typeof U=="number"){s+=Pt*U*Y/1e3;continue}let F=!1;const it=(U.isSpace?at:0)+J,ot=U.fontChar,At=U.accent;let dt,Mt,xt=U.width;if(Et){const jt=U.vmetric||ct,$t=-(U.vmetric?jt[1]:xt*.5)*lt,St=jt[2]*lt;xt=jt?-jt[0]:xt,dt=$t/k,Mt=(s+St)/k}else dt=s/k,Mt=0;if(A.remeasure&&xt>0){const jt=K.measureText(ot).width*1e3/Y*k;if(xt<jt&&this.isFontSubpixelAAEnabled){const $t=xt/jt;F=!0,K.save(),K.scale($t,1),dt/=$t}else xt!==jt&&(dt+=(xt-jt)/2e3*Y/k)}if(this.contentVisible&&(U.isInFont||A.missingFile)){if(I&&!At)K.fillText(ot,dt,Mt);else if(this.paintChar(ot,dt,Mt,q),At){const jt=dt+Y*At.offset.x/k,$t=Mt-Y*At.offset.y/k;this.paintChar(At.fontChar,jt,$t,q)}}const kt=Et?xt*lt-it*ft:xt*lt+it*ft;s+=kt,F&&K.restore()}Et?h.y-=s:h.x+=s*pt,K.restore(),this.compose()}showType3Text(l){const h=this.ctx,A=this.current,Y=A.font,K=A.fontSize,k=A.fontDirection,J=Y.vertical?1:-1,at=A.charSpacing,ft=A.wordSpacing,pt=A.textHScale*k,vt=A.fontMatrix||S.FONT_IDENTITY_MATRIX,Et=l.length,Pt=A.textRenderingMode===S.TextRenderingMode.INVISIBLE;let ct,lt,I,q;if(!(Pt||K===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,h.save(),h.transform(...A.textMatrix),h.translate(A.x,A.y),h.scale(pt,k),ct=0;ct<Et;++ct){if(lt=l[ct],typeof lt=="number"){q=J*lt*K/1e3,this.ctx.translate(q,0),A.x+=q*pt;continue}const nt=(lt.isSpace?ft:0)+at,P=Y.charProcOperatorList[lt.operatorListId];if(!P){(0,S.warn)(`Type3 character "${lt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=lt,this.save(),h.scale(K,K),h.transform(...vt),this.executeOperatorList(P),this.restore()),I=S.Util.applyTransform([lt.width,0],vt)[0]*K+nt,h.translate(I,0),A.x+=I*pt}h.restore(),this.processingType3=null}}setCharWidth(l,h){}setCharWidthAndBounds(l,h,A,Y,K,k){this.ctx.rect(A,Y,K-A,k-Y),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let h;if(l[0]==="TilingPattern"){const A=l[1],Y=this.baseTransform||(0,G.getCurrentTransform)(this.ctx),K={createCanvasGraphics:k=>new rt(k,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};h=new bt.TilingPattern(l,A,this.ctx,K,Y)}else h=this._getPattern(l[1],l[2]);return h}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,h,A){const Y=S.Util.makeHexColor(l,h,A);this.ctx.strokeStyle=Y,this.current.strokeColor=Y}setFillRGBColor(l,h,A){const Y=S.Util.makeHexColor(l,h,A);this.ctx.fillStyle=Y,this.current.fillColor=Y,this.current.patternFill=!1}_getPattern(l,h=null){let A;return this.cachedPatterns.has(l)?A=this.cachedPatterns.get(l):(A=(0,bt.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,A)),h&&(A.matrix=h),A}shadingFill(l){if(!this.contentVisible)return;const h=this.ctx;this.save();const A=this._getPattern(l);h.fillStyle=A.getPattern(h,this,(0,G.getCurrentTransformInverse)(h),bt.PathType.SHADING);const Y=(0,G.getCurrentTransformInverse)(h);if(Y){const{width:K,height:k}=h.canvas,[J,at,ft,pt]=S.Util.getAxialAlignedBoundingBox([0,0,K,k],Y);this.ctx.fillRect(J,at,ft-J,pt-at)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,S.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,S.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,h){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,G.getCurrentTransform)(this.ctx),h)){const A=h[2]-h[0],Y=h[3]-h[1];this.ctx.rect(h[0],h[1],A,Y),this.current.updateRectMinMax((0,G.getCurrentTransform)(this.ctx),h),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const h=this.ctx;l.isolated||(0,S.info)("TODO: Support non-isolated groups."),l.knockout&&(0,S.warn)("Knockout groups not supported.");const A=(0,G.getCurrentTransform)(h);if(l.matrix&&h.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let Y=S.Util.getAxialAlignedBoundingBox(l.bbox,(0,G.getCurrentTransform)(h));const K=[0,0,h.canvas.width,h.canvas.height];Y=S.Util.intersect(Y,K)||[0,0,0,0];const k=Math.floor(Y[0]),J=Math.floor(Y[1]);let at=Math.max(Math.ceil(Y[2])-k,1),ft=Math.max(Math.ceil(Y[3])-J,1),pt=1,vt=1;at>f&&(pt=at/f,at=f),ft>f&&(vt=ft/f,ft=f),this.current.startNewPathAndClipBox([0,0,at,ft]);let Et="groupAt"+this.groupLevel;l.smask&&(Et+="_smask_"+this.smaskCounter++%2);const Pt=this.cachedCanvases.getCanvas(Et,at,ft),ct=Pt.context;ct.scale(1/pt,1/vt),ct.translate(-k,-J),ct.transform(...A),l.smask?this.smaskStack.push({canvas:Pt.canvas,context:ct,offsetX:k,offsetY:J,scaleX:pt,scaleY:vt,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(h.setTransform(1,0,0,1,0,0),h.translate(k,J),h.scale(pt,vt),h.save()),i(h,ct),this.ctx=ct,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(h),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const h=this.ctx,A=this.groupStack.pop();if(this.ctx=A,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Y=(0,G.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Y);const K=S.Util.getAxialAlignedBoundingBox([0,0,h.canvas.width,h.canvas.height],Y);this.ctx.drawImage(h.canvas,0,0),this.ctx.restore(),this.compose(K)}}beginAnnotation(l,h,A,Y,K){if(j(this,Q,ri).call(this),e(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(h)&&h.length===4){const k=h[2]-h[0],J=h[3]-h[1];if(K&&this.annotationCanvasMap){A=A.slice(),A[4]-=h[0],A[5]-=h[1],h=h.slice(),h[0]=h[1]=0,h[2]=k,h[3]=J;const[at,ft]=S.Util.singularValueDecompose2dScale((0,G.getCurrentTransform)(this.ctx)),{viewportScale:pt}=this,vt=Math.ceil(k*this.outputScaleX*pt),Et=Math.ceil(J*this.outputScaleY*pt);this.annotationCanvas=this.canvasFactory.create(vt,Et);const{canvas:Pt,context:ct}=this.annotationCanvas;this.annotationCanvasMap.set(l,Pt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ct,this.ctx.save(),this.ctx.setTransform(at,0,0,-ft,0,J*ft),e(this.ctx)}else e(this.ctx),this.ctx.rect(h[0],h[1],k,J),this.ctx.clip(),this.endPath()}this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...A),this.transform(...Y)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),j(this,Q,ai).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const h=l.count;l=this.getObject(l.data,l),l.count=h;const A=this.ctx,Y=this.processingType3;if(Y&&(Y.compiled===void 0&&(Y.compiled=m(l)),Y.compiled)){Y.compiled(A);return}const K=this._createMaskCanvas(l),k=K.canvas;A.save(),A.setTransform(1,0,0,1,0,0),A.drawImage(k,K.offsetX,K.offsetY),A.restore(),this.compose()}paintImageMaskXObjectRepeat(l,h,A=0,Y=0,K,k){if(!this.contentVisible)return;l=this.getObject(l.data,l);const J=this.ctx;J.save();const at=(0,G.getCurrentTransform)(J);J.transform(h,A,Y,K,0,0);const ft=this._createMaskCanvas(l);J.setTransform(1,0,0,1,ft.offsetX-at[4],ft.offsetY-at[5]);for(let pt=0,vt=k.length;pt<vt;pt+=2){const Et=S.Util.transform(at,[h,A,Y,K,k[pt],k[pt+1]]),[Pt,ct]=S.Util.applyTransform([0,0],Et);J.drawImage(ft.canvas,Pt,ct)}J.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const h=this.ctx,A=this.current.fillColor,Y=this.current.patternFill;for(const K of l){const{data:k,width:J,height:at,transform:ft}=K,pt=this.cachedCanvases.getCanvas("maskCanvas",J,at),vt=pt.context;vt.save();const Et=this.getObject(k,K);g(vt,Et),vt.globalCompositeOperation="source-in",vt.fillStyle=Y?A.getPattern(vt,this,(0,G.getCurrentTransformInverse)(h),bt.PathType.FILL):A,vt.fillRect(0,0,J,at),vt.restore(),h.save(),h.transform(...ft),h.scale(1,-1),b(h,pt.canvas,0,0,J,at,0,-1,1,1),h.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const h=this.getObject(l);if(!h){(0,S.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(h)}paintImageXObjectRepeat(l,h,A,Y){if(!this.contentVisible)return;const K=this.getObject(l);if(!K){(0,S.warn)("Dependent image isn't ready yet");return}const k=K.width,J=K.height,at=[];for(let ft=0,pt=Y.length;ft<pt;ft+=2)at.push({transform:[h,0,0,A,Y[ft],Y[ft+1]],x:0,y:0,w:k,h:J});this.paintInlineImageXObjectGroup(K,at)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:h,width:A,height:Y}=l,K=this.cachedCanvases.getCanvas("inlineImage",A,Y),k=K.context;return k.filter=this.current.transferMaps,k.drawImage(h,0,0),k.filter="none",K.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const h=l.width,A=l.height,Y=this.ctx;if(this.save(),!S.isNodeJS){const{filter:J}=Y;J!=="none"&&J!==""&&(Y.filter="none")}Y.scale(1/h,-1/A);let K;if(l.bitmap)K=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)K=l;else{const at=this.cachedCanvases.getCanvas("inlineImage",h,A).context;_(at,l),K=this.applyTransferMapsToCanvas(at)}const k=this._scaleImage(K,(0,G.getCurrentTransformInverse)(Y));Y.imageSmoothingEnabled=E((0,G.getCurrentTransform)(Y),l.interpolate),b(Y,k.img,0,0,k.paintWidth,k.paintHeight,0,-A,h,A),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,h){if(!this.contentVisible)return;const A=this.ctx;let Y;if(l.bitmap)Y=l.bitmap;else{const K=l.width,k=l.height,at=this.cachedCanvases.getCanvas("inlineImage",K,k).context;_(at,l),Y=this.applyTransferMapsToCanvas(at)}for(const K of h)A.save(),A.transform(...K.transform),A.scale(1,-1),b(A,Y,K.x,K.y,K.w,K.h,0,-1,1,1),A.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,h){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,h){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(h)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const h=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const A=this.ctx;this.pendingClip&&(h||(this.pendingClip===z?A.clip("evenodd"):A.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),A.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,G.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const h=Math.abs(l[0]*l[3]-l[2]*l[1]),A=Math.hypot(l[0],l[2]),Y=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(A,Y)/h}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:l}=this.current,{a:h,b:A,c:Y,d:K}=this.ctx.getTransform();let k,J;if(A===0&&Y===0){const at=Math.abs(h),ft=Math.abs(K);if(at===ft)if(l===0)k=J=1/at;else{const pt=at*l;k=J=pt<1?1/pt:1}else if(l===0)k=1/at,J=1/ft;else{const pt=at*l,vt=ft*l;k=pt<1?1/pt:1,J=vt<1?1/vt:1}}else{const at=Math.abs(h*K-A*Y),ft=Math.hypot(h,A),pt=Math.hypot(Y,K);if(l===0)k=pt/at,J=ft/at;else{const vt=l*at;k=pt>vt?pt/vt:1,J=ft>vt?ft/vt:1}}this._cachedScaleForStroking[0]=k,this._cachedScaleForStroking[1]=J}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:h}=this,{lineWidth:A}=this.current,[Y,K]=this.getScaleForStroking();if(h.lineWidth=A||1,Y===1&&K===1){h.stroke();return}const k=h.getLineDash();if(l&&h.save(),h.scale(Y,K),k.length>0){const J=Math.max(Y,K);h.setLineDash(k.map(at=>at/J)),h.lineDashOffset/=J}h.stroke(),l&&h.restore()}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}};Q=new WeakSet,ri=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ai=function(){if(this.pageColors){const l=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(l!=="none"){const h=this.ctx.filter;this.ctx.filter=l,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=h}}};let M=rt;L.CanvasGraphics=M;for(const O in S.OPS)M.prototype[O]!==void 0&&(M.prototype[S.OPS[O]]=M.prototype[O])},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.TilingPattern=L.PathType=void 0,L.getShadingPattern=p;var S=mt(1),G=mt(6);const bt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};L.PathType=bt;function et(m,u){if(!u)return;const _=u[2]-u[0],g=u[3]-u[1],i=new Path2D;i.rect(u[0],u[1],_,g),m.clip(i)}class V{constructor(){this.constructor===V&&(0,S.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,S.unreachable)("Abstract method `getPattern` called.")}}class R extends V{constructor(u){super(),this._type=u[1],this._bbox=u[2],this._colorStops=u[3],this._p0=u[4],this._p1=u[5],this._r0=u[6],this._r1=u[7],this.matrix=null}_createGradient(u){let _;this._type==="axial"?_=u.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_=u.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const g of this._colorStops)_.addColorStop(g[0],g[1]);return _}getPattern(u,_,g,i){let e;if(i===bt.STROKE||i===bt.FILL){const n=_.current.getClippedPathBoundingBox(i,(0,G.getCurrentTransform)(u))||[0,0,0,0],r=Math.ceil(n[2]-n[0])||1,d=Math.ceil(n[3]-n[1])||1,T=_.cachedCanvases.getCanvas("pattern",r,d,!0),o=T.context;o.clearRect(0,0,o.canvas.width,o.canvas.height),o.beginPath(),o.rect(0,0,o.canvas.width,o.canvas.height),o.translate(-n[0],-n[1]),g=S.Util.transform(g,[1,0,0,1,n[0],n[1]]),o.transform(..._.baseTransform),this.matrix&&o.transform(...this.matrix),et(o,this._bbox),o.fillStyle=this._createGradient(o),o.fill(),e=u.createPattern(T.canvas,"no-repeat");const E=new DOMMatrix(g);e.setTransform(E)}else et(u,this._bbox),e=this._createGradient(u);return e}}function f(m,u,_,g,i,e,n,r){const d=u.coords,T=u.colors,o=m.data,E=m.width*4;let W;d[_+1]>d[g+1]&&(W=_,_=g,g=W,W=e,e=n,n=W),d[g+1]>d[i+1]&&(W=g,g=i,i=W,W=n,n=r,r=W),d[_+1]>d[g+1]&&(W=_,_=g,g=W,W=e,e=n,n=W);const D=(d[_]+u.offsetX)*u.scaleX,B=(d[_+1]+u.offsetY)*u.scaleY,z=(d[g]+u.offsetX)*u.scaleX,M=(d[g+1]+u.offsetY)*u.scaleY,Q=(d[i]+u.offsetX)*u.scaleX,y=(d[i+1]+u.offsetY)*u.scaleY;if(B>=y)return;const C=T[e],rt=T[e+1],O=T[e+2],l=T[n],h=T[n+1],A=T[n+2],Y=T[r],K=T[r+1],k=T[r+2],J=Math.round(B),at=Math.round(y);let ft,pt,vt,Et,Pt,ct,lt,I;for(let q=J;q<=at;q++){if(q<M){const U=q<B?0:(B-q)/(B-M);ft=D-(D-z)*U,pt=C-(C-l)*U,vt=rt-(rt-h)*U,Et=O-(O-A)*U}else{let U;q>y?U=1:M===y?U=0:U=(M-q)/(M-y),ft=z-(z-Q)*U,pt=l-(l-Y)*U,vt=h-(h-K)*U,Et=A-(A-k)*U}let nt;q<B?nt=0:q>y?nt=1:nt=(B-q)/(B-y),Pt=D-(D-Q)*nt,ct=C-(C-Y)*nt,lt=rt-(rt-K)*nt,I=O-(O-k)*nt;const P=Math.round(Math.min(ft,Pt)),s=Math.round(Math.max(ft,Pt));let w=E*q+P*4;for(let U=P;U<=s;U++)nt=(ft-U)/(ft-Pt),nt<0?nt=0:nt>1&&(nt=1),o[w++]=pt-(pt-ct)*nt|0,o[w++]=vt-(vt-lt)*nt|0,o[w++]=Et-(Et-I)*nt|0,o[w++]=255}}function a(m,u,_){const g=u.coords,i=u.colors;let e,n;switch(u.type){case"lattice":const r=u.verticesPerRow,d=Math.floor(g.length/r)-1,T=r-1;for(e=0;e<d;e++){let o=e*r;for(let E=0;E<T;E++,o++)f(m,_,g[o],g[o+1],g[o+r],i[o],i[o+1],i[o+r]),f(m,_,g[o+r+1],g[o+1],g[o+r],i[o+r+1],i[o+1],i[o+r])}break;case"triangles":for(e=0,n=g.length;e<n;e+=3)f(m,_,g[e],g[e+1],g[e+2],i[e],i[e+1],i[e+2]);break;default:throw new Error("illegal figure")}}class N extends V{constructor(u){super(),this._coords=u[2],this._colors=u[3],this._figures=u[4],this._bounds=u[5],this._bbox=u[7],this._background=u[8],this.matrix=null}_createMeshCanvas(u,_,g){const r=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-r,o=Math.ceil(this._bounds[3])-d,E=Math.min(Math.ceil(Math.abs(T*u[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(o*u[1]*1.1)),3e3),D=T/E,B=o/W,z={coords:this._coords,colors:this._colors,offsetX:-r,offsetY:-d,scaleX:1/D,scaleY:1/B},M=E+2*2,Q=W+2*2,y=g.getCanvas("mesh",M,Q,!1),C=y.context,rt=C.createImageData(E,W);if(_){const l=rt.data;for(let h=0,A=l.length;h<A;h+=4)l[h]=_[0],l[h+1]=_[1],l[h+2]=_[2],l[h+3]=255}for(const l of this._figures)a(rt,l,z);return C.putImageData(rt,2,2),{canvas:y.canvas,offsetX:r-2*D,offsetY:d-2*B,scaleX:D,scaleY:B}}getPattern(u,_,g,i){et(u,this._bbox);let e;if(i===bt.SHADING)e=S.Util.singularValueDecompose2dScale((0,G.getCurrentTransform)(u));else if(e=S.Util.singularValueDecompose2dScale(_.baseTransform),this.matrix){const r=S.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*r[0],e[1]*r[1]]}const n=this._createMeshCanvas(e,i===bt.SHADING?null:this._background,_.cachedCanvases);return i!==bt.SHADING&&(u.setTransform(..._.baseTransform),this.matrix&&u.transform(...this.matrix)),u.translate(n.offsetX,n.offsetY),u.scale(n.scaleX,n.scaleY),u.createPattern(n.canvas,"no-repeat")}}class x extends V{getPattern(){return"hotpink"}}function p(m){switch(m[0]){case"RadialAxial":return new R(m);case"Mesh":return new N(m);case"Dummy":return new x}throw new Error(`Unknown IR type: ${m[0]}`)}const c={COLORED:1,UNCOLORED:2},b=class b{constructor(u,_,g,i,e){this.operatorList=u[2],this.matrix=u[3]||[1,0,0,1,0,0],this.bbox=u[4],this.xstep=u[5],this.ystep=u[6],this.paintType=u[7],this.tilingType=u[8],this.color=_,this.ctx=g,this.canvasGraphicsFactory=i,this.baseTransform=e}createPatternCanvas(u){const _=this.operatorList,g=this.bbox,i=this.xstep,e=this.ystep,n=this.paintType,r=this.tilingType,d=this.color,T=this.canvasGraphicsFactory;(0,S.info)("TilingType: "+r);const o=g[0],E=g[1],W=g[2],D=g[3],B=S.Util.singularValueDecompose2dScale(this.matrix),z=S.Util.singularValueDecompose2dScale(this.baseTransform),M=[B[0]*z[0],B[1]*z[1]],Q=this.getSizeAndScale(i,this.ctx.canvas.width,M[0]),y=this.getSizeAndScale(e,this.ctx.canvas.height,M[1]),C=u.cachedCanvases.getCanvas("pattern",Q.size,y.size,!0),rt=C.context,O=T.createCanvasGraphics(rt);O.groupLevel=u.groupLevel,this.setFillAndStrokeStyleToContext(O,n,d);let l=o,h=E,A=W,Y=D;return o<0&&(l=0,A+=Math.abs(o)),E<0&&(h=0,Y+=Math.abs(E)),rt.translate(-(Q.scale*l),-(y.scale*h)),O.transform(Q.scale,0,0,y.scale,0,0),rt.save(),this.clipBbox(O,l,h,A,Y),O.baseTransform=(0,G.getCurrentTransform)(O.ctx),O.executeOperatorList(_),O.endDrawing(),{canvas:C.canvas,scaleX:Q.scale,scaleY:y.scale,offsetX:l,offsetY:h}}getSizeAndScale(u,_,g){u=Math.abs(u);const i=Math.max(b.MAX_PATTERN_SIZE,_);let e=Math.ceil(u*g);return e>=i?e=i:g=e/u,{scale:g,size:e}}clipBbox(u,_,g,i,e){const n=i-_,r=e-g;u.ctx.rect(_,g,n,r),u.current.updateRectMinMax((0,G.getCurrentTransform)(u.ctx),[_,g,i,e]),u.clip(),u.endPath()}setFillAndStrokeStyleToContext(u,_,g){const i=u.ctx,e=u.current;switch(_){case c.COLORED:const n=this.ctx;i.fillStyle=n.fillStyle,i.strokeStyle=n.strokeStyle,e.fillColor=n.fillStyle,e.strokeColor=n.strokeStyle;break;case c.UNCOLORED:const r=S.Util.makeHexColor(g[0],g[1],g[2]);i.fillStyle=r,i.strokeStyle=r,e.fillColor=r,e.strokeColor=r;break;default:throw new S.FormatError(`Unsupported paint type: ${_}`)}}getPattern(u,_,g,i){let e=g;i!==bt.SHADING&&(e=S.Util.transform(e,_.baseTransform),this.matrix&&(e=S.Util.transform(e,this.matrix)));const n=this.createPatternCanvas(_);let r=new DOMMatrix(e);r=r.translate(n.offsetX,n.offsetY),r=r.scale(1/n.scaleX,1/n.scaleY);const d=u.createPattern(n.canvas,"repeat");return d.setTransform(r),d}};Kt(b,"MAX_PATTERN_SIZE",3e3);let v=b;L.TilingPattern=v},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.convertBlackAndWhiteToRGBA=bt,L.convertToRGBA=G,L.grayToRGBA=V;var S=mt(1);function G(R){switch(R.kind){case S.ImageKind.GRAYSCALE_1BPP:return bt(R);case S.ImageKind.RGB_24BPP:return et(R)}return null}function bt({src:R,srcPos:f=0,dest:a,width:N,height:x,nonBlackColor:p=4294967295,inverseDecode:c=!1}){const v=S.FeatureTest.isLittleEndian?4278190080:255,[b,m]=c?[p,v]:[v,p],u=N>>3,_=N&7,g=R.length;a=new Uint32Array(a.buffer);let i=0;for(let e=0;e<x;e++){for(const r=f+u;f<r;f++){const d=f<g?R[f]:255;a[i++]=d&128?m:b,a[i++]=d&64?m:b,a[i++]=d&32?m:b,a[i++]=d&16?m:b,a[i++]=d&8?m:b,a[i++]=d&4?m:b,a[i++]=d&2?m:b,a[i++]=d&1?m:b}if(_===0)continue;const n=f<g?R[f++]:255;for(let r=0;r<_;r++)a[i++]=n&1<<7-r?m:b}return{srcPos:f,destPos:i}}function et({src:R,srcPos:f=0,dest:a,destPos:N=0,width:x,height:p}){let c=0;const v=R.length>>2,b=new Uint32Array(R.buffer,f,v);if(S.FeatureTest.isLittleEndian){for(;c<v-2;c+=3,N+=4){const m=b[c],u=b[c+1],_=b[c+2];a[N]=m|4278190080,a[N+1]=m>>>24|u<<8|4278190080,a[N+2]=u>>>16|_<<16|4278190080,a[N+3]=_>>>8|4278190080}for(let m=c*4,u=R.length;m<u;m+=3)a[N++]=R[m]|R[m+1]<<8|R[m+2]<<16|4278190080}else{for(;c<v-2;c+=3,N+=4){const m=b[c],u=b[c+1],_=b[c+2];a[N]=m|255,a[N+1]=m<<24|u>>>8|255,a[N+2]=u<<16|_>>>16|255,a[N+3]=_<<8|255}for(let m=c*4,u=R.length;m<u;m+=3)a[N++]=R[m]<<24|R[m+1]<<16|R[m+2]<<8|255}return{srcPos:f,destPos:N}}function V(R,f){if(S.FeatureTest.isLittleEndian)for(let a=0,N=R.length;a<N;a++)f[a]=R[a]*65793|4278190080;else for(let a=0,N=R.length;a<N;a++)f[a]=R[a]*16843008|255}},(Ct,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.GlobalWorkerOptions=void 0;const mt=Object.create(null);L.GlobalWorkerOptions=mt,mt.workerPort=null,mt.workerSrc=""},(Ct,L,mt)=>{var R,rn,an,Me;Object.defineProperty(L,"__esModule",{value:!0}),L.MessageHandler=void 0;var S=mt(1);const G={DATA:1,ERROR:2},bt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function et(x){switch(x instanceof Error||typeof x=="object"&&x!==null||(0,S.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),x.name){case"AbortException":return new S.AbortException(x.message);case"MissingPDFException":return new S.MissingPDFException(x.message);case"PasswordException":return new S.PasswordException(x.message,x.code);case"UnexpectedResponseException":return new S.UnexpectedResponseException(x.message,x.status);case"UnknownErrorException":return new S.UnknownErrorException(x.message,x.details);default:return new S.UnknownErrorException(x.message,x.toString())}}class V{constructor(p,c,v){tt(this,R);this.sourceName=p,this.targetName=c,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=b=>{const m=b.data;if(m.targetName!==this.sourceName)return;if(m.stream){j(this,R,an).call(this,m);return}if(m.callback){const _=m.callbackId,g=this.callbackCapabilities[_];if(!g)throw new Error(`Cannot resolve callback ${_}`);if(delete this.callbackCapabilities[_],m.callback===G.DATA)g.resolve(m.data);else if(m.callback===G.ERROR)g.reject(et(m.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[m.action];if(!u)throw new Error(`Unknown action from worker: ${m.action}`);if(m.callbackId){const _=this.sourceName,g=m.sourceName;new Promise(function(i){i(u(m.data))}).then(function(i){v.postMessage({sourceName:_,targetName:g,callback:G.DATA,callbackId:m.callbackId,data:i})},function(i){v.postMessage({sourceName:_,targetName:g,callback:G.ERROR,callbackId:m.callbackId,reason:et(i)})});return}if(m.streamId){j(this,R,rn).call(this,m);return}u(m.data)},v.addEventListener("message",this._onComObjOnMessage)}on(p,c){const v=this.actionHandler;if(v[p])throw new Error(`There is already an actionName called "${p}"`);v[p]=c}send(p,c,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,data:c},v)}sendWithPromise(p,c,v){const b=this.callbackId++,m=new S.PromiseCapability;this.callbackCapabilities[b]=m;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,callbackId:b,data:c},v)}catch(u){m.reject(u)}return m.promise}sendWithStream(p,c,v,b){const m=this.streamId++,u=this.sourceName,_=this.targetName,g=this.comObj;return new ReadableStream({start:i=>{const e=new S.PromiseCapability;return this.streamControllers[m]={controller:i,startCall:e,pullCall:null,cancelCall:null,isClosed:!1},g.postMessage({sourceName:u,targetName:_,action:p,streamId:m,data:c,desiredSize:i.desiredSize},b),e.promise},pull:i=>{const e=new S.PromiseCapability;return this.streamControllers[m].pullCall=e,g.postMessage({sourceName:u,targetName:_,stream:bt.PULL,streamId:m,desiredSize:i.desiredSize}),e.promise},cancel:i=>{(0,S.assert)(i instanceof Error,"cancel must have a valid reason");const e=new S.PromiseCapability;return this.streamControllers[m].cancelCall=e,this.streamControllers[m].isClosed=!0,g.postMessage({sourceName:u,targetName:_,stream:bt.CANCEL,streamId:m,reason:et(i)}),e.promise}},v)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}R=new WeakSet,rn=function(p){const c=p.streamId,v=this.sourceName,b=p.sourceName,m=this.comObj,u=this,_=this.actionHandler[p.action],g={enqueue(i,e=1,n){if(this.isCancelled)return;const r=this.desiredSize;this.desiredSize-=e,r>0&&this.desiredSize<=0&&(this.sinkCapability=new S.PromiseCapability,this.ready=this.sinkCapability.promise),m.postMessage({sourceName:v,targetName:b,stream:bt.ENQUEUE,streamId:c,chunk:i},n)},close(){this.isCancelled||(this.isCancelled=!0,m.postMessage({sourceName:v,targetName:b,stream:bt.CLOSE,streamId:c}),delete u.streamSinks[c])},error(i){(0,S.assert)(i instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,m.postMessage({sourceName:v,targetName:b,stream:bt.ERROR,streamId:c,reason:et(i)}))},sinkCapability:new S.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[c]=g,new Promise(function(i){i(_(p.data,g))}).then(function(){m.postMessage({sourceName:v,targetName:b,stream:bt.START_COMPLETE,streamId:c,success:!0})},function(i){m.postMessage({sourceName:v,targetName:b,stream:bt.START_COMPLETE,streamId:c,reason:et(i)})})},an=function(p){const c=p.streamId,v=this.sourceName,b=p.sourceName,m=this.comObj,u=this.streamControllers[c],_=this.streamSinks[c];switch(p.stream){case bt.START_COMPLETE:p.success?u.startCall.resolve():u.startCall.reject(et(p.reason));break;case bt.PULL_COMPLETE:p.success?u.pullCall.resolve():u.pullCall.reject(et(p.reason));break;case bt.PULL:if(!_){m.postMessage({sourceName:v,targetName:b,stream:bt.PULL_COMPLETE,streamId:c,success:!0});break}_.desiredSize<=0&&p.desiredSize>0&&_.sinkCapability.resolve(),_.desiredSize=p.desiredSize,new Promise(function(g){var i;g((i=_.onPull)==null?void 0:i.call(_))}).then(function(){m.postMessage({sourceName:v,targetName:b,stream:bt.PULL_COMPLETE,streamId:c,success:!0})},function(g){m.postMessage({sourceName:v,targetName:b,stream:bt.PULL_COMPLETE,streamId:c,reason:et(g)})});break;case bt.ENQUEUE:if((0,S.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(p.chunk);break;case bt.CLOSE:if((0,S.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),j(this,R,Me).call(this,u,c);break;case bt.ERROR:(0,S.assert)(u,"error should have stream controller"),u.controller.error(et(p.reason)),j(this,R,Me).call(this,u,c);break;case bt.CANCEL_COMPLETE:p.success?u.cancelCall.resolve():u.cancelCall.reject(et(p.reason)),j(this,R,Me).call(this,u,c);break;case bt.CANCEL:if(!_)break;new Promise(function(g){var i;g((i=_.onCancel)==null?void 0:i.call(_,et(p.reason)))}).then(function(){m.postMessage({sourceName:v,targetName:b,stream:bt.CANCEL_COMPLETE,streamId:c,success:!0})},function(g){m.postMessage({sourceName:v,targetName:b,stream:bt.CANCEL_COMPLETE,streamId:c,reason:et(g)})}),_.sinkCapability.reject(et(p.reason)),_.isCancelled=!0,delete this.streamSinks[c];break;default:throw new Error("Unexpected stream case")}},Me=async function(p,c){var v,b,m;await Promise.allSettled([(v=p.startCall)==null?void 0:v.promise,(b=p.pullCall)==null?void 0:b.promise,(m=p.cancelCall)==null?void 0:m.promise]),delete this.streamControllers[c]},L.MessageHandler=V},(Ct,L,mt)=>{var bt,et;Object.defineProperty(L,"__esModule",{value:!0}),L.Metadata=void 0;var S=mt(1);class G{constructor({parsedData:R,rawData:f}){tt(this,bt);tt(this,et);Z(this,bt,R),Z(this,et,f)}getRaw(){return t(this,et)}get(R){return t(this,bt).get(R)??null}getAll(){return(0,S.objectFromMap)(t(this,bt))}has(R){return t(this,bt).has(R)}}bt=new WeakMap,et=new WeakMap,L.Metadata=G},(Ct,L,mt)=>{var R,f,a,N,x,p,oi;Object.defineProperty(L,"__esModule",{value:!0}),L.OptionalContentConfig=void 0;var S=mt(1),G=mt(8);const bt=Symbol("INTERNAL");class et{constructor(b,m){tt(this,R,!0);this.name=b,this.intent=m}get visible(){return t(this,R)}_setVisible(b,m){b!==bt&&(0,S.unreachable)("Internal method `_setVisible` called."),Z(this,R,m)}}R=new WeakMap;class V{constructor(b){tt(this,p);tt(this,f,null);tt(this,a,new Map);tt(this,N,null);tt(this,x,null);if(this.name=null,this.creator=null,b!==null){this.name=b.name,this.creator=b.creator,Z(this,x,b.order);for(const m of b.groups)t(this,a).set(m.id,new et(m.name,m.intent));if(b.baseState==="OFF")for(const m of t(this,a).values())m._setVisible(bt,!1);for(const m of b.on)t(this,a).get(m)._setVisible(bt,!0);for(const m of b.off)t(this,a).get(m)._setVisible(bt,!1);Z(this,N,this.getHash())}}isVisible(b){if(t(this,a).size===0)return!0;if(!b)return(0,S.warn)("Optional content group not defined."),!0;if(b.type==="OCG")return t(this,a).has(b.id)?t(this,a).get(b.id).visible:((0,S.warn)(`Optional content group not found: ${b.id}`),!0);if(b.type==="OCMD"){if(b.expression)return j(this,p,oi).call(this,b.expression);if(!b.policy||b.policy==="AnyOn"){for(const m of b.ids){if(!t(this,a).has(m))return(0,S.warn)(`Optional content group not found: ${m}`),!0;if(t(this,a).get(m).visible)return!0}return!1}else if(b.policy==="AllOn"){for(const m of b.ids){if(!t(this,a).has(m))return(0,S.warn)(`Optional content group not found: ${m}`),!0;if(!t(this,a).get(m).visible)return!1}return!0}else if(b.policy==="AnyOff"){for(const m of b.ids){if(!t(this,a).has(m))return(0,S.warn)(`Optional content group not found: ${m}`),!0;if(!t(this,a).get(m).visible)return!0}return!1}else if(b.policy==="AllOff"){for(const m of b.ids){if(!t(this,a).has(m))return(0,S.warn)(`Optional content group not found: ${m}`),!0;if(t(this,a).get(m).visible)return!1}return!0}return(0,S.warn)(`Unknown optional content policy ${b.policy}.`),!0}return(0,S.warn)(`Unknown group type ${b.type}.`),!0}setVisibility(b,m=!0){if(!t(this,a).has(b)){(0,S.warn)(`Optional content group not found: ${b}`);return}t(this,a).get(b)._setVisible(bt,!!m),Z(this,f,null)}get hasInitialVisibility(){return t(this,N)===null||this.getHash()===t(this,N)}getOrder(){return t(this,a).size?t(this,x)?t(this,x).slice():[...t(this,a).keys()]:null}getGroups(){return t(this,a).size>0?(0,S.objectFromMap)(t(this,a)):null}getGroup(b){return t(this,a).get(b)||null}getHash(){if(t(this,f)!==null)return t(this,f);const b=new G.MurmurHash3_64;for(const[m,u]of t(this,a))b.update(`${m}:${u.visible}`);return Z(this,f,b.hexdigest())}}f=new WeakMap,a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakSet,oi=function(b){const m=b.length;if(m<2)return!0;const u=b[0];for(let _=1;_<m;_++){const g=b[_];let i;if(Array.isArray(g))i=j(this,p,oi).call(this,g);else if(t(this,a).has(g))i=t(this,a).get(g).visible;else return(0,S.warn)(`Optional content group not found: ${g}`),!0;switch(u){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return u==="And"},L.OptionalContentConfig=V},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFDataTransportStream=void 0;var S=mt(1),G=mt(6);class bt{constructor({length:f,initialData:a,progressiveDone:N=!1,contentDispositionFilename:x=null,disableRange:p=!1,disableStream:c=!1},v){if((0,S.assert)(v,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=N,this._contentDispositionFilename=x,(a==null?void 0:a.length)>0){const b=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(b)}this._pdfDataRangeTransport=v,this._isStreamingSupported=!c,this._isRangeSupported=!p,this._contentLength=f,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((b,m)=>{this._onReceiveData({begin:b,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((b,m)=>{this._onProgress({loaded:b,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(b=>{this._onReceiveData({chunk:b})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:f,chunk:a}){const N=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(N):this._queuedChunks.push(N);else{const x=this._rangeReaders.some(function(p){return p._begin!==f?!1:(p._enqueue(N),!0)});(0,S.assert)(x,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){var a,N,x,p;f.total===void 0?(N=(a=this._rangeReaders[0])==null?void 0:a.onProgress)==null||N.call(a,{loaded:f.loaded}):(p=(x=this._fullRequestReader)==null?void 0:x.onProgress)==null||p.call(x,{loaded:f.loaded,total:f.total})}_onProgressiveDone(){var f;(f=this._fullRequestReader)==null||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const a=this._rangeReaders.indexOf(f);a>=0&&this._rangeReaders.splice(a,1)}getFullReader(){(0,S.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new et(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,a){if(a<=this._progressiveDataLength)return null;const N=new V(this,f,a);return this._pdfDataRangeTransport.requestDataRange(f,a),this._rangeReaders.push(N),N}cancelAllRequests(f){var a;(a=this._fullRequestReader)==null||a.cancel(f);for(const N of this._rangeReaders.slice(0))N.cancel(f);this._pdfDataRangeTransport.abort()}}L.PDFDataTransportStream=bt;class et{constructor(f,a,N=!1,x=null){this._stream=f,this._done=N||!1,this._filename=(0,G.isPdfFile)(x)?x:null,this._queuedChunks=a||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=new S.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class V{constructor(f,a,N){this._stream=f,this._begin=a,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const a=this._queuedChunk;return this._queuedChunk=null,{value:a,done:!1}}if(this._done)return{value:void 0,done:!0};const f=new S.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFFetchStream=void 0;var S=mt(1),G=mt(20);function bt(N,x,p){return{method:"GET",headers:N,signal:p.signal,mode:"cors",credentials:x?"include":"same-origin",redirect:"follow"}}function et(N){const x=new Headers;for(const p in N){const c=N[p];c!==void 0&&x.append(p,c)}return x}function V(N){return N instanceof Uint8Array?N.buffer:N instanceof ArrayBuffer?N:((0,S.warn)(`getArrayBuffer - unexpected data format: ${N}`),new Uint8Array(N).buffer)}class R{constructor(x){this.source=x,this.isHttp=/^https?:/i.test(x.url),this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(x,p){if(p<=this._progressiveDataLength)return null;const c=new a(this,x,p);return this._rangeRequestReaders.push(c),c}cancelAllRequests(x){var p;(p=this._fullRequestReader)==null||p.cancel(x);for(const c of this._rangeRequestReaders.slice(0))c.cancel(x)}}L.PDFFetchStream=R;class f{constructor(x){this._stream=x,this._reader=null,this._loaded=0,this._filename=null;const p=x.source;this._withCredentials=p.withCredentials||!1,this._contentLength=p.length,this._headersCapability=new S.PromiseCapability,this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._headers=et(this._stream.httpHeaders);const c=p.url;fetch(c,bt(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,G.validateResponseStatus)(v.status))throw(0,G.createResponseStatusError)(v.status,c);this._reader=v.body.getReader(),this._headersCapability.resolve();const b=_=>v.headers.get(_),{allowRangeRequests:m,suggestedLength:u}=(0,G.validateRangeRequestCapabilities)({getResponseHeader:b,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=u||this._contentLength,this._filename=(0,G.extractFilenameFromHeader)(b),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new S.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;await this._headersCapability.promise;const{value:x,done:p}=await this._reader.read();return p?{value:x,done:p}:(this._loaded+=x.byteLength,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded,total:this._contentLength}),{value:V(x),done:!1})}cancel(x){var p;(p=this._reader)==null||p.cancel(x),this._abortController.abort()}}class a{constructor(x,p,c){this._stream=x,this._reader=null,this._loaded=0;const v=x.source;this._withCredentials=v.withCredentials||!1,this._readCapability=new S.PromiseCapability,this._isStreamingSupported=!v.disableStream,this._abortController=new AbortController,this._headers=et(this._stream.httpHeaders),this._headers.append("Range",`bytes=${p}-${c-1}`);const b=v.url;fetch(b,bt(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,G.validateResponseStatus)(m.status))throw(0,G.createResponseStatusError)(m.status,b);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;await this._readCapability.promise;const{value:x,done:p}=await this._reader.read();return p?{value:x,done:p}:(this._loaded+=x.byteLength,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded}),{value:V(x),done:!1})}cancel(x){var p;(p=this._reader)==null||p.cancel(x),this._abortController.abort()}}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.createResponseStatusError=R,L.extractFilenameFromHeader=V,L.validateRangeRequestCapabilities=et,L.validateResponseStatus=f;var S=mt(1),G=mt(21),bt=mt(6);function et({getResponseHeader:a,isHttp:N,rangeChunkSize:x,disableRange:p}){const c={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(a("Content-Length"),10);return!Number.isInteger(v)||(c.suggestedLength=v,v<=2*x)||p||!N||a("Accept-Ranges")!=="bytes"||(a("Content-Encoding")||"identity")!=="identity"||(c.allowRangeRequests=!0),c}function V(a){const N=a("Content-Disposition");if(N){let x=(0,G.getFilenameFromContentDispositionHeader)(N);if(x.includes("%"))try{x=decodeURIComponent(x)}catch{}if((0,bt.isPdfFile)(x))return x}return null}function R(a,N){return a===404||a===0&&N.startsWith("file:")?new S.MissingPDFException('Missing PDF "'+N+'".'):new S.UnexpectedResponseException(`Unexpected server response (${a}) while retrieving PDF "${N}".`,a)}function f(a){return a===200||a===206}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.getFilenameFromContentDispositionHeader=G;var S=mt(1);function G(bt){let et=!0,V=R("filename\\*","i").exec(bt);if(V){V=V[1];let v=x(V);return v=unescape(v),v=p(v),v=c(v),a(v)}if(V=N(bt),V){const v=c(V);return a(v)}if(V=R("filename","i").exec(bt),V){V=V[1];let v=x(V);return v=c(v),a(v)}function R(v,b){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function f(v,b){if(v){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const m=new TextDecoder(v,{fatal:!0}),u=(0,S.stringToBytes)(b);b=m.decode(u),et=!1}catch{}}return b}function a(v){return et&&/[\x80-\xff]/.test(v)&&(v=f("utf-8",v),et&&(v=f("iso-8859-1",v))),v}function N(v){const b=[];let m;const u=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=u.exec(v))!==null;){let[,g,i,e]=m;if(g=parseInt(g,10),g in b){if(g===0)break;continue}b[g]=[i,e]}const _=[];for(let g=0;g<b.length&&g in b;++g){let[i,e]=b[g];e=x(e),i&&(e=unescape(e),g===0&&(e=p(e))),_.push(e)}return _.join("")}function x(v){if(v.startsWith('"')){const b=v.slice(1).split('\\"');for(let m=0;m<b.length;++m){const u=b[m].indexOf('"');u!==-1&&(b[m]=b[m].slice(0,u),b.length=m+1),b[m]=b[m].replaceAll(/\\(.)/g,"$1")}v=b.join('"')}return v}function p(v){const b=v.indexOf("'");if(b===-1)return v;const m=v.slice(0,b),_=v.slice(b+1).replace(/^[^']*'/,"");return f(m,_)}function c(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,m,u,_){if(u==="q"||u==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,i){return String.fromCharCode(parseInt(i,16))}),f(m,_);try{_=atob(_)}catch{}return f(m,_)})}return""}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFNetworkStream=void 0;var S=mt(1),G=mt(20);const bt=200,et=206;function V(x){const p=x.response;return typeof p!="string"?p:(0,S.stringToBytes)(p).buffer}class R{constructor(p,c={}){this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&c.httpHeaders||Object.create(null),this.withCredentials=c.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,c,v){const b={begin:p,end:c};for(const m in v)b[m]=v[m];return this.request(b)}requestFull(p){return this.request(p)}request(p){const c=new XMLHttpRequest,v=this.currXhrId++,b=this.pendingRequests[v]={xhr:c};c.open("GET",this.url),c.withCredentials=this.withCredentials;for(const m in this.httpHeaders){const u=this.httpHeaders[m];u!==void 0&&c.setRequestHeader(m,u)}return this.isHttp&&"begin"in p&&"end"in p?(c.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),b.expectedStatus=et):b.expectedStatus=bt,c.responseType="arraybuffer",p.onError&&(c.onerror=function(m){p.onError(c.status)}),c.onreadystatechange=this.onStateChange.bind(this,v),c.onprogress=this.onProgress.bind(this,v),b.onHeadersReceived=p.onHeadersReceived,b.onDone=p.onDone,b.onError=p.onError,b.onProgress=p.onProgress,c.send(null),v}onProgress(p,c){var b;const v=this.pendingRequests[p];v&&((b=v.onProgress)==null||b.call(v,c))}onStateChange(p,c){var g,i,e;const v=this.pendingRequests[p];if(!v)return;const b=v.xhr;if(b.readyState>=2&&v.onHeadersReceived&&(v.onHeadersReceived(),delete v.onHeadersReceived),b.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],b.status===0&&this.isHttp){(g=v.onError)==null||g.call(v,b.status);return}const m=b.status||bt;if(!(m===bt&&v.expectedStatus===et)&&m!==v.expectedStatus){(i=v.onError)==null||i.call(v,b.status);return}const _=V(b);if(m===et){const n=b.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(n);v.onDone({begin:parseInt(r[1],10),chunk:_})}else _?v.onDone({begin:0,chunk:_}):(e=v.onError)==null||e.call(v,b.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const c=this.pendingRequests[p].xhr;delete this.pendingRequests[p],c.abort()}}class f{constructor(p){this._source=p,this._manager=new R(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const c=this._rangeRequestReaders.indexOf(p);c>=0&&this._rangeRequestReaders.splice(c,1)}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new a(this._manager,this._source),this._fullRequestReader}getRangeReader(p,c){const v=new N(this._manager,p,c);return v.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(v),v}cancelAllRequests(p){var c;(c=this._fullRequestReader)==null||c.cancel(p);for(const v of this._rangeRequestReaders.slice(0))v.cancel(p)}}L.PDFNetworkStream=f;class a{constructor(p,c){this._manager=p;const v={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._fullRequestId=p.requestFull(v),this._headersReceivedCapability=new S.PromiseCapability,this._disableRange=c.disableRange||!1,this._contentLength=c.length,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,c=this._manager.getRequestXhr(p),v=u=>c.getResponseHeader(u),{allowRangeRequests:b,suggestedLength:m}=(0,G.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=m||this._contentLength,this._filename=(0,G.extractFilenameFromHeader)(v),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,G.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){var c;(c=this.onProgress)==null||c.call(this,{loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=new S.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(p,c,v){this._manager=p;const b={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(c,v,b),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var p;(p=this.onClosed)==null||p.call(this,this)}_onDone(p){const c=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:c,done:!1}):this._queuedChunk=c,this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,G.createResponseStatusError)(p,this._url);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){var c;this.isStreamingSupported||(c=this.onProgress)==null||c.call(this,{loaded:p.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const p=new S.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFNodeStream=void 0;var S=mt(1),G=mt(20);const bt=/^file:\/\/\/[a-zA-Z]:\//;function et(v){const b=require$$5,m=b.parse(v);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(v)?b.parse(`file:///${v}`):(m.host||(m.protocol="file:"),m)}class V{constructor(b){this.source=b,this.url=et(b.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&b.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var b;return((b=this._fullRequestReader)==null?void 0:b._loaded)??0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new N(this),this._fullRequestReader}getRangeReader(b,m){if(m<=this._progressiveDataLength)return null;const u=this.isFsUrl?new c(this,b,m):new x(this,b,m);return this._rangeRequestReaders.push(u),u}cancelAllRequests(b){var m;(m=this._fullRequestReader)==null||m.cancel(b);for(const u of this._rangeRequestReaders.slice(0))u.cancel(b)}}L.PDFNodeStream=V;class R{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null;const m=b.source;this._contentLength=m.length,this._loaded=0,this._filename=null,this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._readableStream=null,this._readCapability=new S.PromiseCapability,this._headersCapability=new S.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const b=this._readableStream.read();return b===null?(this._readCapability=new S.PromiseCapability,this.read()):(this._loaded+=b.length,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(b).buffer,done:!1})}cancel(b){if(!this._readableStream){this._error(b);return}this._readableStream.destroy(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",m=>{this._error(m)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new S.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new S.PromiseCapability;const m=b.source;this._isStreamingSupported=!m.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var u;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const b=this._readableStream.read();return b===null?(this._readCapability=new S.PromiseCapability,this.read()):(this._loaded+=b.length,(u=this.onProgress)==null||u.call(this,{loaded:this._loaded}),{value:new Uint8Array(b).buffer,done:!1})}cancel(b){if(!this._readableStream){this._error(b);return}this._readableStream.destroy(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",m=>{this._error(m)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function a(v,b){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:b}}class N extends R{constructor(b){super(b);const m=u=>{if(u.statusCode===404){const e=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=e,this._headersCapability.reject(e);return}this._headersCapability.resolve(),this._setReadableStream(u);const _=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:g,suggestedLength:i}=(0,G.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:b.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=g,this._contentLength=i||this._contentLength,this._filename=(0,G.extractFilenameFromHeader)(_)};if(this._request=null,this._url.protocol==="http:"){const u=require$$5;this._request=u.request(a(this._url,b.httpHeaders),m)}else{const u=require$$5;this._request=u.request(a(this._url,b.httpHeaders),m)}this._request.on("error",u=>{this._storedError=u,this._headersCapability.reject(u)}),this._request.end()}}class x extends f{constructor(b,m,u){super(b),this._httpHeaders={};for(const g in b.httpHeaders){const i=b.httpHeaders[g];i!==void 0&&(this._httpHeaders[g]=i)}this._httpHeaders.Range=`bytes=${m}-${u-1}`;const _=g=>{if(g.statusCode===404){const i=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=i;return}this._setReadableStream(g)};if(this._request=null,this._url.protocol==="http:"){const g=require$$5;this._request=g.request(a(this._url,this._httpHeaders),_)}else{const g=require$$5;this._request=g.request(a(this._url,this._httpHeaders),_)}this._request.on("error",g=>{this._storedError=g}),this._request.end()}}class p extends R{constructor(b){super(b);let m=decodeURIComponent(this._url.path);bt.test(this._url.href)&&(m=m.replace(/^\//,""));const u=require$$5;u.lstat(m,(_,g)=>{if(_){_.code==="ENOENT"&&(_=new S.MissingPDFException(`Missing PDF "${m}".`)),this._storedError=_,this._headersCapability.reject(_);return}this._contentLength=g.size,this._setReadableStream(u.createReadStream(m)),this._headersCapability.resolve()})}}class c extends f{constructor(b,m,u){super(b);let _=decodeURIComponent(this._url.path);bt.test(this._url.href)&&(_=_.replace(/^\//,""));const g=require$$5;this._setReadableStream(g.createReadStream(_,{start:m,end:u-1}))}}},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.SVGGraphics=void 0;var S=mt(6),G=mt(1);const bt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},et="http://www.w3.org/XML/1998/namespace",V="http://www.w3.org/1999/xlink",R=["butt","round","square"],f=["miter","round","bevel"],a=function(g,i="",e=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!e)return URL.createObjectURL(new Blob([g],{type:i}));const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r=`data:${i};base64,`;for(let d=0,T=g.length;d<T;d+=3){const o=g[d]&255,E=g[d+1]&255,W=g[d+2]&255,D=o>>2,B=(o&3)<<4|E>>4,z=d+1<T?(E&15)<<2|W>>6:64,M=d+2<T?W&63:64;r+=n[D]+n[B]+n[z]+n[M]}return r},N=function(){const g=new Uint8Array([137,80,78,71,13,10,26,10]),i=12,e=new Int32Array(256);for(let W=0;W<256;W++){let D=W;for(let B=0;B<8;B++)D=D&1?3988292384^D>>1&2147483647:D>>1&2147483647;e[W]=D}function n(W,D,B){let z=-1;for(let M=D;M<B;M++){const Q=(z^W[M])&255,y=e[Q];z=z>>>8^y}return z^-1}function r(W,D,B,z){let M=z;const Q=D.length;B[M]=Q>>24&255,B[M+1]=Q>>16&255,B[M+2]=Q>>8&255,B[M+3]=Q&255,M+=4,B[M]=W.charCodeAt(0)&255,B[M+1]=W.charCodeAt(1)&255,B[M+2]=W.charCodeAt(2)&255,B[M+3]=W.charCodeAt(3)&255,M+=4,B.set(D,M),M+=D.length;const y=n(B,z+4,M);B[M]=y>>24&255,B[M+1]=y>>16&255,B[M+2]=y>>8&255,B[M+3]=y&255}function d(W,D,B){let z=1,M=0;for(let Q=D;Q<B;++Q)z=(z+(W[Q]&255))%65521,M=(M+z)%65521;return M<<16|z}function T(W){if(!G.isNodeJS)return o(W);try{const D=parseInt(process.versions.node)>=8?W:Buffer.from(W),B=require$$5.deflateSync(D,{level:9});return B instanceof Uint8Array?B:new Uint8Array(B)}catch(D){(0,G.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+D)}return o(W)}function o(W){let D=W.length;const B=65535,z=Math.ceil(D/B),M=new Uint8Array(2+D+z*5+4);let Q=0;M[Q++]=120,M[Q++]=156;let y=0;for(;D>B;)M[Q++]=0,M[Q++]=255,M[Q++]=255,M[Q++]=0,M[Q++]=0,M.set(W.subarray(y,y+B),Q),Q+=B,y+=B,D-=B;M[Q++]=1,M[Q++]=D&255,M[Q++]=D>>8&255,M[Q++]=~D&65535&255,M[Q++]=(~D&65535)>>8&255,M.set(W.subarray(y),Q),Q+=W.length-y;const C=d(W,0,W.length);return M[Q++]=C>>24&255,M[Q++]=C>>16&255,M[Q++]=C>>8&255,M[Q++]=C&255,M}function E(W,D,B,z){const M=W.width,Q=W.height;let y,C,rt;const O=W.data;switch(D){case G.ImageKind.GRAYSCALE_1BPP:C=0,y=1,rt=M+7>>3;break;case G.ImageKind.RGB_24BPP:C=2,y=8,rt=M*3;break;case G.ImageKind.RGBA_32BPP:C=6,y=8,rt=M*4;break;default:throw new Error("invalid format")}const l=new Uint8Array((1+rt)*Q);let h=0,A=0;for(let ft=0;ft<Q;++ft)l[h++]=0,l.set(O.subarray(A,A+rt),h),A+=rt,h+=rt;if(D===G.ImageKind.GRAYSCALE_1BPP&&z){h=0;for(let ft=0;ft<Q;ft++){h++;for(let pt=0;pt<rt;pt++)l[h++]^=255}}const Y=new Uint8Array([M>>24&255,M>>16&255,M>>8&255,M&255,Q>>24&255,Q>>16&255,Q>>8&255,Q&255,y,C,0,0,0]),K=T(l),k=g.length+i*3+Y.length+K.length,J=new Uint8Array(k);let at=0;return J.set(g,at),at+=g.length,r("IHDR",Y,J,at),at+=i+Y.length,r("IDATA",K,J,at),at+=i+K.length,r("IEND",new Uint8Array(0),J,at),a(J,"image/png",B)}return function(D,B,z){const M=D.kind===void 0?G.ImageKind.GRAYSCALE_1BPP:D.kind;return E(D,M,B,z)}}();class x{constructor(){this.fontSizeScale=1,this.fontWeight=bt.fontWeight,this.fontSize=0,this.textMatrix=G.IDENTITY_MATRIX,this.fontMatrix=G.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=G.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=bt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(i,e){this.x=i,this.y=e}}function p(g){let i=[];const e=[];for(const n of g){if(n.fn==="save"){i.push({fnId:92,fn:"group",items:[]}),e.push(i),i=i.at(-1).items;continue}n.fn==="restore"?i=e.pop():i.push(n)}return i}function c(g){if(Number.isInteger(g))return g.toString();const i=g.toFixed(10);let e=i.length-1;if(i[e]!=="0")return i;do e--;while(i[e]==="0");return i.substring(0,i[e]==="."?e:e+1)}function v(g){if(g[4]===0&&g[5]===0){if(g[1]===0&&g[2]===0)return g[0]===1&&g[3]===1?"":`scale(${c(g[0])} ${c(g[3])})`;if(g[0]===g[3]&&g[1]===-g[2]){const i=Math.acos(g[0])*180/Math.PI;return`rotate(${c(i)})`}}else if(g[0]===1&&g[1]===0&&g[2]===0&&g[3]===1)return`translate(${c(g[4])} ${c(g[5])})`;return`matrix(${c(g[0])} ${c(g[1])} ${c(g[2])} ${c(g[3])} ${c(g[4])} ${c(g[5])})`}let b=0,m=0,u=0;class _{constructor(i,e,n=!1){(0,S.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new S.DOMSVGFactory,this.current=new x,this.transformMatrix=G.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=i,this.objs=e,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const r in G.OPS)this._operatorIdMapping[G.OPS[r]]=r}getObject(i,e=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):e}save(){this.transformStack.push(this.transformMatrix);const i=this.current;this.extraStack.push(i),this.current=i.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(i){this.save(),this.executeOpTree(i),this.restore()}loadDependencies(i){const e=i.fnArray,n=i.argsArray;for(let r=0,d=e.length;r<d;r++)if(e[r]===G.OPS.dependency)for(const T of n[r]){const o=T.startsWith("g_")?this.commonObjs:this.objs,E=new Promise(W=>{o.get(T,W)});this.current.dependencies.push(E)}return Promise.all(this.current.dependencies)}transform(i,e,n,r,d,T){const o=[i,e,n,r,d,T];this.transformMatrix=G.Util.transform(this.transformMatrix,o),this.tgrp=null}getSVG(i,e){this.viewport=e;const n=this._initialize(e);return this.loadDependencies(i).then(()=>(this.transformMatrix=G.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(i)),n))}convertOpList(i){const e=this._operatorIdMapping,n=i.argsArray,r=i.fnArray,d=[];for(let T=0,o=r.length;T<o;T++){const E=r[T];d.push({fnId:E,fn:e[E],args:n[T]})}return p(d)}executeOpTree(i){for(const e of i){const n=e.fn,r=e.fnId,d=e.args;switch(r|0){case G.OPS.beginText:this.beginText();break;case G.OPS.dependency:break;case G.OPS.setLeading:this.setLeading(d);break;case G.OPS.setLeadingMoveText:this.setLeadingMoveText(d[0],d[1]);break;case G.OPS.setFont:this.setFont(d);break;case G.OPS.showText:this.showText(d[0]);break;case G.OPS.showSpacedText:this.showText(d[0]);break;case G.OPS.endText:this.endText();break;case G.OPS.moveText:this.moveText(d[0],d[1]);break;case G.OPS.setCharSpacing:this.setCharSpacing(d[0]);break;case G.OPS.setWordSpacing:this.setWordSpacing(d[0]);break;case G.OPS.setHScale:this.setHScale(d[0]);break;case G.OPS.setTextMatrix:this.setTextMatrix(d[0],d[1],d[2],d[3],d[4],d[5]);break;case G.OPS.setTextRise:this.setTextRise(d[0]);break;case G.OPS.setTextRenderingMode:this.setTextRenderingMode(d[0]);break;case G.OPS.setLineWidth:this.setLineWidth(d[0]);break;case G.OPS.setLineJoin:this.setLineJoin(d[0]);break;case G.OPS.setLineCap:this.setLineCap(d[0]);break;case G.OPS.setMiterLimit:this.setMiterLimit(d[0]);break;case G.OPS.setFillRGBColor:this.setFillRGBColor(d[0],d[1],d[2]);break;case G.OPS.setStrokeRGBColor:this.setStrokeRGBColor(d[0],d[1],d[2]);break;case G.OPS.setStrokeColorN:this.setStrokeColorN(d);break;case G.OPS.setFillColorN:this.setFillColorN(d);break;case G.OPS.shadingFill:this.shadingFill(d[0]);break;case G.OPS.setDash:this.setDash(d[0],d[1]);break;case G.OPS.setRenderingIntent:this.setRenderingIntent(d[0]);break;case G.OPS.setFlatness:this.setFlatness(d[0]);break;case G.OPS.setGState:this.setGState(d[0]);break;case G.OPS.fill:this.fill();break;case G.OPS.eoFill:this.eoFill();break;case G.OPS.stroke:this.stroke();break;case G.OPS.fillStroke:this.fillStroke();break;case G.OPS.eoFillStroke:this.eoFillStroke();break;case G.OPS.clip:this.clip("nonzero");break;case G.OPS.eoClip:this.clip("evenodd");break;case G.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case G.OPS.paintImageXObject:this.paintImageXObject(d[0]);break;case G.OPS.paintInlineImageXObject:this.paintInlineImageXObject(d[0]);break;case G.OPS.paintImageMaskXObject:this.paintImageMaskXObject(d[0]);break;case G.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(d[0],d[1]);break;case G.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case G.OPS.closePath:this.closePath();break;case G.OPS.closeStroke:this.closeStroke();break;case G.OPS.closeFillStroke:this.closeFillStroke();break;case G.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case G.OPS.nextLine:this.nextLine();break;case G.OPS.transform:this.transform(d[0],d[1],d[2],d[3],d[4],d[5]);break;case G.OPS.constructPath:this.constructPath(d[0],d[1]);break;case G.OPS.endPath:this.endPath();break;case 92:this.group(e.items);break;default:(0,G.warn)(`Unimplemented operator ${n}`);break}}}setWordSpacing(i){this.current.wordSpacing=i}setCharSpacing(i){this.current.charSpacing=i}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(i,e,n,r,d,T){const o=this.current;o.textMatrix=o.lineMatrix=[i,e,n,r,d,T],o.textMatrixScale=Math.hypot(i,e),o.x=o.lineX=0,o.y=o.lineY=0,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${c(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",c(-o.y)),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtElement.append(o.tspan)}beginText(){const i=this.current;i.x=i.lineX=0,i.y=i.lineY=0,i.textMatrix=G.IDENTITY_MATRIX,i.lineMatrix=G.IDENTITY_MATRIX,i.textMatrixScale=1,i.tspan=this.svgFactory.createElement("svg:tspan"),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtgrp=this.svgFactory.createElement("svg:g"),i.xcoords=[],i.ycoords=[]}moveText(i,e){const n=this.current;n.x=n.lineX+=i,n.y=n.lineY+=e,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${c(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",c(-n.y))}showText(i){const e=this.current,n=e.font,r=e.fontSize;if(r===0)return;const d=e.fontSizeScale,T=e.charSpacing,o=e.wordSpacing,E=e.fontDirection,W=e.textHScale*E,D=n.vertical,B=D?1:-1,z=n.defaultVMetrics,M=r*e.fontMatrix[0];let Q=0;for(const rt of i){if(rt===null){Q+=E*o;continue}else if(typeof rt=="number"){Q+=B*rt*r/1e3;continue}const O=(rt.isSpace?o:0)+T,l=rt.fontChar;let h,A,Y=rt.width;if(D){let k;const J=rt.vmetric||z;k=rt.vmetric?J[1]:Y*.5,k=-k*M;const at=J[2]*M;Y=J?-J[0]:Y,h=k/d,A=(Q+at)/d}else h=Q/d,A=0;(rt.isInFont||n.missingFile)&&(e.xcoords.push(e.x+h),D&&e.ycoords.push(-e.y+A),e.tspan.textContent+=l);const K=D?Y*M-O*E:Y*M+O*E;Q+=K}e.tspan.setAttributeNS(null,"x",e.xcoords.map(c).join(" ")),D?e.tspan.setAttributeNS(null,"y",e.ycoords.map(c).join(" ")):e.tspan.setAttributeNS(null,"y",c(-e.y)),D?e.y-=Q:e.x+=Q*W,e.tspan.setAttributeNS(null,"font-family",e.fontFamily),e.tspan.setAttributeNS(null,"font-size",`${c(e.fontSize)}px`),e.fontStyle!==bt.fontStyle&&e.tspan.setAttributeNS(null,"font-style",e.fontStyle),e.fontWeight!==bt.fontWeight&&e.tspan.setAttributeNS(null,"font-weight",e.fontWeight);const y=e.textRenderingMode&G.TextRenderingMode.FILL_STROKE_MASK;if(y===G.TextRenderingMode.FILL||y===G.TextRenderingMode.FILL_STROKE?(e.fillColor!==bt.fillColor&&e.tspan.setAttributeNS(null,"fill",e.fillColor),e.fillAlpha<1&&e.tspan.setAttributeNS(null,"fill-opacity",e.fillAlpha)):e.textRenderingMode===G.TextRenderingMode.ADD_TO_PATH?e.tspan.setAttributeNS(null,"fill","transparent"):e.tspan.setAttributeNS(null,"fill","none"),y===G.TextRenderingMode.STROKE||y===G.TextRenderingMode.FILL_STROKE){const rt=1/(e.textMatrixScale||1);this._setStrokeAttributes(e.tspan,rt)}let C=e.textMatrix;e.textRise!==0&&(C=C.slice(),C[5]+=e.textRise),e.txtElement.setAttributeNS(null,"transform",`${v(C)} scale(${c(W)}, -1)`),e.txtElement.setAttributeNS(et,"xml:space","preserve"),e.txtElement.append(e.tspan),e.txtgrp.append(e.txtElement),this._ensureTransformGroup().append(e.txtElement)}setLeadingMoveText(i,e){this.setLeading(-e),this.moveText(i,e)}addFontStyle(i){if(!i.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const e=a(i.data,i.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${i.loadedName}"; src: url(${e}); }
`}setFont(i){const e=this.current,n=this.commonObjs.get(i[0]);let r=i[1];e.font=n,this.embedFonts&&!n.missingFile&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),e.fontMatrix=n.fontMatrix||G.FONT_IDENTITY_MATRIX;let d="normal";n.black?d="900":n.bold&&(d="bold");const T=n.italic?"italic":"normal";r<0?(r=-r,e.fontDirection=-1):e.fontDirection=1,e.fontSize=r,e.fontFamily=n.loadedName,e.fontWeight=d,e.fontStyle=T,e.tspan=this.svgFactory.createElement("svg:tspan"),e.tspan.setAttributeNS(null,"y",c(-e.y)),e.xcoords=[],e.ycoords=[]}endText(){var e;const i=this.current;i.textRenderingMode&G.TextRenderingMode.ADD_TO_PATH_FLAG&&((e=i.txtElement)!=null&&e.hasChildNodes())&&(i.element=i.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(i){i>0&&(this.current.lineWidth=i)}setLineCap(i){this.current.lineCap=R[i]}setLineJoin(i){this.current.lineJoin=f[i]}setMiterLimit(i){this.current.miterLimit=i}setStrokeAlpha(i){this.current.strokeAlpha=i}setStrokeRGBColor(i,e,n){this.current.strokeColor=G.Util.makeHexColor(i,e,n)}setFillAlpha(i){this.current.fillAlpha=i}setFillRGBColor(i,e,n){this.current.fillColor=G.Util.makeHexColor(i,e,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(i){this.current.strokeColor=this._makeColorN_Pattern(i)}setFillColorN(i){this.current.fillColor=this._makeColorN_Pattern(i)}shadingFill(i){const{width:e,height:n}=this.viewport,r=G.Util.inverseTransform(this.transformMatrix),[d,T,o,E]=G.Util.getAxialAlignedBoundingBox([0,0,e,n],r),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x",d),W.setAttributeNS(null,"y",T),W.setAttributeNS(null,"width",o-d),W.setAttributeNS(null,"height",E-T),W.setAttributeNS(null,"fill",this._makeShadingPattern(i)),this.current.fillAlpha<1&&W.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(W)}_makeColorN_Pattern(i){return i[0]==="TilingPattern"?this._makeTilingPattern(i):this._makeShadingPattern(i)}_makeTilingPattern(i){const e=i[1],n=i[2],r=i[3]||G.IDENTITY_MATRIX,[d,T,o,E]=i[4],W=i[5],D=i[6],B=i[7],z=`shading${u++}`,[M,Q,y,C]=G.Util.normalizeRect([...G.Util.applyTransform([d,T],r),...G.Util.applyTransform([o,E],r)]),[rt,O]=G.Util.singularValueDecompose2dScale(r),l=W*rt,h=D*O,A=this.svgFactory.createElement("svg:pattern");A.setAttributeNS(null,"id",z),A.setAttributeNS(null,"patternUnits","userSpaceOnUse"),A.setAttributeNS(null,"width",l),A.setAttributeNS(null,"height",h),A.setAttributeNS(null,"x",`${M}`),A.setAttributeNS(null,"y",`${Q}`);const Y=this.svg,K=this.transformMatrix,k=this.current.fillColor,J=this.current.strokeColor,at=this.svgFactory.create(y-M,C-Q);if(this.svg=at,this.transformMatrix=r,B===2){const ft=G.Util.makeHexColor(...e);this.current.fillColor=ft,this.current.strokeColor=ft}return this.executeOpTree(this.convertOpList(n)),this.svg=Y,this.transformMatrix=K,this.current.fillColor=k,this.current.strokeColor=J,A.append(at.childNodes[0]),this.defs.append(A),`url(#${z})`}_makeShadingPattern(i){switch(typeof i=="string"&&(i=this.objs.get(i)),i[0]){case"RadialAxial":const e=`shading${u++}`,n=i[3];let r;switch(i[1]){case"axial":const d=i[4],T=i[5];r=this.svgFactory.createElement("svg:linearGradient"),r.setAttributeNS(null,"id",e),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"x1",d[0]),r.setAttributeNS(null,"y1",d[1]),r.setAttributeNS(null,"x2",T[0]),r.setAttributeNS(null,"y2",T[1]);break;case"radial":const o=i[4],E=i[5],W=i[6],D=i[7];r=this.svgFactory.createElement("svg:radialGradient"),r.setAttributeNS(null,"id",e),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"cx",E[0]),r.setAttributeNS(null,"cy",E[1]),r.setAttributeNS(null,"r",D),r.setAttributeNS(null,"fx",o[0]),r.setAttributeNS(null,"fy",o[1]),r.setAttributeNS(null,"fr",W);break;default:throw new Error(`Unknown RadialAxial type: ${i[1]}`)}for(const d of n){const T=this.svgFactory.createElement("svg:stop");T.setAttributeNS(null,"offset",d[0]),T.setAttributeNS(null,"stop-color",d[1]),r.append(T)}return this.defs.append(r),`url(#${e})`;case"Mesh":return(0,G.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${i[0]}`)}}setDash(i,e){this.current.dashArray=i,this.current.dashPhase=e}constructPath(i,e){const n=this.current;let r=n.x,d=n.y,T=[],o=0;for(const E of i)switch(E|0){case G.OPS.rectangle:r=e[o++],d=e[o++];const W=e[o++],D=e[o++],B=r+W,z=d+D;T.push("M",c(r),c(d),"L",c(B),c(d),"L",c(B),c(z),"L",c(r),c(z),"Z");break;case G.OPS.moveTo:r=e[o++],d=e[o++],T.push("M",c(r),c(d));break;case G.OPS.lineTo:r=e[o++],d=e[o++],T.push("L",c(r),c(d));break;case G.OPS.curveTo:r=e[o+4],d=e[o+5],T.push("C",c(e[o]),c(e[o+1]),c(e[o+2]),c(e[o+3]),c(r),c(d)),o+=6;break;case G.OPS.curveTo2:T.push("C",c(r),c(d),c(e[o]),c(e[o+1]),c(e[o+2]),c(e[o+3])),r=e[o+2],d=e[o+3],o+=4;break;case G.OPS.curveTo3:r=e[o+2],d=e[o+3],T.push("C",c(e[o]),c(e[o+1]),c(r),c(d),c(r),c(d)),o+=4;break;case G.OPS.closePath:T.push("Z");break}T=T.join(" "),n.path&&i.length>0&&i[0]!==G.OPS.rectangle&&i[0]!==G.OPS.moveTo?T=n.path.getAttributeNS(null,"d")+T:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",T),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(r,d)}endPath(){const i=this.current;if(i.path=null,!this.pendingClip)return;if(!i.element){this.pendingClip=null;return}const e=`clippath${b++}`,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",e),n.setAttributeNS(null,"transform",v(this.transformMatrix));const r=i.element.cloneNode(!0);if(this.pendingClip==="evenodd"?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(r),this.defs.append(n),i.activeClipUrl){i.clipGroup=null;for(const d of this.extraStack)d.clipGroup=null;n.setAttributeNS(null,"clip-path",i.activeClipUrl)}i.activeClipUrl=`url(#${e})`,this.tgrp=null}clip(i){this.pendingClip=i}closePath(){const i=this.current;if(i.path){const e=`${i.path.getAttributeNS(null,"d")}Z`;i.path.setAttributeNS(null,"d",e)}}setLeading(i){this.current.leading=-i}setTextRise(i){this.current.textRise=i}setTextRenderingMode(i){this.current.textRenderingMode=i}setHScale(i){this.current.textHScale=i/100}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[e,n]of i)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,G.warn)(`Unimplemented graphic state operator ${e}`);break}}fill(){const i=this.current;i.element&&(i.element.setAttributeNS(null,"fill",i.fillColor),i.element.setAttributeNS(null,"fill-opacity",i.fillAlpha),this.endPath())}stroke(){const i=this.current;i.element&&(this._setStrokeAttributes(i.element),i.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(i,e=1){const n=this.current;let r=n.dashArray;e!==1&&r.length>0&&(r=r.map(function(d){return e*d})),i.setAttributeNS(null,"stroke",n.strokeColor),i.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),i.setAttributeNS(null,"stroke-miterlimit",c(n.miterLimit)),i.setAttributeNS(null,"stroke-linecap",n.lineCap),i.setAttributeNS(null,"stroke-linejoin",n.lineJoin),i.setAttributeNS(null,"stroke-width",c(e*n.lineWidth)+"px"),i.setAttributeNS(null,"stroke-dasharray",r.map(c).join(" ")),i.setAttributeNS(null,"stroke-dashoffset",c(e*n.dashPhase)+"px")}eoFill(){var i;(i=this.current.element)==null||i.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var i;(i=this.current.element)==null||i.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width","1px"),i.setAttributeNS(null,"height","1px"),i.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(i)}paintImageXObject(i){const e=this.getObject(i);if(!e){(0,G.warn)(`Dependent image with object ID ${i} is not ready yet`);return}this.paintInlineImageXObject(e)}paintInlineImageXObject(i,e){const n=i.width,r=i.height,d=N(i,this.forceDataSchema,!!e),T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",c(n)),T.setAttributeNS(null,"height",c(r)),this.current.element=T,this.clip("nonzero");const o=this.svgFactory.createElement("svg:image");o.setAttributeNS(V,"xlink:href",d),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",c(-r)),o.setAttributeNS(null,"width",c(n)+"px"),o.setAttributeNS(null,"height",c(r)+"px"),o.setAttributeNS(null,"transform",`scale(${c(1/n)} ${c(-1/r)})`),e?e.append(o):this._ensureTransformGroup().append(o)}paintImageMaskXObject(i){const e=this.getObject(i.data,i);if(e.bitmap){(0,G.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const n=this.current,r=e.width,d=e.height,T=n.fillColor;n.maskId=`mask${m++}`;const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",n.maskId);const E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",c(r)),E.setAttributeNS(null,"height",c(d)),E.setAttributeNS(null,"fill",T),E.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(o),this._ensureTransformGroup().append(E),this.paintInlineImageXObject(e,o)}paintFormXObjectBegin(i,e){if(Array.isArray(i)&&i.length===6&&this.transform(i[0],i[1],i[2],i[3],i[4],i[5]),e){const n=e[2]-e[0],r=e[3]-e[1],d=this.svgFactory.createElement("svg:rect");d.setAttributeNS(null,"x",e[0]),d.setAttributeNS(null,"y",e[1]),d.setAttributeNS(null,"width",c(n)),d.setAttributeNS(null,"height",c(r)),this.current.element=d,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(i){const e=this.svgFactory.create(i.width,i.height),n=this.svgFactory.createElement("svg:defs");e.append(n),this.defs=n;const r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",v(i.transform)),e.append(r),this.svg=r,e}_ensureClipGroup(){if(!this.current.clipGroup){const i=this.svgFactory.createElement("svg:g");i.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(i),this.current.clipGroup=i}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}L.SVGGraphics=_},(Ct,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.XfaText=void 0;class mt{static textContent(G){const bt=[],et={items:bt,styles:Object.create(null)};function V(R){var N;if(!R)return;let f=null;const a=R.name;if(a==="#text")f=R.value;else if(mt.shouldBuildText(a))(N=R==null?void 0:R.attributes)!=null&&N.textContent?f=R.attributes.textContent:R.value&&(f=R.value);else return;if(f!==null&&bt.push({str:f}),!!R.children)for(const x of R.children)V(x)}return V(G),et}static shouldBuildText(G){return!(G==="textarea"||G==="input"||G==="option"||G==="select")}}L.XfaText=mt},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.TextLayerRenderTask=void 0,L.renderTextLayer=v,L.updateTextLayer=b;var S=mt(1),G=mt(6);const bt=1e5,et=30,V=.8,R=new Map;function f(m,u){let _;if(u&&S.FeatureTest.isOffscreenCanvasSupported)_=new OffscreenCanvas(m,m).getContext("2d",{alpha:!1});else{const g=document.createElement("canvas");g.width=g.height=m,_=g.getContext("2d",{alpha:!1})}return _}function a(m,u){const _=R.get(m);if(_)return _;const g=f(et,u);g.font=`${et}px ${m}`;const i=g.measureText("");let e=i.fontBoundingBoxAscent,n=Math.abs(i.fontBoundingBoxDescent);if(e){const d=e/(e+n);return R.set(m,d),g.canvas.width=g.canvas.height=0,d}g.strokeStyle="red",g.clearRect(0,0,et,et),g.strokeText("g",0,0);let r=g.getImageData(0,0,et,et).data;n=0;for(let d=r.length-1-3;d>=0;d-=4)if(r[d]>0){n=Math.ceil(d/4/et);break}g.clearRect(0,0,et,et),g.strokeText("A",0,et),r=g.getImageData(0,0,et,et).data,e=0;for(let d=0,T=r.length;d<T;d+=4)if(r[d]>0){e=et-Math.floor(d/4/et);break}if(g.canvas.width=g.canvas.height=0,e){const d=e/(e+n);return R.set(m,d),d}return R.set(m,V),V}function N(m,u,_){const g=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:u.str!=="",hasEOL:u.hasEOL,fontSize:0};m._textDivs.push(g);const e=S.Util.transform(m._transform,u.transform);let n=Math.atan2(e[1],e[0]);const r=_[u.fontName];r.vertical&&(n+=Math.PI/2);const d=Math.hypot(e[2],e[3]),T=d*a(r.fontFamily,m._isOffscreenCanvasSupported);let o,E;n===0?(o=e[4],E=e[5]-T):(o=e[4]+T*Math.sin(n),E=e[5]-T*Math.cos(n));const W="calc(var(--scale-factor)*",D=g.style;m._container===m._rootContainer?(D.left=`${(100*o/m._pageWidth).toFixed(2)}%`,D.top=`${(100*E/m._pageHeight).toFixed(2)}%`):(D.left=`${W}${o.toFixed(2)}px)`,D.top=`${W}${E.toFixed(2)}px)`),D.fontSize=`${W}${d.toFixed(2)}px)`,D.fontFamily=r.fontFamily,i.fontSize=d,g.setAttribute("role","presentation"),g.textContent=u.str,g.dir=u.dir,m._fontInspectorEnabled&&(g.dataset.fontName=u.fontName),n!==0&&(i.angle=n*(180/Math.PI));let B=!1;if(u.str.length>1)B=!0;else if(u.str!==" "&&u.transform[0]!==u.transform[3]){const z=Math.abs(u.transform[0]),M=Math.abs(u.transform[3]);z!==M&&Math.max(z,M)/Math.min(z,M)>1.5&&(B=!0)}B&&(i.canvasWidth=r.vertical?u.height:u.width),m._textDivProperties.set(g,i),m._isReadableStream&&m._layoutText(g)}function x(m){const{div:u,scale:_,properties:g,ctx:i,prevFontSize:e,prevFontFamily:n}=m,{style:r}=u;let d="";if(g.canvasWidth!==0&&g.hasText){const{fontFamily:T}=r,{canvasWidth:o,fontSize:E}=g;(e!==E||n!==T)&&(i.font=`${E*_}px ${T}`,m.prevFontSize=E,m.prevFontFamily=T);const{width:W}=i.measureText(u.textContent);W>0&&(d=`scaleX(${o*_/W})`)}g.angle!==0&&(d=`rotate(${g.angle}deg) ${d}`),d.length>0&&(r.transform=d)}function p(m){if(m._canceled)return;const u=m._textDivs,_=m._capability;if(u.length>bt){_.resolve();return}if(!m._isReadableStream)for(const i of u)m._layoutText(i);_.resolve()}class c{constructor({textContentSource:u,container:_,viewport:g,textDivs:i,textDivProperties:e,textContentItemsStr:n,isOffscreenCanvasSupported:r}){var W;this._textContentSource=u,this._isReadableStream=u instanceof ReadableStream,this._container=this._rootContainer=_,this._textDivs=i||[],this._textContentItemsStr=n||[],this._isOffscreenCanvasSupported=r,this._fontInspectorEnabled=!!((W=globalThis.FontInspector)!=null&&W.enabled),this._reader=null,this._textDivProperties=e||new WeakMap,this._canceled=!1,this._capability=new S.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:g.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f(0,r)};const{pageWidth:d,pageHeight:T,pageX:o,pageY:E}=g.rawDims;this._transform=[1,0,0,-1,-o,E+T],this._pageWidth=d,this._pageHeight=T,(0,G.setLayerDimensions)(_,g),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new S.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new S.AbortException("TextLayer task cancelled."))}_processItems(u,_){for(const g of u){if(g.str===void 0){if(g.type==="beginMarkedContentProps"||g.type==="beginMarkedContent"){const i=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),g.id!==null&&this._container.setAttribute("id",`${g.id}`),i.append(this._container)}else g.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(g.str),N(this,g,_)}}_layoutText(u){const _=this._layoutTextParams.properties=this._textDivProperties.get(u);if(this._layoutTextParams.div=u,x(this._layoutTextParams),_.hasText&&this._container.append(u),_.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.append(g)}}_render(){const u=new S.PromiseCapability;let _=Object.create(null);if(this._isReadableStream){const g=()=>{this._reader.read().then(({value:i,done:e})=>{if(e){u.resolve();return}Object.assign(_,i.styles),this._processItems(i.items,_),g()},u.reject)};this._reader=this._textContentSource.getReader(),g()}else if(this._textContentSource){const{items:g,styles:i}=this._textContentSource;this._processItems(g,i),u.resolve()}else throw new Error('No "textContentSource" parameter specified.');u.promise.then(()=>{_=null,p(this)},this._capability.reject)}}L.TextLayerRenderTask=c;function v(m){!m.textContentSource&&(m.textContent||m.textContentStream)&&((0,G.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),m.textContentSource=m.textContent||m.textContentStream);const{container:u,viewport:_}=m,g=getComputedStyle(u),i=g.getPropertyValue("visibility"),e=parseFloat(g.getPropertyValue("--scale-factor"));i==="visible"&&(!e||Math.abs(e-_.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const n=new c(m);return n._render(),n}function b({container:m,viewport:u,textDivs:_,textDivProperties:g,isOffscreenCanvasSupported:i,mustRotate:e=!0,mustRescale:n=!0}){if(e&&(0,G.setLayerDimensions)(m,{rotation:u.rotation}),n){const r=f(0,i),T={prevFontSize:null,prevFontFamily:null,div:null,scale:u.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:r};for(const o of _)T.properties=g.get(o),T.div=o,x(T)}}},(Ct,L,mt)=>{var a,N,x,p,c,v,b,m,u,_,g,li,Le,ci,hi;Object.defineProperty(L,"__esModule",{value:!0}),L.AnnotationEditorLayer=void 0;var S=mt(1),G=mt(4),bt=mt(28),et=mt(33),V=mt(6),R=mt(34);const d=class d{constructor({uiManager:o,pageIndex:E,div:W,accessibilityManager:D,annotationLayer:B,viewport:z,l10n:M}){tt(this,g);tt(this,a);tt(this,N,!1);tt(this,x,null);tt(this,p,this.pointerup.bind(this));tt(this,c,this.pointerdown.bind(this));tt(this,v,new Map);tt(this,b,!1);tt(this,m,!1);tt(this,u,!1);tt(this,_);const Q=[bt.FreeTextEditor,et.InkEditor,R.StampEditor];if(!d._initialized){d._initialized=!0;for(const y of Q)y.initialize(M)}o.registerEditorTypes(Q),Z(this,_,o),this.pageIndex=E,this.div=W,Z(this,a,D),Z(this,x,B),this.viewport=z,t(this,_).addLayer(this)}get isEmpty(){return t(this,v).size===0}updateToolbar(o){t(this,_).updateToolbar(o)}updateMode(o=t(this,_).getMode()){j(this,g,hi).call(this),o===S.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),o!==S.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",o===S.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",o===S.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",o===S.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(o){if(!o&&t(this,_).getMode()!==S.AnnotationEditorType.INK)return;if(!o){for(const W of t(this,v).values())if(W.isEmpty()){W.setInBackground();return}}j(this,g,Le).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(o){t(this,_).setEditingState(o)}addCommands(o){t(this,_).addCommands(o)}enable(){this.div.style.pointerEvents="auto";const o=new Set;for(const W of t(this,v).values())W.enableEditing(),W.annotationElementId&&o.add(W.annotationElementId);if(!t(this,x))return;const E=t(this,x).getEditableAnnotations();for(const W of E){if(W.hide(),t(this,_).isDeletedAnnotationElement(W.data.id)||o.has(W.data.id))continue;const D=this.deserialize(W);D&&(this.addOrRebuild(D),D.enableEditing())}}disable(){var E;Z(this,u,!0),this.div.style.pointerEvents="none";const o=new Set;for(const W of t(this,v).values()){if(W.disableEditing(),!W.annotationElementId||W.serialize()!==null){o.add(W.annotationElementId);continue}(E=this.getEditableAnnotation(W.annotationElementId))==null||E.show(),W.remove()}if(t(this,x)){const W=t(this,x).getEditableAnnotations();for(const D of W){const{id:B}=D.data;o.has(B)||t(this,_).isDeletedAnnotationElement(B)||D.show()}}j(this,g,hi).call(this),this.isEmpty&&(this.div.hidden=!0),Z(this,u,!1)}getEditableAnnotation(o){var E;return((E=t(this,x))==null?void 0:E.getEditableAnnotation(o))||null}setActiveEditor(o){t(this,_).getActive()!==o&&t(this,_).setActiveEditor(o)}enableClick(){this.div.addEventListener("pointerdown",t(this,c)),this.div.addEventListener("pointerup",t(this,p))}disableClick(){this.div.removeEventListener("pointerdown",t(this,c)),this.div.removeEventListener("pointerup",t(this,p))}attach(o){t(this,v).set(o.id,o);const{annotationElementId:E}=o;E&&t(this,_).isDeletedAnnotationElement(E)&&t(this,_).removeDeletedAnnotationElement(o)}detach(o){var E;t(this,v).delete(o.id),(E=t(this,a))==null||E.removePointerInTextLayer(o.contentDiv),!t(this,u)&&o.annotationElementId&&t(this,_).addDeletedAnnotationElement(o)}remove(o){this.detach(o),t(this,_).removeEditor(o),o.div.contains(document.activeElement)&&setTimeout(()=>{t(this,_).focusMainContainer()},0),o.div.remove(),o.isAttachedToDOM=!1,t(this,m)||this.addInkEditorIfNeeded(!1)}changeParent(o){var E;o.parent!==this&&(o.annotationElementId&&(t(this,_).addDeletedAnnotationElement(o.annotationElementId),G.AnnotationEditor.deleteAnnotationElement(o),o.annotationElementId=null),this.attach(o),(E=o.parent)==null||E.detach(o),o.setParent(this),o.div&&o.isAttachedToDOM&&(o.div.remove(),this.div.append(o.div)))}add(o){if(this.changeParent(o),t(this,_).addEditor(o),this.attach(o),!o.isAttachedToDOM){const E=o.render();this.div.append(E),o.isAttachedToDOM=!0}o.fixAndSetPosition(),o.onceAdded(),t(this,_).addToAnnotationStorage(o)}moveEditorInDOM(o){var W;if(!o.isAttachedToDOM)return;const{activeElement:E}=document;o.div.contains(E)&&(o._focusEventsAllowed=!1,setTimeout(()=>{o.div.contains(document.activeElement)?o._focusEventsAllowed=!0:(o.div.addEventListener("focusin",()=>{o._focusEventsAllowed=!0},{once:!0}),E.focus())},0)),o._structTreeParentId=(W=t(this,a))==null?void 0:W.moveElementInDOM(this.div,o.div,o.contentDiv,!0)}addOrRebuild(o){o.needsToBeRebuilt()?o.rebuild():this.add(o)}addUndoableEditor(o){const E=()=>o._uiManager.rebuild(o),W=()=>{o.remove()};this.addCommands({cmd:E,undo:W,mustExec:!1})}getNextId(){return t(this,_).getId()}pasteEditor(o,E){t(this,_).updateToolbar(o),t(this,_).updateMode(o);const{offsetX:W,offsetY:D}=j(this,g,ci).call(this),B=this.getNextId(),z=j(this,g,li).call(this,{parent:this,id:B,x:W,y:D,uiManager:t(this,_),isCentered:!0,...E});z&&this.add(z)}deserialize(o){switch(o.annotationType??o.annotationEditorType){case S.AnnotationEditorType.FREETEXT:return bt.FreeTextEditor.deserialize(o,this,t(this,_));case S.AnnotationEditorType.INK:return et.InkEditor.deserialize(o,this,t(this,_));case S.AnnotationEditorType.STAMP:return R.StampEditor.deserialize(o,this,t(this,_))}return null}addNewEditor(){j(this,g,Le).call(this,j(this,g,ci).call(this),!0)}setSelected(o){t(this,_).setSelected(o)}toggleSelected(o){t(this,_).toggleSelected(o)}isSelected(o){return t(this,_).isSelected(o)}unselect(o){t(this,_).unselect(o)}pointerup(o){const{isMac:E}=S.FeatureTest.platform;if(!(o.button!==0||o.ctrlKey&&E)&&o.target===this.div&&t(this,b)){if(Z(this,b,!1),!t(this,N)){Z(this,N,!0);return}if(t(this,_).getMode()===S.AnnotationEditorType.STAMP){t(this,_).unselectAll();return}j(this,g,Le).call(this,o,!1)}}pointerdown(o){if(t(this,b)){Z(this,b,!1);return}const{isMac:E}=S.FeatureTest.platform;if(o.button!==0||o.ctrlKey&&E||o.target!==this.div)return;Z(this,b,!0);const W=t(this,_).getActive();Z(this,N,!W||W.isEmpty())}findNewParent(o,E,W){const D=t(this,_).findParent(E,W);return D===null||D===this?!1:(D.changeParent(o),!0)}destroy(){var o,E;((o=t(this,_).getActive())==null?void 0:o.parent)===this&&(t(this,_).commitOrRemove(),t(this,_).setActiveEditor(null));for(const W of t(this,v).values())(E=t(this,a))==null||E.removePointerInTextLayer(W.contentDiv),W.setParent(null),W.isAttachedToDOM=!1,W.div.remove();this.div=null,t(this,v).clear(),t(this,_).removeLayer(this)}render({viewport:o}){this.viewport=o,(0,V.setLayerDimensions)(this.div,o);for(const E of t(this,_).getEditors(this.pageIndex))this.add(E);this.updateMode()}update({viewport:o}){t(this,_).commitOrRemove(),this.viewport=o,(0,V.setLayerDimensions)(this.div,{rotation:o.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:o,pageHeight:E}=this.viewport.rawDims;return[o,E]}};a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap,u=new WeakMap,_=new WeakMap,g=new WeakSet,li=function(o){switch(t(this,_).getMode()){case S.AnnotationEditorType.FREETEXT:return new bt.FreeTextEditor(o);case S.AnnotationEditorType.INK:return new et.InkEditor(o);case S.AnnotationEditorType.STAMP:return new R.StampEditor(o)}return null},Le=function(o,E){const W=this.getNextId(),D=j(this,g,li).call(this,{parent:this,id:W,x:o.offsetX,y:o.offsetY,uiManager:t(this,_),isCentered:E});return D&&this.add(D),D},ci=function(){const{x:o,y:E,width:W,height:D}=this.div.getBoundingClientRect(),B=Math.max(0,o),z=Math.max(0,E),M=Math.min(window.innerWidth,o+W),Q=Math.min(window.innerHeight,E+D),y=(B+M)/2-o,C=(z+Q)/2-E,[rt,O]=this.viewport.rotation%180===0?[y,C]:[C,y];return{offsetX:rt,offsetY:O}},hi=function(){Z(this,m,!0);for(const o of t(this,v).values())o.isEmpty()&&o.remove();Z(this,m,!1)},Kt(d,"_initialized",!1);let f=d;L.AnnotationEditorLayer=f},(Ct,L,mt)=>{var R,f,a,N,x,p,c,v,b,m,on,ln,cn,_e,di,hn,ui;Object.defineProperty(L,"__esModule",{value:!0}),L.FreeTextEditor=void 0;var S=mt(1),G=mt(5),bt=mt(4),et=mt(29);const d=class d extends bt.AnnotationEditor{constructor(E){super({...E,name:"freeTextEditor"});tt(this,m);tt(this,R,this.editorDivBlur.bind(this));tt(this,f,this.editorDivFocus.bind(this));tt(this,a,this.editorDivInput.bind(this));tt(this,N,this.editorDivKeydown.bind(this));tt(this,x);tt(this,p,"");tt(this,c,`${this.id}-editor`);tt(this,v);tt(this,b,null);Z(this,x,E.color||d._defaultColor||bt.AnnotationEditor._defaultLineColor),Z(this,v,E.fontSize||d._defaultFontSize)}static get _keyboardManager(){const E=d.prototype,W=z=>z.isEmpty(),D=G.AnnotationEditorUIManager.TRANSLATE_SMALL,B=G.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,S.shadow)(this,"_keyboardManager",new G.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],E.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],E.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],E._translateEmpty,{args:[-D,0],checker:W}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],E._translateEmpty,{args:[-B,0],checker:W}],[["ArrowRight","mac+ArrowRight"],E._translateEmpty,{args:[D,0],checker:W}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],E._translateEmpty,{args:[B,0],checker:W}],[["ArrowUp","mac+ArrowUp"],E._translateEmpty,{args:[0,-D],checker:W}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],E._translateEmpty,{args:[0,-B],checker:W}],[["ArrowDown","mac+ArrowDown"],E._translateEmpty,{args:[0,D],checker:W}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],E._translateEmpty,{args:[0,B],checker:W}]]))}static initialize(E){bt.AnnotationEditor.initialize(E,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const W=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(W.getPropertyValue("--freetext-padding"))}static updateDefaultParams(E,W){switch(E){case S.AnnotationEditorParamsType.FREETEXT_SIZE:d._defaultFontSize=W;break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:d._defaultColor=W;break}}updateParams(E,W){switch(E){case S.AnnotationEditorParamsType.FREETEXT_SIZE:j(this,m,on).call(this,W);break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:j(this,m,ln).call(this,W);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,d._defaultFontSize],[S.AnnotationEditorParamsType.FREETEXT_COLOR,d._defaultColor||bt.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,v)],[S.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,x)]]}_translateEmpty(E,W){this._uiManager.translateSelectedEditors(E,W,!0)}getInitialTranslation(){const E=this.parentScale;return[-d._internalPadding*E,-(d._internalPadding+t(this,v))*E]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(S.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,N)),this.editorDiv.addEventListener("focus",t(this,f)),this.editorDiv.addEventListener("blur",t(this,R)),this.editorDiv.addEventListener("input",t(this,a)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,c)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,N)),this.editorDiv.removeEventListener("focus",t(this,f)),this.editorDiv.removeEventListener("blur",t(this,R)),this.editorDiv.removeEventListener("input",t(this,a)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(E){this._focusEventsAllowed&&(super.focusin(E),E.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var E;if(this.width){j(this,m,ui).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(E=this._initialOptions)!=null&&E.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const E=t(this,p),W=Z(this,p,j(this,m,cn).call(this).trimEnd());if(E===W)return;const D=B=>{if(Z(this,p,B),!B){this.remove();return}j(this,m,di).call(this),this._uiManager.rebuild(this),j(this,m,_e).call(this)};this.addCommands({cmd:()=>{D(W)},undo:()=>{D(E)},mustExec:!1}),j(this,m,_e).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(E){this.enterInEditMode()}keydown(E){E.target===this.div&&E.key==="Enter"&&(this.enterInEditMode(),E.preventDefault())}editorDivKeydown(E){d._keyboardManager.exec(this,E)}editorDivFocus(E){this.isEditing=!0}editorDivBlur(E){this.isEditing=!1}editorDivInput(E){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let E,W;this.width&&(E=this.x,W=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,c)),this.enableEditing(),bt.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(B=>{var z;return(z=this.editorDiv)==null?void 0:z.setAttribute("aria-label",B)}),bt.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(B=>{var z;return(z=this.editorDiv)==null?void 0:z.setAttribute("default-content",B)}),this.editorDiv.contentEditable=!0;const{style:D}=this.editorDiv;if(D.fontSize=`calc(${t(this,v)}px * var(--scale-factor))`,D.color=t(this,x),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,G.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[B,z]=this.parentDimensions;if(this.annotationElementId){const{position:M}=t(this,b);let[Q,y]=this.getInitialTranslation();[Q,y]=this.pageTranslationToScreen(Q,y);const[C,rt]=this.pageDimensions,[O,l]=this.pageTranslation;let h,A;switch(this.rotation){case 0:h=E+(M[0]-O)/C,A=W+this.height-(M[1]-l)/rt;break;case 90:h=E+(M[0]-O)/C,A=W-(M[1]-l)/rt,[Q,y]=[y,-Q];break;case 180:h=E-this.width+(M[0]-O)/C,A=W-(M[1]-l)/rt,[Q,y]=[-Q,-y];break;case 270:h=E+(M[0]-O-this.height*rt)/C,A=W+(M[1]-l-this.width*C)/rt,[Q,y]=[-y,Q];break}this.setAt(h*B,A*z,Q,y)}else this.setAt(E*B,W*z,this.width*B,this.height*z);j(this,m,di).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(E,W,D){let B=null;if(E instanceof et.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:M,fontColor:Q},rect:y,rotation:C,id:rt},textContent:O,textPosition:l,parent:{page:{pageNumber:h}}}=E;if(!O||O.length===0)return null;B=E={annotationType:S.AnnotationEditorType.FREETEXT,color:Array.from(Q),fontSize:M,value:O.join(`
`),position:l,pageIndex:h-1,rect:y,rotation:C,id:rt,deleted:!1}}const z=super.deserialize(E,W,D);return Z(z,v,E.fontSize),Z(z,x,S.Util.makeHexColor(...E.color)),Z(z,p,E.value),z.annotationElementId=E.id||null,Z(z,b,B),z}serialize(E=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const W=d._internalPadding*this.parentScale,D=this.getRect(W,W),B=bt.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,x)),z={annotationType:S.AnnotationEditorType.FREETEXT,color:B,fontSize:t(this,v),value:t(this,p),pageIndex:this.pageIndex,rect:D,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return E?z:this.annotationElementId&&!j(this,m,hn).call(this,z)?null:(z.id=this.annotationElementId,z)}};R=new WeakMap,f=new WeakMap,a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakSet,on=function(E){const W=B=>{this.editorDiv.style.fontSize=`calc(${B}px * var(--scale-factor))`,this.translate(0,-(B-t(this,v))*this.parentScale),Z(this,v,B),j(this,m,_e).call(this)},D=t(this,v);this.addCommands({cmd:()=>{W(E)},undo:()=>{W(D)},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ln=function(E){const W=t(this,x);this.addCommands({cmd:()=>{Z(this,x,this.editorDiv.style.color=E)},undo:()=>{Z(this,x,this.editorDiv.style.color=W)},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},cn=function(){const E=this.editorDiv.getElementsByTagName("div");if(E.length===0)return this.editorDiv.innerText;const W=[];for(const D of E)W.push(D.innerText.replace(/\r\n?|\n/,""));return W.join(`
`)},_e=function(){const[E,W]=this.parentDimensions;let D;if(this.isAttachedToDOM)D=this.div.getBoundingClientRect();else{const{currentLayer:B,div:z}=this,M=z.style.display;z.style.display="hidden",B.div.append(this.div),D=z.getBoundingClientRect(),z.remove(),z.style.display=M}this.rotation%180===this.parentRotation%180?(this.width=D.width/E,this.height=D.height/W):(this.width=D.height/E,this.height=D.width/W),this.fixAndSetPosition()},di=function(){if(this.editorDiv.replaceChildren(),!!t(this,p))for(const E of t(this,p).split(`
`)){const W=document.createElement("div");W.append(E?document.createTextNode(E):document.createElement("br")),this.editorDiv.append(W)}},hn=function(E){const{value:W,fontSize:D,color:B,rect:z,pageIndex:M}=t(this,b);return E.value!==W||E.fontSize!==D||E.rect.some((Q,y)=>Math.abs(Q-z[y])>=1)||E.color.some((Q,y)=>Q!==B[y])||E.pageIndex!==M},ui=function(E=!1){if(!this.annotationElementId)return;if(j(this,m,_e).call(this),!E&&(this.width===0||this.height===0)){setTimeout(()=>j(this,m,ui).call(this,!0),0);return}const W=d._internalPadding*this.parentScale;t(this,b).rect=this.getRect(W,W)},Kt(d,"_freeTextDefaultContent",""),Kt(d,"_internalPadding",0),Kt(d,"_defaultColor",null),Kt(d,"_defaultFontSize",10),Kt(d,"_type","freetext");let V=d;L.FreeTextEditor=V},(Ct,L,mt)=>{var A,K,re,dn,at,ft,pt,vt,Et,Pt,ct,lt,I,q,nt,P,s,w,U,F,it,ot,un,Re,fi,pi,kt,jt,$t,St,ht,ut,Ft,gi,Ht,X,gt,Lt,fn,mi;Object.defineProperty(L,"__esModule",{value:!0}),L.StampAnnotationElement=L.InkAnnotationElement=L.FreeTextAnnotationElement=L.AnnotationLayer=void 0;var S=mt(1),G=mt(6),bt=mt(3),et=mt(30),V=mt(31),R=mt(32);const f=1e3,a=9,N=new WeakSet;function x(Rt){return{width:Rt[2]-Rt[0],height:Rt[3]-Rt[1]}}class p{static create($){switch($.data.annotationType){case S.AnnotationType.LINK:return new v($);case S.AnnotationType.TEXT:return new b($);case S.AnnotationType.WIDGET:switch($.data.fieldType){case"Tx":return new u($);case"Btn":return $.data.radioButton?new i($):$.data.checkBox?new g($):new e($);case"Ch":return new n($);case"Sig":return new _($)}return new m($);case S.AnnotationType.POPUP:return new r($);case S.AnnotationType.FREETEXT:return new T($);case S.AnnotationType.LINE:return new o($);case S.AnnotationType.SQUARE:return new E($);case S.AnnotationType.CIRCLE:return new W($);case S.AnnotationType.POLYLINE:return new D($);case S.AnnotationType.CARET:return new z($);case S.AnnotationType.INK:return new M($);case S.AnnotationType.POLYGON:return new B($);case S.AnnotationType.HIGHLIGHT:return new Q($);case S.AnnotationType.UNDERLINE:return new y($);case S.AnnotationType.SQUIGGLY:return new C($);case S.AnnotationType.STRIKEOUT:return new rt($);case S.AnnotationType.STAMP:return new O($);case S.AnnotationType.FILEATTACHMENT:return new l($);default:return new c($)}}}const Y=class Y{constructor($,{isRenderable:H=!1,ignoreBorder:st=!1,createQuadrilaterals:_t=!1}={}){tt(this,A,!1);this.isRenderable=H,this.data=$.data,this.layer=$.layer,this.linkService=$.linkService,this.downloadManager=$.downloadManager,this.imageResourcesPath=$.imageResourcesPath,this.renderForms=$.renderForms,this.svgFactory=$.svgFactory,this.annotationStorage=$.annotationStorage,this.enableScripting=$.enableScripting,this.hasJSActions=$.hasJSActions,this._fieldObjects=$.fieldObjects,this.parent=$.parent,H&&(this.container=this._createContainer(st)),_t&&this._createQuadrilaterals()}static _hasPopupData({titleObj:$,contentsObj:H,richText:st}){return!!($!=null&&$.str||H!=null&&H.str||st!=null&&st.str)}get hasPopupData(){return Y._hasPopupData(this.data)}_createContainer($){const{data:H,parent:{page:st,viewport:_t}}=this,yt=document.createElement("section");yt.setAttribute("data-annotation-id",H.id),this instanceof m||(yt.tabIndex=f),yt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&yt.setAttribute("aria-haspopup","dialog"),H.noRotate&&yt.classList.add("norotate");const{pageWidth:wt,pageHeight:Tt,pageX:Ut,pageY:Nt}=_t.rawDims;if(!H.rect||this instanceof r){const{rotation:zt}=H;return!H.hasOwnCanvas&&zt!==0&&this.setRotation(zt,yt),yt}const{width:It,height:Gt}=x(H.rect),Bt=S.Util.normalizeRect([H.rect[0],st.view[3]-H.rect[1]+st.view[1],H.rect[2],st.view[3]-H.rect[3]+st.view[1]]);if(!$&&H.borderStyle.width>0){yt.style.borderWidth=`${H.borderStyle.width}px`;const zt=H.borderStyle.horizontalCornerRadius,Xt=H.borderStyle.verticalCornerRadius;if(zt>0||Xt>0){const Yt=`calc(${zt}px * var(--scale-factor)) / calc(${Xt}px * var(--scale-factor))`;yt.style.borderRadius=Yt}else if(this instanceof i){const Yt=`calc(${It}px * var(--scale-factor)) / calc(${Gt}px * var(--scale-factor))`;yt.style.borderRadius=Yt}switch(H.borderStyle.style){case S.AnnotationBorderStyleType.SOLID:yt.style.borderStyle="solid";break;case S.AnnotationBorderStyleType.DASHED:yt.style.borderStyle="dashed";break;case S.AnnotationBorderStyleType.BEVELED:(0,S.warn)("Unimplemented border style: beveled");break;case S.AnnotationBorderStyleType.INSET:(0,S.warn)("Unimplemented border style: inset");break;case S.AnnotationBorderStyleType.UNDERLINE:yt.style.borderBottomStyle="solid";break}const qt=H.borderColor||null;qt?(Z(this,A,!0),yt.style.borderColor=S.Util.makeHexColor(qt[0]|0,qt[1]|0,qt[2]|0)):yt.style.borderWidth=0}yt.style.left=`${100*(Bt[0]-Ut)/wt}%`,yt.style.top=`${100*(Bt[1]-Nt)/Tt}%`;const{rotation:Vt}=H;return H.hasOwnCanvas||Vt===0?(yt.style.width=`${100*It/wt}%`,yt.style.height=`${100*Gt/Tt}%`):this.setRotation(Vt,yt),yt}setRotation($,H=this.container){if(!this.data.rect)return;const{pageWidth:st,pageHeight:_t}=this.parent.viewport.rawDims,{width:yt,height:wt}=x(this.data.rect);let Tt,Ut;$%180===0?(Tt=100*yt/st,Ut=100*wt/_t):(Tt=100*wt/st,Ut=100*yt/_t),H.style.width=`${Tt}%`,H.style.height=`${Ut}%`,H.setAttribute("data-main-rotation",(360-$)%360)}get _commonActions(){const $=(H,st,_t)=>{const yt=_t.detail[H],wt=yt[0],Tt=yt.slice(1);_t.target.style[st]=et.ColorConverters[`${wt}_HTML`](Tt),this.annotationStorage.setValue(this.data.id,{[st]:et.ColorConverters[`${wt}_rgb`](Tt)})};return(0,S.shadow)(this,"_commonActions",{display:H=>{const{display:st}=H.detail,_t=st%2===1;this.container.style.visibility=_t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:_t,noPrint:st===1||st===2})},print:H=>{this.annotationStorage.setValue(this.data.id,{noPrint:!H.detail.print})},hidden:H=>{const{hidden:st}=H.detail;this.container.style.visibility=st?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:st,noView:st})},focus:H=>{setTimeout(()=>H.target.focus({preventScroll:!1}),0)},userName:H=>{H.target.title=H.detail.userName},readonly:H=>{H.target.disabled=H.detail.readonly},required:H=>{this._setRequired(H.target,H.detail.required)},bgColor:H=>{$("bgColor","backgroundColor",H)},fillColor:H=>{$("fillColor","backgroundColor",H)},fgColor:H=>{$("fgColor","color",H)},textColor:H=>{$("textColor","color",H)},borderColor:H=>{$("borderColor","borderColor",H)},strokeColor:H=>{$("strokeColor","borderColor",H)},rotation:H=>{const st=H.detail.rotation;this.setRotation(st),this.annotationStorage.setValue(this.data.id,{rotation:st})}})}_dispatchEventFromSandbox($,H){const st=this._commonActions;for(const _t of Object.keys(H.detail)){const yt=$[_t]||st[_t];yt==null||yt(H)}}_setDefaultPropertiesFromJS($){if(!this.enableScripting)return;const H=this.annotationStorage.getRawValue(this.data.id);if(!H)return;const st=this._commonActions;for(const[_t,yt]of Object.entries(H)){const wt=st[_t];if(wt){const Tt={detail:{[_t]:yt},target:$};wt(Tt),delete H[_t]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:$}=this.data;if(!$)return;const[H,st,_t,yt]=this.data.rect;if($.length===1){const[,{x:Xt,y:qt},{x:Yt,y:Qt}]=$[0];if(_t===Xt&&yt===qt&&H===Yt&&st===Qt)return}const{style:wt}=this.container;let Tt;if(t(this,A)){const{borderColor:Xt,borderWidth:qt}=wt;wt.borderWidth=0,Tt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Xt}" stroke-width="${qt}">`],this.container.classList.add("hasBorder")}const Ut=_t-H,Nt=yt-st,{svgFactory:It}=this,Gt=It.createElement("svg");Gt.classList.add("quadrilateralsContainer"),Gt.setAttribute("width",0),Gt.setAttribute("height",0);const Bt=It.createElement("defs");Gt.append(Bt);const Vt=It.createElement("clipPath"),zt=`clippath_${this.data.id}`;Vt.setAttribute("id",zt),Vt.setAttribute("clipPathUnits","objectBoundingBox"),Bt.append(Vt);for(const[,{x:Xt,y:qt},{x:Yt,y:Qt}]of $){const Jt=It.createElement("rect"),te=(Yt-H)/Ut,ne=(yt-qt)/Nt,se=(Xt-Yt)/Ut,Xi=(qt-Qt)/Nt;Jt.setAttribute("x",te),Jt.setAttribute("y",ne),Jt.setAttribute("width",se),Jt.setAttribute("height",Xi),Vt.append(Jt),Tt==null||Tt.push(`<rect vector-effect="non-scaling-stroke" x="${te}" y="${ne}" width="${se}" height="${Xi}"/>`)}t(this,A)&&(Tt.push("</g></svg>')"),wt.backgroundImage=Tt.join("")),this.container.append(Gt),this.container.style.clipPath=`url(#${zt})`}_createPopup(){const{container:$,data:H}=this;$.setAttribute("aria-haspopup","dialog");const st=new r({data:{color:H.color,titleObj:H.titleObj,modificationDate:H.modificationDate,contentsObj:H.contentsObj,richText:H.richText,parentRect:H.rect,borderStyle:0,id:`popup_${H.id}`,rotation:H.rotation},parent:this.parent,elements:[this]});this.parent.div.append(st.render())}render(){(0,S.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName($,H=null){const st=[];if(this._fieldObjects){const _t=this._fieldObjects[$];if(_t)for(const{page:yt,id:wt,exportValues:Tt}of _t){if(yt===-1||wt===H)continue;const Ut=typeof Tt=="string"?Tt:null,Nt=document.querySelector(`[data-element-id="${wt}"]`);if(Nt&&!N.has(Nt)){(0,S.warn)(`_getElementsByName - element not allowed: ${wt}`);continue}st.push({id:wt,exportValue:Ut,domElement:Nt})}return st}for(const _t of document.getElementsByName($)){const{exportValue:yt}=_t,wt=_t.getAttribute("data-element-id");wt!==H&&N.has(_t)&&st.push({id:wt,exportValue:yt,domElement:_t})}return st}show(){var $;this.container&&(this.container.hidden=!1),($=this.popup)==null||$.maybeShow()}hide(){var $;this.container&&(this.container.hidden=!0),($=this.popup)==null||$.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const $=this.getElementsToTriggerPopup();if(Array.isArray($))for(const H of $)H.classList.add("highlightArea");else $.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:$,data:{id:H}}=this;this.container.addEventListener("dblclick",()=>{var st;(st=this.linkService.eventBus)==null||st.dispatch("switchannotationeditormode",{source:this,mode:$,editId:H})})}};A=new WeakMap;let c=Y;class v extends c{constructor(H,st=null){super(H,{isRenderable:!0,ignoreBorder:!!(st!=null&&st.ignoreBorder),createQuadrilaterals:!0});tt(this,K);this.isTooltipOnly=H.data.isTooltipOnly}render(){const{data:H,linkService:st}=this,_t=document.createElement("a");_t.setAttribute("data-element-id",H.id);let yt=!1;return H.url?(st.addLinkAttributes(_t,H.url,H.newWindow),yt=!0):H.action?(this._bindNamedAction(_t,H.action),yt=!0):H.attachment?(this._bindAttachment(_t,H.attachment),yt=!0):H.setOCGState?(j(this,K,dn).call(this,_t,H.setOCGState),yt=!0):H.dest?(this._bindLink(_t,H.dest),yt=!0):(H.actions&&(H.actions.Action||H.actions["Mouse Up"]||H.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(_t,H),yt=!0),H.resetForm?(this._bindResetFormAction(_t,H.resetForm),yt=!0):this.isTooltipOnly&&!yt&&(this._bindLink(_t,""),yt=!0)),this.container.classList.add("linkAnnotation"),yt&&this.container.append(_t),this.container}_bindLink(H,st){H.href=this.linkService.getDestinationHash(st),H.onclick=()=>(st&&this.linkService.goToDestination(st),!1),(st||st==="")&&j(this,K,re).call(this)}_bindNamedAction(H,st){H.href=this.linkService.getAnchorUrl(""),H.onclick=()=>(this.linkService.executeNamedAction(st),!1),j(this,K,re).call(this)}_bindAttachment(H,st){H.href=this.linkService.getAnchorUrl(""),H.onclick=()=>{var _t;return(_t=this.downloadManager)==null||_t.openOrDownloadData(this.container,st.content,st.filename),!1},j(this,K,re).call(this)}_bindJSAction(H,st){H.href=this.linkService.getAnchorUrl("");const _t=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const yt of Object.keys(st.actions)){const wt=_t.get(yt);wt&&(H[wt]=()=>{var Tt;return(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:st.id,name:yt}}),!1})}H.onclick||(H.onclick=()=>!1),j(this,K,re).call(this)}_bindResetFormAction(H,st){const _t=H.onclick;if(_t||(H.href=this.linkService.getAnchorUrl("")),j(this,K,re).call(this),!this._fieldObjects){(0,S.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),_t||(H.onclick=()=>!1);return}H.onclick=()=>{var Gt;_t==null||_t();const{fields:yt,refs:wt,include:Tt}=st,Ut=[];if(yt.length!==0||wt.length!==0){const Bt=new Set(wt);for(const Vt of yt){const zt=this._fieldObjects[Vt]||[];for(const{id:Xt}of zt)Bt.add(Xt)}for(const Vt of Object.values(this._fieldObjects))for(const zt of Vt)Bt.has(zt.id)===Tt&&Ut.push(zt)}else for(const Bt of Object.values(this._fieldObjects))Ut.push(...Bt);const Nt=this.annotationStorage,It=[];for(const Bt of Ut){const{id:Vt}=Bt;switch(It.push(Vt),Bt.type){case"text":{const Xt=Bt.defaultValue||"";Nt.setValue(Vt,{value:Xt});break}case"checkbox":case"radiobutton":{const Xt=Bt.defaultValue===Bt.exportValues;Nt.setValue(Vt,{value:Xt});break}case"combobox":case"listbox":{const Xt=Bt.defaultValue||"";Nt.setValue(Vt,{value:Xt});break}default:continue}const zt=document.querySelector(`[data-element-id="${Vt}"]`);if(zt){if(!N.has(zt)){(0,S.warn)(`_bindResetFormAction - element not allowed: ${Vt}`);continue}}else continue;zt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:It,name:"ResetForm"}})),!1}}}K=new WeakSet,re=function(){this.container.setAttribute("data-internal-link","")},dn=function(H,st){H.href=this.linkService.getAnchorUrl(""),H.onclick=()=>(this.linkService.executeSetOCGState(st),!1),j(this,K,re).call(this)};class b extends c{constructor($){super($,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const $=document.createElement("img");return $.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",$.alt="[{{type}} Annotation]",$.dataset.l10nId="text_annotation_type",$.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append($),this.container}}class m extends c{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas($){var H;this.data.hasOwnCanvas&&(((H=$.previousSibling)==null?void 0:H.nodeName)==="CANVAS"&&($.previousSibling.hidden=!0),$.hidden=!1)}_getKeyModifier($){const{isWin:H,isMac:st}=S.FeatureTest.platform;return H&&$.ctrlKey||st&&$.metaKey}_setEventListener($,H,st,_t,yt){st.includes("mouse")?$.addEventListener(st,wt=>{var Tt;(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_t,value:yt(wt),shift:wt.shiftKey,modifier:this._getKeyModifier(wt)}})}):$.addEventListener(st,wt=>{var Tt;if(st==="blur"){if(!H.focused||!wt.relatedTarget)return;H.focused=!1}else if(st==="focus"){if(H.focused)return;H.focused=!0}yt&&((Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_t,value:yt(wt)}}))})}_setEventListeners($,H,st,_t){var yt,wt,Tt;for(const[Ut,Nt]of st)(Nt==="Action"||(yt=this.data.actions)!=null&&yt[Nt])&&((Nt==="Focus"||Nt==="Blur")&&(H||(H={focused:!1})),this._setEventListener($,H,Ut,Nt,_t),Nt==="Focus"&&!((wt=this.data.actions)!=null&&wt.Blur)?this._setEventListener($,H,"blur","Blur",null):Nt==="Blur"&&!((Tt=this.data.actions)!=null&&Tt.Focus)&&this._setEventListener($,H,"focus","Focus",null))}_setBackgroundColor($){const H=this.data.backgroundColor||null;$.style.backgroundColor=H===null?"transparent":S.Util.makeHexColor(H[0],H[1],H[2])}_setTextStyle($){const H=["left","center","right"],{fontColor:st}=this.data.defaultAppearanceData,_t=this.data.defaultAppearanceData.fontSize||a,yt=$.style;let wt;const Tt=2,Ut=Nt=>Math.round(10*Nt)/10;if(this.data.multiLine){const Nt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt),It=Math.round(Nt/(S.LINE_FACTOR*_t))||1,Gt=Nt/It;wt=Math.min(_t,Ut(Gt/S.LINE_FACTOR))}else{const Nt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt);wt=Math.min(_t,Ut(Nt/S.LINE_FACTOR))}yt.fontSize=`calc(${wt}px * var(--scale-factor))`,yt.color=S.Util.makeHexColor(st[0],st[1],st[2]),this.data.textAlignment!==null&&(yt.textAlign=H[this.data.textAlignment])}_setRequired($,H){H?$.setAttribute("required",!0):$.removeAttribute("required"),$.setAttribute("aria-required",H)}}class u extends m{constructor($){const H=$.renderForms||!$.data.hasAppearance&&!!$.data.fieldValue;super($,{isRenderable:H})}setPropertyOnSiblings($,H,st,_t){const yt=this.annotationStorage;for(const wt of this._getElementsByName($.name,$.id))wt.domElement&&(wt.domElement[H]=st),yt.setValue(wt.id,{[_t]:st})}render(){var _t,yt;const $=this.annotationStorage,H=this.data.id;this.container.classList.add("textWidgetAnnotation");let st=null;if(this.renderForms){const wt=$.getValue(H,{value:this.data.fieldValue});let Tt=wt.value||"";const Ut=$.getValue(H,{charLimit:this.data.maxLen}).charLimit;Ut&&Tt.length>Ut&&(Tt=Tt.slice(0,Ut));let Nt=wt.formattedValue||((_t=this.data.textContent)==null?void 0:_t.join(`
`))||null;Nt&&this.data.comb&&(Nt=Nt.replaceAll(/\s+/g,""));const It={userValue:Tt,formattedValue:Nt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(st=document.createElement("textarea"),st.textContent=Nt??Tt,this.data.doNotScroll&&(st.style.overflowY="hidden")):(st=document.createElement("input"),st.type="text",st.setAttribute("value",Nt??Tt),this.data.doNotScroll&&(st.style.overflowX="hidden")),this.data.hasOwnCanvas&&(st.hidden=!0),N.add(st),st.setAttribute("data-element-id",H),st.disabled=this.data.readOnly,st.name=this.data.fieldName,st.tabIndex=f,this._setRequired(st,this.data.required),Ut&&(st.maxLength=Ut),st.addEventListener("input",Bt=>{$.setValue(H,{value:Bt.target.value}),this.setPropertyOnSiblings(st,"value",Bt.target.value,"value"),It.formattedValue=null}),st.addEventListener("resetform",Bt=>{const Vt=this.data.defaultFieldValue??"";st.value=It.userValue=Vt,It.formattedValue=null});let Gt=Bt=>{const{formattedValue:Vt}=It;Vt!=null&&(Bt.target.value=Vt),Bt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){st.addEventListener("focus",Vt=>{if(It.focused)return;const{target:zt}=Vt;It.userValue&&(zt.value=It.userValue),It.lastCommittedValue=zt.value,It.commitKey=1,It.focused=!0}),st.addEventListener("updatefromsandbox",Vt=>{this.showElementAndHideCanvas(Vt.target);const zt={value(Xt){It.userValue=Xt.detail.value??"",$.setValue(H,{value:It.userValue.toString()}),Xt.target.value=It.userValue},formattedValue(Xt){const{formattedValue:qt}=Xt.detail;It.formattedValue=qt,qt!=null&&Xt.target!==document.activeElement&&(Xt.target.value=qt),$.setValue(H,{formattedValue:qt})},selRange(Xt){Xt.target.setSelectionRange(...Xt.detail.selRange)},charLimit:Xt=>{var Jt;const{charLimit:qt}=Xt.detail,{target:Yt}=Xt;if(qt===0){Yt.removeAttribute("maxLength");return}Yt.setAttribute("maxLength",qt);let Qt=It.userValue;!Qt||Qt.length<=qt||(Qt=Qt.slice(0,qt),Yt.value=It.userValue=Qt,$.setValue(H,{value:Qt}),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:H,name:"Keystroke",value:Qt,willCommit:!0,commitKey:1,selStart:Yt.selectionStart,selEnd:Yt.selectionEnd}}))}};this._dispatchEventFromSandbox(zt,Vt)}),st.addEventListener("keydown",Vt=>{var qt;It.commitKey=1;let zt=-1;if(Vt.key==="Escape"?zt=0:Vt.key==="Enter"&&!this.data.multiLine?zt=2:Vt.key==="Tab"&&(It.commitKey=3),zt===-1)return;const{value:Xt}=Vt.target;It.lastCommittedValue!==Xt&&(It.lastCommittedValue=Xt,It.userValue=Xt,(qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:H,name:"Keystroke",value:Xt,willCommit:!0,commitKey:zt,selStart:Vt.target.selectionStart,selEnd:Vt.target.selectionEnd}}))});const Bt=Gt;Gt=null,st.addEventListener("blur",Vt=>{var Xt;if(!It.focused||!Vt.relatedTarget)return;It.focused=!1;const{value:zt}=Vt.target;It.userValue=zt,It.lastCommittedValue!==zt&&((Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:H,name:"Keystroke",value:zt,willCommit:!0,commitKey:It.commitKey,selStart:Vt.target.selectionStart,selEnd:Vt.target.selectionEnd}})),Bt(Vt)}),(yt=this.data.actions)!=null&&yt.Keystroke&&st.addEventListener("beforeinput",Vt=>{var ne;It.lastCommittedValue=null;const{data:zt,target:Xt}=Vt,{value:qt,selectionStart:Yt,selectionEnd:Qt}=Xt;let Jt=Yt,te=Qt;switch(Vt.inputType){case"deleteWordBackward":{const se=qt.substring(0,Yt).match(/\w*[^\w]*$/);se&&(Jt-=se[0].length);break}case"deleteWordForward":{const se=qt.substring(Yt).match(/^[^\w]*\w*/);se&&(te+=se[0].length);break}case"deleteContentBackward":Yt===Qt&&(Jt-=1);break;case"deleteContentForward":Yt===Qt&&(te+=1);break}Vt.preventDefault(),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:H,name:"Keystroke",value:qt,change:zt||"",willCommit:!1,selStart:Jt,selEnd:te}})}),this._setEventListeners(st,It,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Vt=>Vt.target.value)}if(Gt&&st.addEventListener("blur",Gt),this.data.comb){const Vt=(this.data.rect[2]-this.data.rect[0])/Ut;st.classList.add("comb"),st.style.letterSpacing=`calc(${Vt}px * var(--scale-factor) - 1ch)`}}else st=document.createElement("div"),st.textContent=this.data.fieldValue,st.style.verticalAlign="middle",st.style.display="table-cell";return this._setTextStyle(st),this._setBackgroundColor(st),this._setDefaultPropertiesFromJS(st),this.container.append(st),this.container}}class _ extends m{constructor($){super($,{isRenderable:!!$.data.hasOwnCanvas})}}class g extends m{constructor($){super($,{isRenderable:$.renderForms})}render(){const $=this.annotationStorage,H=this.data,st=H.id;let _t=$.getValue(st,{value:H.exportValue===H.fieldValue}).value;typeof _t=="string"&&(_t=_t!=="Off",$.setValue(st,{value:_t})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const yt=document.createElement("input");return N.add(yt),yt.setAttribute("data-element-id",st),yt.disabled=H.readOnly,this._setRequired(yt,this.data.required),yt.type="checkbox",yt.name=H.fieldName,_t&&yt.setAttribute("checked",!0),yt.setAttribute("exportValue",H.exportValue),yt.tabIndex=f,yt.addEventListener("change",wt=>{const{name:Tt,checked:Ut}=wt.target;for(const Nt of this._getElementsByName(Tt,st)){const It=Ut&&Nt.exportValue===H.exportValue;Nt.domElement&&(Nt.domElement.checked=It),$.setValue(Nt.id,{value:It})}$.setValue(st,{value:Ut})}),yt.addEventListener("resetform",wt=>{const Tt=H.defaultFieldValue||"Off";wt.target.checked=Tt===H.exportValue}),this.enableScripting&&this.hasJSActions&&(yt.addEventListener("updatefromsandbox",wt=>{const Tt={value(Ut){Ut.target.checked=Ut.detail.value!=="Off",$.setValue(st,{value:Ut.target.checked})}};this._dispatchEventFromSandbox(Tt,wt)}),this._setEventListeners(yt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.checked)),this._setBackgroundColor(yt),this._setDefaultPropertiesFromJS(yt),this.container.append(yt),this.container}}class i extends m{constructor($){super($,{isRenderable:$.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const $=this.annotationStorage,H=this.data,st=H.id;let _t=$.getValue(st,{value:H.fieldValue===H.buttonValue}).value;typeof _t=="string"&&(_t=_t!==H.buttonValue,$.setValue(st,{value:_t}));const yt=document.createElement("input");if(N.add(yt),yt.setAttribute("data-element-id",st),yt.disabled=H.readOnly,this._setRequired(yt,this.data.required),yt.type="radio",yt.name=H.fieldName,_t&&yt.setAttribute("checked",!0),yt.tabIndex=f,yt.addEventListener("change",wt=>{const{name:Tt,checked:Ut}=wt.target;for(const Nt of this._getElementsByName(Tt,st))$.setValue(Nt.id,{value:!1});$.setValue(st,{value:Ut})}),yt.addEventListener("resetform",wt=>{const Tt=H.defaultFieldValue;wt.target.checked=Tt!=null&&Tt===H.buttonValue}),this.enableScripting&&this.hasJSActions){const wt=H.buttonValue;yt.addEventListener("updatefromsandbox",Tt=>{const Ut={value:Nt=>{const It=wt===Nt.detail.value;for(const Gt of this._getElementsByName(Nt.target.name)){const Bt=It&&Gt.id===st;Gt.domElement&&(Gt.domElement.checked=Bt),$.setValue(Gt.id,{value:Bt})}}};this._dispatchEventFromSandbox(Ut,Tt)}),this._setEventListeners(yt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Tt=>Tt.target.checked)}return this._setBackgroundColor(yt),this._setDefaultPropertiesFromJS(yt),this.container.append(yt),this.container}}class e extends v{constructor($){super($,{ignoreBorder:$.data.hasAppearance})}render(){const $=super.render();$.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&($.title=this.data.alternativeText);const H=$.lastChild;return this.enableScripting&&this.hasJSActions&&H&&(this._setDefaultPropertiesFromJS(H),H.addEventListener("updatefromsandbox",st=>{this._dispatchEventFromSandbox({},st)})),$}}class n extends m{constructor($){super($,{isRenderable:$.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const $=this.annotationStorage,H=this.data.id,st=$.getValue(H,{value:this.data.fieldValue}),_t=document.createElement("select");N.add(_t),_t.setAttribute("data-element-id",H),_t.disabled=this.data.readOnly,this._setRequired(_t,this.data.required),_t.name=this.data.fieldName,_t.tabIndex=f;let yt=this.data.combo&&this.data.options.length>0;this.data.combo||(_t.size=this.data.options.length,this.data.multiSelect&&(_t.multiple=!0)),_t.addEventListener("resetform",It=>{const Gt=this.data.defaultFieldValue;for(const Bt of _t.options)Bt.selected=Bt.value===Gt});for(const It of this.data.options){const Gt=document.createElement("option");Gt.textContent=It.displayValue,Gt.value=It.exportValue,st.value.includes(It.exportValue)&&(Gt.setAttribute("selected",!0),yt=!1),_t.append(Gt)}let wt=null;if(yt){const It=document.createElement("option");It.value=" ",It.setAttribute("hidden",!0),It.setAttribute("selected",!0),_t.prepend(It),wt=()=>{It.remove(),_t.removeEventListener("input",wt),wt=null},_t.addEventListener("input",wt)}const Tt=It=>{const Gt=It?"value":"textContent",{options:Bt,multiple:Vt}=_t;return Vt?Array.prototype.filter.call(Bt,zt=>zt.selected).map(zt=>zt[Gt]):Bt.selectedIndex===-1?null:Bt[Bt.selectedIndex][Gt]};let Ut=Tt(!1);const Nt=It=>{const Gt=It.target.options;return Array.prototype.map.call(Gt,Bt=>({displayValue:Bt.textContent,exportValue:Bt.value}))};return this.enableScripting&&this.hasJSActions?(_t.addEventListener("updatefromsandbox",It=>{const Gt={value(Bt){wt==null||wt();const Vt=Bt.detail.value,zt=new Set(Array.isArray(Vt)?Vt:[Vt]);for(const Xt of _t.options)Xt.selected=zt.has(Xt.value);$.setValue(H,{value:Tt(!0)}),Ut=Tt(!1)},multipleSelection(Bt){_t.multiple=!0},remove(Bt){const Vt=_t.options,zt=Bt.detail.remove;Vt[zt].selected=!1,_t.remove(zt),Vt.length>0&&Array.prototype.findIndex.call(Vt,qt=>qt.selected)===-1&&(Vt[0].selected=!0),$.setValue(H,{value:Tt(!0),items:Nt(Bt)}),Ut=Tt(!1)},clear(Bt){for(;_t.length!==0;)_t.remove(0);$.setValue(H,{value:null,items:[]}),Ut=Tt(!1)},insert(Bt){const{index:Vt,displayValue:zt,exportValue:Xt}=Bt.detail.insert,qt=_t.children[Vt],Yt=document.createElement("option");Yt.textContent=zt,Yt.value=Xt,qt?qt.before(Yt):_t.append(Yt),$.setValue(H,{value:Tt(!0),items:Nt(Bt)}),Ut=Tt(!1)},items(Bt){const{items:Vt}=Bt.detail;for(;_t.length!==0;)_t.remove(0);for(const zt of Vt){const{displayValue:Xt,exportValue:qt}=zt,Yt=document.createElement("option");Yt.textContent=Xt,Yt.value=qt,_t.append(Yt)}_t.options.length>0&&(_t.options[0].selected=!0),$.setValue(H,{value:Tt(!0),items:Nt(Bt)}),Ut=Tt(!1)},indices(Bt){const Vt=new Set(Bt.detail.indices);for(const zt of Bt.target.options)zt.selected=Vt.has(zt.index);$.setValue(H,{value:Tt(!0)}),Ut=Tt(!1)},editable(Bt){Bt.target.disabled=!Bt.detail.editable}};this._dispatchEventFromSandbox(Gt,It)}),_t.addEventListener("input",It=>{var Bt;const Gt=Tt(!0);$.setValue(H,{value:Gt}),It.preventDefault(),(Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:H,name:"Keystroke",value:Ut,changeEx:Gt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(_t,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],It=>It.target.value)):_t.addEventListener("input",function(It){$.setValue(H,{value:Tt(!0)})}),this.data.combo&&this._setTextStyle(_t),this._setBackgroundColor(_t),this._setDefaultPropertiesFromJS(_t),this.container.append(_t),this.container}}class r extends c{constructor($){const{data:H,elements:st}=$;super($,{isRenderable:c._hasPopupData(H)}),this.elements=st}render(){this.container.classList.add("popupAnnotation");const $=new d({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),H=[];for(const st of this.elements)st.popup=$,H.push(st.data.id),st.addHighlightArea();return this.container.setAttribute("aria-controls",H.map(st=>`${S.AnnotationPrefix}${st}`).join(",")),this.container}}class d{constructor({container:$,color:H,elements:st,titleObj:_t,modificationDate:yt,contentsObj:wt,richText:Tt,parent:Ut,rect:Nt,parentRect:It,open:Gt}){tt(this,ot);tt(this,at,null);tt(this,ft,j(this,ot,un).bind(this));tt(this,pt,j(this,ot,pi).bind(this));tt(this,vt,j(this,ot,fi).bind(this));tt(this,Et,j(this,ot,Re).bind(this));tt(this,Pt,null);tt(this,ct,null);tt(this,lt,null);tt(this,I,null);tt(this,q,null);tt(this,nt,null);tt(this,P,!1);tt(this,s,null);tt(this,w,null);tt(this,U,null);tt(this,F,null);tt(this,it,!1);var Vt;Z(this,ct,$),Z(this,F,_t),Z(this,lt,wt),Z(this,U,Tt),Z(this,q,Ut),Z(this,Pt,H),Z(this,w,Nt),Z(this,nt,It),Z(this,I,st);const Bt=G.PDFDateString.toDateObject(yt);Bt&&Z(this,at,Ut.l10n.get("annotation_date_string",{date:Bt.toLocaleDateString(),time:Bt.toLocaleTimeString()})),this.trigger=st.flatMap(zt=>zt.getElementsToTriggerPopup());for(const zt of this.trigger)zt.addEventListener("click",t(this,Et)),zt.addEventListener("mouseenter",t(this,vt)),zt.addEventListener("mouseleave",t(this,pt)),zt.classList.add("popupTriggerArea");for(const zt of st)(Vt=zt.container)==null||Vt.addEventListener("keydown",t(this,ft));t(this,ct).hidden=!0,Gt&&j(this,ot,Re).call(this)}render(){if(t(this,s))return;const{page:{view:$},viewport:{rawDims:{pageWidth:H,pageHeight:st,pageX:_t,pageY:yt}}}=t(this,q),wt=Z(this,s,document.createElement("div"));if(wt.className="popup",t(this,Pt)){const Jt=wt.style.outlineColor=S.Util.makeHexColor(...t(this,Pt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?wt.style.backgroundColor=`color-mix(in srgb, ${Jt} 30%, white)`:wt.style.backgroundColor=S.Util.makeHexColor(...t(this,Pt).map(ne=>Math.floor(.7*(255-ne)+ne)))}const Tt=document.createElement("span");Tt.className="header";const Ut=document.createElement("h1");if(Tt.append(Ut),{dir:Ut.dir,str:Ut.textContent}=t(this,F),wt.append(Tt),t(this,at)){const Jt=document.createElement("span");Jt.classList.add("popupDate"),t(this,at).then(te=>{Jt.textContent=te}),Tt.append(Jt)}const Nt=t(this,lt),It=t(this,U);if(It!=null&&It.str&&(!(Nt!=null&&Nt.str)||Nt.str===It.str))R.XfaLayer.render({xfaHtml:It.html,intent:"richText",div:wt}),wt.lastChild.classList.add("richText","popupContent");else{const Jt=this._formatContents(Nt);wt.append(Jt)}let Gt=!!t(this,nt),Bt=Gt?t(this,nt):t(this,w);for(const Jt of t(this,I))if(!Bt||S.Util.intersect(Jt.data.rect,Bt)!==null){Bt=Jt.data.rect,Gt=!0;break}const Vt=S.Util.normalizeRect([Bt[0],$[3]-Bt[1]+$[1],Bt[2],$[3]-Bt[3]+$[1]]),Xt=Gt?Bt[2]-Bt[0]+5:0,qt=Vt[0]+Xt,Yt=Vt[1],{style:Qt}=t(this,ct);Qt.left=`${100*(qt-_t)/H}%`,Qt.top=`${100*(Yt-yt)/st}%`,t(this,ct).append(wt)}_formatContents({str:$,dir:H}){const st=document.createElement("p");st.classList.add("popupContent"),st.dir=H;const _t=$.split(/(?:\r\n?|\n)/);for(let yt=0,wt=_t.length;yt<wt;++yt){const Tt=_t[yt];st.append(document.createTextNode(Tt)),yt<wt-1&&st.append(document.createElement("br"))}return st}forceHide(){Z(this,it,this.isVisible),t(this,it)&&(t(this,ct).hidden=!0)}maybeShow(){t(this,it)&&(Z(this,it,!1),t(this,ct).hidden=!1)}get isVisible(){return t(this,ct).hidden===!1}}at=new WeakMap,ft=new WeakMap,pt=new WeakMap,vt=new WeakMap,Et=new WeakMap,Pt=new WeakMap,ct=new WeakMap,lt=new WeakMap,I=new WeakMap,q=new WeakMap,nt=new WeakMap,P=new WeakMap,s=new WeakMap,w=new WeakMap,U=new WeakMap,F=new WeakMap,it=new WeakMap,ot=new WeakSet,un=function($){$.altKey||$.shiftKey||$.ctrlKey||$.metaKey||($.key==="Enter"||$.key==="Escape"&&t(this,P))&&j(this,ot,Re).call(this)},Re=function(){Z(this,P,!t(this,P)),t(this,P)?(j(this,ot,fi).call(this),t(this,ct).addEventListener("click",t(this,Et)),t(this,ct).addEventListener("keydown",t(this,ft))):(j(this,ot,pi).call(this),t(this,ct).removeEventListener("click",t(this,Et)),t(this,ct).removeEventListener("keydown",t(this,ft)))},fi=function(){t(this,s)||this.render(),this.isVisible?t(this,P)&&t(this,ct).classList.add("focused"):(t(this,ct).hidden=!1,t(this,ct).style.zIndex=parseInt(t(this,ct).style.zIndex)+1e3)},pi=function(){t(this,ct).classList.remove("focused"),!(t(this,P)||!this.isVisible)&&(t(this,ct).hidden=!0,t(this,ct).style.zIndex=parseInt(t(this,ct).style.zIndex)-1e3)};class T extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0}),this.textContent=$.data.textContent,this.textPosition=$.data.textPosition,this.annotationEditorType=S.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const $=document.createElement("div");$.classList.add("annotationTextContent"),$.setAttribute("role","comment");for(const H of this.textContent){const st=document.createElement("span");st.textContent=H,$.append(st)}this.container.append($)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}L.FreeTextAnnotationElement=T;class o extends c{constructor(H){super(H,{isRenderable:!0,ignoreBorder:!0});tt(this,kt,null)}render(){this.container.classList.add("lineAnnotation");const H=this.data,{width:st,height:_t}=x(H.rect),yt=this.svgFactory.create(st,_t,!0),wt=Z(this,kt,this.svgFactory.createElement("svg:line"));return wt.setAttribute("x1",H.rect[2]-H.lineCoordinates[0]),wt.setAttribute("y1",H.rect[3]-H.lineCoordinates[1]),wt.setAttribute("x2",H.rect[2]-H.lineCoordinates[2]),wt.setAttribute("y2",H.rect[3]-H.lineCoordinates[3]),wt.setAttribute("stroke-width",H.borderStyle.width||1),wt.setAttribute("stroke","transparent"),wt.setAttribute("fill","transparent"),yt.append(wt),this.container.append(yt),!H.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,kt)}addHighlightArea(){this.container.classList.add("highlightArea")}}kt=new WeakMap;class E extends c{constructor(H){super(H,{isRenderable:!0,ignoreBorder:!0});tt(this,jt,null)}render(){this.container.classList.add("squareAnnotation");const H=this.data,{width:st,height:_t}=x(H.rect),yt=this.svgFactory.create(st,_t,!0),wt=H.borderStyle.width,Tt=Z(this,jt,this.svgFactory.createElement("svg:rect"));return Tt.setAttribute("x",wt/2),Tt.setAttribute("y",wt/2),Tt.setAttribute("width",st-wt),Tt.setAttribute("height",_t-wt),Tt.setAttribute("stroke-width",wt||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),yt.append(Tt),this.container.append(yt),!H.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}jt=new WeakMap;class W extends c{constructor(H){super(H,{isRenderable:!0,ignoreBorder:!0});tt(this,$t,null)}render(){this.container.classList.add("circleAnnotation");const H=this.data,{width:st,height:_t}=x(H.rect),yt=this.svgFactory.create(st,_t,!0),wt=H.borderStyle.width,Tt=Z(this,$t,this.svgFactory.createElement("svg:ellipse"));return Tt.setAttribute("cx",st/2),Tt.setAttribute("cy",_t/2),Tt.setAttribute("rx",st/2-wt/2),Tt.setAttribute("ry",_t/2-wt/2),Tt.setAttribute("stroke-width",wt||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),yt.append(Tt),this.container.append(yt),!H.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,$t)}addHighlightArea(){this.container.classList.add("highlightArea")}}$t=new WeakMap;class D extends c{constructor(H){super(H,{isRenderable:!0,ignoreBorder:!0});tt(this,St,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const H=this.data,{width:st,height:_t}=x(H.rect),yt=this.svgFactory.create(st,_t,!0);let wt=[];for(const Ut of H.vertices){const Nt=Ut.x-H.rect[0],It=H.rect[3]-Ut.y;wt.push(Nt+","+It)}wt=wt.join(" ");const Tt=Z(this,St,this.svgFactory.createElement(this.svgElementName));return Tt.setAttribute("points",wt),Tt.setAttribute("stroke-width",H.borderStyle.width||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),yt.append(Tt),this.container.append(yt),!H.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,St)}addHighlightArea(){this.container.classList.add("highlightArea")}}St=new WeakMap;class B extends D{constructor($){super($),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class z extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class M extends c{constructor(H){super(H,{isRenderable:!0,ignoreBorder:!0});tt(this,ht,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=S.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const H=this.data,{width:st,height:_t}=x(H.rect),yt=this.svgFactory.create(st,_t,!0);for(const wt of H.inkLists){let Tt=[];for(const Nt of wt){const It=Nt.x-H.rect[0],Gt=H.rect[3]-Nt.y;Tt.push(`${It},${Gt}`)}Tt=Tt.join(" ");const Ut=this.svgFactory.createElement(this.svgElementName);t(this,ht).push(Ut),Ut.setAttribute("points",Tt),Ut.setAttribute("stroke-width",H.borderStyle.width||1),Ut.setAttribute("stroke","transparent"),Ut.setAttribute("fill","transparent"),!H.popupRef&&this.hasPopupData&&this._createPopup(),yt.append(Ut)}return this.container.append(yt),this.container}getElementsToTriggerPopup(){return t(this,ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}ht=new WeakMap,L.InkAnnotationElement=M;class Q extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class y extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class C extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class rt extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class O extends c{constructor($){super($,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}L.StampAnnotationElement=O;class l extends c{constructor(H){var yt;super(H,{isRenderable:!0});tt(this,Ft);tt(this,ut,null);const{filename:st,content:_t}=this.data.file;this.filename=(0,G.getFilenameFromUrl)(st,!0),this.content=_t,(yt=this.linkService.eventBus)==null||yt.dispatch("fileattachmentannotation",{source:this,filename:st,content:_t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:H,data:st}=this;let _t;st.hasAppearance||st.fillAlpha===0?_t=document.createElement("div"):(_t=document.createElement("img"),_t.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(st.name)?"paperclip":"pushpin"}.svg`,st.fillAlpha&&st.fillAlpha<1&&(_t.style=`filter: opacity(${Math.round(st.fillAlpha*100)}%);`)),_t.addEventListener("dblclick",j(this,Ft,gi).bind(this)),Z(this,ut,_t);const{isMac:yt}=S.FeatureTest.platform;return H.addEventListener("keydown",wt=>{wt.key==="Enter"&&(yt?wt.metaKey:wt.ctrlKey)&&j(this,Ft,gi).call(this)}),!st.popupRef&&this.hasPopupData?this._createPopup():_t.classList.add("popupTriggerArea"),H.append(_t),H}getElementsToTriggerPopup(){return t(this,ut)}addHighlightArea(){this.container.classList.add("highlightArea")}}ut=new WeakMap,Ft=new WeakSet,gi=function(){var H;(H=this.downloadManager)==null||H.openOrDownloadData(this.container,this.content,this.filename)};class h{constructor({div:$,accessibilityManager:H,annotationCanvasMap:st,l10n:_t,page:yt,viewport:wt}){tt(this,Lt);tt(this,Ht,null);tt(this,X,null);tt(this,gt,new Map);this.div=$,Z(this,Ht,H),Z(this,X,st),this.l10n=_t,this.page=yt,this.viewport=wt,this.zIndex=0,this.l10n||(this.l10n=V.NullL10n)}async render($){const{annotations:H}=$,st=this.div;(0,G.setLayerDimensions)(st,this.viewport);const _t=new Map,yt={data:null,layer:st,linkService:$.linkService,downloadManager:$.downloadManager,imageResourcesPath:$.imageResourcesPath||"",renderForms:$.renderForms!==!1,svgFactory:new G.DOMSVGFactory,annotationStorage:$.annotationStorage||new bt.AnnotationStorage,enableScripting:$.enableScripting===!0,hasJSActions:$.hasJSActions,fieldObjects:$.fieldObjects,parent:this,elements:null};for(const wt of H){if(wt.noHTML)continue;const Tt=wt.annotationType===S.AnnotationType.POPUP;if(Tt){const It=_t.get(wt.id);if(!It)continue;yt.elements=It}else{const{width:It,height:Gt}=x(wt.rect);if(It<=0||Gt<=0)continue}yt.data=wt;const Ut=p.create(yt);if(!Ut.isRenderable)continue;if(!Tt&&wt.popupRef){const It=_t.get(wt.popupRef);It?It.push(Ut):_t.set(wt.popupRef,[Ut])}Ut.annotationEditorType>0&&t(this,gt).set(Ut.data.id,Ut);const Nt=Ut.render();wt.hidden&&(Nt.style.visibility="hidden"),j(this,Lt,fn).call(this,Nt,wt.id)}j(this,Lt,mi).call(this),await this.l10n.translate(st)}update({viewport:$}){const H=this.div;this.viewport=$,(0,G.setLayerDimensions)(H,{rotation:$.rotation}),j(this,Lt,mi).call(this),H.hidden=!1}getEditableAnnotations(){return Array.from(t(this,gt).values())}getEditableAnnotation($){return t(this,gt).get($)}}Ht=new WeakMap,X=new WeakMap,gt=new WeakMap,Lt=new WeakSet,fn=function($,H){var _t;const st=$.firstChild||$;st.id=`${S.AnnotationPrefix}${H}`,this.div.append($),(_t=t(this,Ht))==null||_t.moveElementInDOM(this.div,$,st,!1)},mi=function(){if(!t(this,X))return;const $=this.div;for(const[H,st]of t(this,X)){const _t=$.querySelector(`[data-annotation-id="${H}"]`);if(!_t)continue;const{firstChild:yt}=_t;yt?yt.nodeName==="CANVAS"?yt.replaceWith(st):yt.before(st):_t.append(st)}t(this,X).clear()},L.AnnotationLayer=h},(Ct,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.ColorConverters=void 0;function mt(bt){return Math.floor(Math.max(0,Math.min(1,bt))*255).toString(16).padStart(2,"0")}function S(bt){return Math.max(0,Math.min(255,255*bt))}class G{static CMYK_G([et,V,R,f]){return["G",1-Math.min(1,.3*et+.59*R+.11*V+f)]}static G_CMYK([et]){return["CMYK",0,0,0,1-et]}static G_RGB([et]){return["RGB",et,et,et]}static G_rgb([et]){return et=S(et),[et,et,et]}static G_HTML([et]){const V=mt(et);return`#${V}${V}${V}`}static RGB_G([et,V,R]){return["G",.3*et+.59*V+.11*R]}static RGB_rgb(et){return et.map(S)}static RGB_HTML(et){return`#${et.map(mt).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([et,V,R,f]){return["RGB",1-Math.min(1,et+f),1-Math.min(1,R+f),1-Math.min(1,V+f)]}static CMYK_rgb([et,V,R,f]){return[S(1-Math.min(1,et+f)),S(1-Math.min(1,R+f)),S(1-Math.min(1,V+f))]}static CMYK_HTML(et){const V=this.CMYK_RGB(et).slice(1);return this.RGB_HTML(V)}static RGB_CMYK([et,V,R]){const f=1-et,a=1-V,N=1-R,x=Math.min(f,a,N);return["CMYK",f,a,N,x]}}L.ColorConverters=G},(Ct,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.NullL10n=void 0,L.getL10nFallback=S;const mt={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};mt.print_progress_percent="{{progress}}%";function S(et,V){switch(et){case"find_match_count":et=`find_match_count[${V.total===1?"one":"other"}]`;break;case"find_match_count_limit":et=`find_match_count_limit[${V.limit===1?"one":"other"}]`;break}return mt[et]||""}function G(et,V){return V?et.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(R,f)=>f in V?V[f]:"{{"+f+"}}"):et}const bt={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(et,V=null,R=S(et,V)){return G(R,V)},async translate(et){}};L.NullL10n=bt},(Ct,L,mt)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.XfaLayer=void 0;var S=mt(25);class G{static setupStorage(et,V,R,f,a){const N=f.getValue(V,{value:null});switch(R.name){case"textarea":if(N.value!==null&&(et.textContent=N.value),a==="print")break;et.addEventListener("input",x=>{f.setValue(V,{value:x.target.value})});break;case"input":if(R.attributes.type==="radio"||R.attributes.type==="checkbox"){if(N.value===R.attributes.xfaOn?et.setAttribute("checked",!0):N.value===R.attributes.xfaOff&&et.removeAttribute("checked"),a==="print")break;et.addEventListener("change",x=>{f.setValue(V,{value:x.target.checked?x.target.getAttribute("xfaOn"):x.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&et.setAttribute("value",N.value),a==="print")break;et.addEventListener("input",x=>{f.setValue(V,{value:x.target.value})})}break;case"select":if(N.value!==null){et.setAttribute("value",N.value);for(const x of R.children)x.attributes.value===N.value?x.attributes.selected=!0:x.attributes.hasOwnProperty("selected")&&delete x.attributes.selected}et.addEventListener("input",x=>{const p=x.target.options,c=p.selectedIndex===-1?"":p[p.selectedIndex].value;f.setValue(V,{value:c})});break}}static setAttributes({html:et,element:V,storage:R=null,intent:f,linkService:a}){const{attributes:N}=V,x=et instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${f}`);for(const[p,c]of Object.entries(N))if(c!=null)switch(p){case"class":c.length&&et.setAttribute(p,c.join(" "));break;case"dataId":break;case"id":et.setAttribute("data-element-id",c);break;case"style":Object.assign(et.style,c);break;case"textContent":et.textContent=c;break;default:(!x||p!=="href"&&p!=="newWindow")&&et.setAttribute(p,c)}x&&a.addLinkAttributes(et,N.href,N.newWindow),R&&N.dataId&&this.setupStorage(et,N.dataId,V,R)}static render(et){var v;const V=et.annotationStorage,R=et.linkService,f=et.xfaHtml,a=et.intent||"display",N=document.createElement(f.name);f.attributes&&this.setAttributes({html:N,element:f,intent:a,linkService:R});const x=[[f,-1,N]],p=et.div;if(p.append(N),et.viewport){const b=`matrix(${et.viewport.transform.join(",")})`;p.style.transform=b}a!=="richText"&&p.setAttribute("class","xfaLayer xfaFont");const c=[];for(;x.length>0;){const[b,m,u]=x.at(-1);if(m+1===b.children.length){x.pop();continue}const _=b.children[++x.at(-1)[1]];if(_===null)continue;const{name:g}=_;if(g==="#text"){const e=document.createTextNode(_.value);c.push(e),u.append(e);continue}const i=(v=_==null?void 0:_.attributes)!=null&&v.xmlns?document.createElementNS(_.attributes.xmlns,g):document.createElement(g);if(u.append(i),_.attributes&&this.setAttributes({html:i,element:_,storage:V,intent:a,linkService:R}),_.children&&_.children.length>0)x.push([_,-1,i]);else if(_.value){const e=document.createTextNode(_.value);S.XfaText.shouldBuildText(g)&&c.push(e),i.append(e)}}for(const b of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:c}}static update(et){const V=`matrix(${et.viewport.transform.join(",")})`;et.div.style.transform=V,et.div.hidden=!1}}L.XfaLayer=G},(Ct,L,mt)=>{var f,a,N,x,p,c,v,b,m,u,_,g,i,e,n,pn,gn,mn,_n,_i,bn,bi,vn,yn,An,Sn,En,ee,vi,ke,Fe,he,yi,Ie,K,Pn,Ai,wn,Cn,Si,De,de;Object.defineProperty(L,"__esModule",{value:!0}),L.InkEditor=void 0;var S=mt(1),G=mt(4),bt=mt(29),et=mt(6),V=mt(5);const Pt=class Pt extends G.AnnotationEditor{constructor(I){super({...I,name:"inkEditor"});tt(this,n);tt(this,f,0);tt(this,a,0);tt(this,N,this.canvasPointermove.bind(this));tt(this,x,this.canvasPointerleave.bind(this));tt(this,p,this.canvasPointerup.bind(this));tt(this,c,this.canvasPointerdown.bind(this));tt(this,v,new Path2D);tt(this,b,!1);tt(this,m,!1);tt(this,u,!1);tt(this,_,null);tt(this,g,0);tt(this,i,0);tt(this,e,null);this.color=I.color||null,this.thickness=I.thickness||null,this.opacity=I.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(I){G.AnnotationEditor.initialize(I,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(I,q){switch(I){case S.AnnotationEditorParamsType.INK_THICKNESS:Pt._defaultThickness=q;break;case S.AnnotationEditorParamsType.INK_COLOR:Pt._defaultColor=q;break;case S.AnnotationEditorParamsType.INK_OPACITY:Pt._defaultOpacity=q/100;break}}updateParams(I,q){switch(I){case S.AnnotationEditorParamsType.INK_THICKNESS:j(this,n,pn).call(this,q);break;case S.AnnotationEditorParamsType.INK_COLOR:j(this,n,gn).call(this,q);break;case S.AnnotationEditorParamsType.INK_OPACITY:j(this,n,mn).call(this,q);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.INK_THICKNESS,Pt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,Pt._defaultColor||G.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(Pt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[S.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Pt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,this.color||Pt._defaultColor||G.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Pt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(j(this,n,ke).call(this),j(this,n,Fe).call(this)),this.isAttachedToDOM||(this.parent.add(this),j(this,n,he).call(this)),j(this,n,de).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,_).disconnect(),Z(this,_,null),super.remove())}setParent(I){!this.parent&&I?this._uiManager.removeShouldRescale(this):this.parent&&I===null&&this._uiManager.addShouldRescale(this),super.setParent(I)}onScaleChanging(){const[I,q]=this.parentDimensions,nt=this.width*I,P=this.height*q;this.setDimensions(nt,P)}enableEditMode(){t(this,b)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,c)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,c)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,b)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Z(this,b,!0),this.div.classList.add("disabled"),j(this,n,de).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(I){this._focusEventsAllowed&&(super.focusin(I),this.enableEditMode())}canvasPointerdown(I){I.button!==0||!this.isInEditMode()||t(this,b)||(this.setInForeground(),I.preventDefault(),I.type!=="mouse"&&this.div.focus(),j(this,n,bn).call(this,I.offsetX,I.offsetY))}canvasPointermove(I){I.preventDefault(),j(this,n,bi).call(this,I.offsetX,I.offsetY)}canvasPointerup(I){I.preventDefault(),j(this,n,vi).call(this,I)}canvasPointerleave(I){j(this,n,vi).call(this,I)}get isResizable(){return!this.isEmpty()&&t(this,b)}render(){if(this.div)return this.div;let I,q;this.width&&(I=this.x,q=this.y),super.render(),G.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(U=>{var F;return(F=this.div)==null?void 0:F.setAttribute("aria-label",U)});const[nt,P,s,w]=j(this,n,_n).call(this);if(this.setAt(nt,P,0,0),this.setDims(s,w),j(this,n,ke).call(this),this.width){const[U,F]=this.parentDimensions;this.setAspectRatio(this.width*U,this.height*F),this.setAt(I*U,q*F,this.width*U,this.height*F),Z(this,u,!0),j(this,n,he).call(this),this.setDims(this.width*U,this.height*F),j(this,n,ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return j(this,n,Fe).call(this),this.div}setDimensions(I,q){const nt=Math.round(I),P=Math.round(q);if(t(this,g)===nt&&t(this,i)===P)return;Z(this,g,nt),Z(this,i,P),this.canvas.style.visibility="hidden";const[s,w]=this.parentDimensions;this.width=I/s,this.height=q/w,this.fixAndSetPosition(),t(this,b)&&j(this,n,yi).call(this,I,q),j(this,n,he).call(this),j(this,n,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(I,q,nt){var kt,jt,$t;if(I instanceof bt.InkAnnotationElement)return null;const P=super.deserialize(I,q,nt);P.thickness=I.thickness,P.color=S.Util.makeHexColor(...I.color),P.opacity=I.opacity;const[s,w]=P.pageDimensions,U=P.width*s,F=P.height*w,it=P.parentScale,ot=I.thickness/2;Z(P,b,!0),Z(P,g,Math.round(U)),Z(P,i,Math.round(F));const{paths:At,rect:dt,rotation:Mt}=I;for(let{bezier:St}of At){St=j(kt=Pt,K,wn).call(kt,St,dt,Mt);const ht=[];P.paths.push(ht);let ut=it*(St[0]-ot),Ft=it*(St[1]-ot);for(let Ht=2,X=St.length;Ht<X;Ht+=6){const gt=it*(St[Ht]-ot),Lt=it*(St[Ht+1]-ot),Dt=it*(St[Ht+2]-ot),Ot=it*(St[Ht+3]-ot),Rt=it*(St[Ht+4]-ot),$=it*(St[Ht+5]-ot);ht.push([[ut,Ft],[gt,Lt],[Dt,Ot],[Rt,$]]),ut=Rt,Ft=$}const Wt=j(this,K,Pn).call(this,ht);P.bezierPath2D.push(Wt)}const xt=j(jt=P,n,Si).call(jt);return Z(P,a,Math.max(G.AnnotationEditor.MIN_SIZE,xt[2]-xt[0])),Z(P,f,Math.max(G.AnnotationEditor.MIN_SIZE,xt[3]-xt[1])),j($t=P,n,yi).call($t,U,F),P}serialize(){if(this.isEmpty())return null;const I=this.getRect(0,0),q=G.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:S.AnnotationEditorType.INK,color:q,thickness:this.thickness,opacity:this.opacity,paths:j(this,n,Cn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,I),pageIndex:this.pageIndex,rect:I,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};f=new WeakMap,a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap,u=new WeakMap,_=new WeakMap,g=new WeakMap,i=new WeakMap,e=new WeakMap,n=new WeakSet,pn=function(I){const q=this.thickness;this.addCommands({cmd:()=>{this.thickness=I,j(this,n,de).call(this)},undo:()=>{this.thickness=q,j(this,n,de).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},gn=function(I){const q=this.color;this.addCommands({cmd:()=>{this.color=I,j(this,n,ee).call(this)},undo:()=>{this.color=q,j(this,n,ee).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},mn=function(I){I/=100;const q=this.opacity;this.addCommands({cmd:()=>{this.opacity=I,j(this,n,ee).call(this)},undo:()=>{this.opacity=q,j(this,n,ee).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},_n=function(){const{parentRotation:I,parentDimensions:[q,nt]}=this;switch(I){case 90:return[0,nt,nt,q];case 180:return[q,nt,q,nt];case 270:return[q,0,nt,q];default:return[0,0,q,nt]}},_i=function(){const{ctx:I,color:q,opacity:nt,thickness:P,parentScale:s,scaleFactor:w}=this;I.lineWidth=P*s/w,I.lineCap="round",I.lineJoin="round",I.miterLimit=10,I.strokeStyle=`${q}${(0,V.opacityToHex)(nt)}`},bn=function(I,q){this.canvas.addEventListener("contextmenu",et.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,x)),this.canvas.addEventListener("pointermove",t(this,N)),this.canvas.addEventListener("pointerup",t(this,p)),this.canvas.removeEventListener("pointerdown",t(this,c)),this.isEditing=!0,t(this,u)||(Z(this,u,!0),j(this,n,he).call(this),this.thickness||(this.thickness=Pt._defaultThickness),this.color||(this.color=Pt._defaultColor||G.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Pt._defaultOpacity)),this.currentPath.push([I,q]),Z(this,m,!1),j(this,n,_i).call(this),Z(this,e,()=>{j(this,n,An).call(this),t(this,e)&&window.requestAnimationFrame(t(this,e))}),window.requestAnimationFrame(t(this,e))},bi=function(I,q){const[nt,P]=this.currentPath.at(-1);if(this.currentPath.length>1&&I===nt&&q===P)return;const s=this.currentPath;let w=t(this,v);if(s.push([I,q]),Z(this,m,!0),s.length<=2){w.moveTo(...s[0]),w.lineTo(I,q);return}s.length===3&&(Z(this,v,w=new Path2D),w.moveTo(...s[0])),j(this,n,Sn).call(this,w,...s.at(-3),...s.at(-2),I,q)},vn=function(){if(this.currentPath.length===0)return;const I=this.currentPath.at(-1);t(this,v).lineTo(...I)},yn=function(I,q){Z(this,e,null),I=Math.min(Math.max(I,0),this.canvas.width),q=Math.min(Math.max(q,0),this.canvas.height),j(this,n,bi).call(this,I,q),j(this,n,vn).call(this);let nt;if(this.currentPath.length!==1)nt=j(this,n,En).call(this);else{const F=[I,q];nt=[[F,F.slice(),F.slice(),F]]}const P=t(this,v),s=this.currentPath;this.currentPath=[],Z(this,v,new Path2D);const w=()=>{this.allRawPaths.push(s),this.paths.push(nt),this.bezierPath2D.push(P),this.rebuild()},U=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(j(this,n,ke).call(this),j(this,n,Fe).call(this)),j(this,n,de).call(this))};this.addCommands({cmd:w,undo:U,mustExec:!0})},An=function(){if(!t(this,m))return;Z(this,m,!1);const I=Math.ceil(this.thickness*this.parentScale),q=this.currentPath.slice(-3),nt=q.map(w=>w[0]),P=q.map(w=>w[1]);Math.min(...nt)-I,Math.max(...nt)+I,Math.min(...P)-I,Math.max(...P)+I;const{ctx:s}=this;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height);for(const w of this.bezierPath2D)s.stroke(w);s.stroke(t(this,v)),s.restore()},Sn=function(I,q,nt,P,s,w,U){const F=(q+P)/2,it=(nt+s)/2,ot=(P+w)/2,At=(s+U)/2;I.bezierCurveTo(F+2*(P-F)/3,it+2*(s-it)/3,ot+2*(P-ot)/3,At+2*(s-At)/3,ot,At)},En=function(){const I=this.currentPath;if(I.length<=2)return[[I[0],I[0],I.at(-1),I.at(-1)]];const q=[];let nt,[P,s]=I[0];for(nt=1;nt<I.length-2;nt++){const[dt,Mt]=I[nt],[xt,kt]=I[nt+1],jt=(dt+xt)/2,$t=(Mt+kt)/2,St=[P+2*(dt-P)/3,s+2*(Mt-s)/3],ht=[jt+2*(dt-jt)/3,$t+2*(Mt-$t)/3];q.push([[P,s],St,ht,[jt,$t]]),[P,s]=[jt,$t]}const[w,U]=I[nt],[F,it]=I[nt+1],ot=[P+2*(w-P)/3,s+2*(U-s)/3],At=[F+2*(w-F)/3,it+2*(U-it)/3];return q.push([[P,s],ot,At,[F,it]]),q},ee=function(){if(this.isEmpty()){j(this,n,Ie).call(this);return}j(this,n,_i).call(this);const{canvas:I,ctx:q}=this;q.setTransform(1,0,0,1,0,0),q.clearRect(0,0,I.width,I.height),j(this,n,Ie).call(this);for(const nt of this.bezierPath2D)q.stroke(nt)},vi=function(I){this.canvas.removeEventListener("pointerleave",t(this,x)),this.canvas.removeEventListener("pointermove",t(this,N)),this.canvas.removeEventListener("pointerup",t(this,p)),this.canvas.addEventListener("pointerdown",t(this,c)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",et.noContextMenu)},10),j(this,n,yn).call(this,I.offsetX,I.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ke=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",G.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(I=>{var q;return(q=this.canvas)==null?void 0:q.setAttribute("aria-label",I)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Fe=function(){Z(this,_,new ResizeObserver(I=>{const q=I[0].contentRect;q.width&&q.height&&this.setDimensions(q.width,q.height)})),t(this,_).observe(this.div)},he=function(){if(!t(this,u))return;const[I,q]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*I),this.canvas.height=Math.ceil(this.height*q),j(this,n,Ie).call(this)},yi=function(I,q){const nt=j(this,n,De).call(this),P=(I-nt)/t(this,a),s=(q-nt)/t(this,f);this.scaleFactor=Math.min(P,s)},Ie=function(){const I=j(this,n,De).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+I,this.translationY*this.scaleFactor+I)},K=new WeakSet,Pn=function(I){const q=new Path2D;for(let nt=0,P=I.length;nt<P;nt++){const[s,w,U,F]=I[nt];nt===0&&q.moveTo(...s),q.bezierCurveTo(w[0],w[1],U[0],U[1],F[0],F[1])}return q},Ai=function(I,q,nt){const[P,s,w,U]=q;switch(nt){case 0:for(let F=0,it=I.length;F<it;F+=2)I[F]+=P,I[F+1]=U-I[F+1];break;case 90:for(let F=0,it=I.length;F<it;F+=2){const ot=I[F];I[F]=I[F+1]+P,I[F+1]=ot+s}break;case 180:for(let F=0,it=I.length;F<it;F+=2)I[F]=w-I[F],I[F+1]+=s;break;case 270:for(let F=0,it=I.length;F<it;F+=2){const ot=I[F];I[F]=w-I[F+1],I[F+1]=U-ot}break;default:throw new Error("Invalid rotation")}return I},wn=function(I,q,nt){const[P,s,w,U]=q;switch(nt){case 0:for(let F=0,it=I.length;F<it;F+=2)I[F]-=P,I[F+1]=U-I[F+1];break;case 90:for(let F=0,it=I.length;F<it;F+=2){const ot=I[F];I[F]=I[F+1]-s,I[F+1]=ot-P}break;case 180:for(let F=0,it=I.length;F<it;F+=2)I[F]=w-I[F],I[F+1]-=s;break;case 270:for(let F=0,it=I.length;F<it;F+=2){const ot=I[F];I[F]=U-I[F+1],I[F+1]=w-ot}break;default:throw new Error("Invalid rotation")}return I},Cn=function(I,q,nt,P){var it,ot;const s=[],w=this.thickness/2,U=I*q+w,F=I*nt+w;for(const At of this.paths){const dt=[],Mt=[];for(let xt=0,kt=At.length;xt<kt;xt++){const[jt,$t,St,ht]=At[xt],ut=I*jt[0]+U,Ft=I*jt[1]+F,Wt=I*$t[0]+U,Ht=I*$t[1]+F,X=I*St[0]+U,gt=I*St[1]+F,Lt=I*ht[0]+U,Dt=I*ht[1]+F;xt===0&&(dt.push(ut,Ft),Mt.push(ut,Ft)),dt.push(Wt,Ht,X,gt,Lt,Dt),Mt.push(Wt,Ht),xt===kt-1&&Mt.push(Lt,Dt)}s.push({bezier:j(it=Pt,K,Ai).call(it,dt,P,this.rotation),points:j(ot=Pt,K,Ai).call(ot,Mt,P,this.rotation)})}return s},Si=function(){let I=1/0,q=-1/0,nt=1/0,P=-1/0;for(const s of this.paths)for(const[w,U,F,it]of s){const ot=S.Util.bezierBoundingBox(...w,...U,...F,...it);I=Math.min(I,ot[0]),nt=Math.min(nt,ot[1]),q=Math.max(q,ot[2]),P=Math.max(P,ot[3])}return[I,nt,q,P]},De=function(){return t(this,b)?Math.ceil(this.thickness*this.parentScale):0},de=function(I=!1){if(this.isEmpty())return;if(!t(this,b)){j(this,n,ee).call(this);return}const q=j(this,n,Si).call(this),nt=j(this,n,De).call(this);Z(this,a,Math.max(G.AnnotationEditor.MIN_SIZE,q[2]-q[0])),Z(this,f,Math.max(G.AnnotationEditor.MIN_SIZE,q[3]-q[1]));const P=Math.ceil(nt+t(this,a)*this.scaleFactor),s=Math.ceil(nt+t(this,f)*this.scaleFactor),[w,U]=this.parentDimensions;this.width=P/w,this.height=s/U,this.setAspectRatio(P,s);const F=this.translationX,it=this.translationY;this.translationX=-q[0],this.translationY=-q[1],j(this,n,he).call(this),j(this,n,ee).call(this),Z(this,g,P),Z(this,i,s),this.setDims(P,s);const ot=I?nt/this.scaleFactor/2:0;this.translate(F-this.translationX-ot,it-this.translationY-ot)},tt(Pt,K),Kt(Pt,"_defaultColor",null),Kt(Pt,"_defaultOpacity",1),Kt(Pt,"_defaultThickness",1),Kt(Pt,"_type","ink");let R=Pt;L.InkEditor=R},(Ct,L,mt)=>{var R,f,a,N,x,p,c,v,b,m,u,be,ve,Oe,Ei,Tn,xn,Pi,Ne,Mn;Object.defineProperty(L,"__esModule",{value:!0}),L.StampEditor=void 0;var S=mt(1),G=mt(4),bt=mt(6),et=mt(29);const E=class E extends G.AnnotationEditor{constructor(B){super({...B,name:"stampEditor"});tt(this,u);tt(this,R,null);tt(this,f,null);tt(this,a,null);tt(this,N,null);tt(this,x,null);tt(this,p,null);tt(this,c,null);tt(this,v,null);tt(this,b,!1);tt(this,m,!1);Z(this,N,B.bitmapUrl),Z(this,x,B.bitmapFile)}static initialize(B){G.AnnotationEditor.initialize(B)}static get supportedTypes(){const B=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,S.shadow)(this,"supportedTypes",B.map(z=>`image/${z}`))}static get supportedTypesStr(){return(0,S.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(B){return this.supportedTypes.includes(B)}static paste(B,z){z.pasteEditor(S.AnnotationEditorType.STAMP,{bitmapFile:B.getAsFile()})}remove(){var B,z;t(this,f)&&(Z(this,R,null),this._uiManager.imageManager.deleteId(t(this,f)),(B=t(this,p))==null||B.remove(),Z(this,p,null),(z=t(this,c))==null||z.disconnect(),Z(this,c,null)),super.remove()}rebuild(){if(!this.parent){t(this,f)&&j(this,u,Oe).call(this);return}super.rebuild(),this.div!==null&&(t(this,f)&&j(this,u,Oe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,a)||t(this,R)||t(this,N)||t(this,x))}get isResizable(){return!0}render(){if(this.div)return this.div;let B,z;if(this.width&&(B=this.x,z=this.y),super.render(),this.div.hidden=!0,t(this,R)?j(this,u,Ei).call(this):j(this,u,Oe).call(this),this.width){const[M,Q]=this.parentDimensions;this.setAt(B*M,z*Q,this.width*M,this.height*Q)}return this.div}static deserialize(B,z,M){if(B instanceof et.StampAnnotationElement)return null;const Q=super.deserialize(B,z,M),{rect:y,bitmapUrl:C,bitmapId:rt,isSvg:O,accessibilityData:l}=B;rt&&M.imageManager.isValidId(rt)?Z(Q,f,rt):Z(Q,N,C),Z(Q,b,O);const[h,A]=Q.pageDimensions;return Q.width=(y[2]-y[0])/h,Q.height=(y[3]-y[1])/A,l&&(Q.altTextData=l),Q}serialize(B=!1,z=null){if(this.isEmpty())return null;const M={annotationType:S.AnnotationEditorType.STAMP,bitmapId:t(this,f),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,b),structTreeParentId:this._structTreeParentId};if(B)return M.bitmapUrl=j(this,u,Ne).call(this,!0),M.accessibilityData=this.altTextData,M;const{decorative:Q,altText:y}=this.altTextData;if(!Q&&y&&(M.accessibilityData={type:"Figure",alt:y}),z===null)return M;z.stamps||(z.stamps=new Map);const C=t(this,b)?(M.rect[2]-M.rect[0])*(M.rect[3]-M.rect[1]):null;if(!z.stamps.has(t(this,f)))z.stamps.set(t(this,f),{area:C,serialized:M}),M.bitmap=j(this,u,Ne).call(this,!1);else if(t(this,b)){const rt=z.stamps.get(t(this,f));C>rt.area&&(rt.area=C,rt.serialized.bitmap.close(),rt.serialized.bitmap=j(this,u,Ne).call(this,!1))}return M}};R=new WeakMap,f=new WeakMap,a=new WeakMap,N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap,u=new WeakSet,be=function(B,z=!1){if(!B){this.remove();return}Z(this,R,B.bitmap),z||(Z(this,f,B.id),Z(this,b,B.isSvg)),j(this,u,Ei).call(this)},ve=function(){Z(this,a,null),this._uiManager.enableWaiting(!1),t(this,p)&&this.div.focus()},Oe=function(){if(t(this,f)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,f)).then(z=>j(this,u,be).call(this,z,!0)).finally(()=>j(this,u,ve).call(this));return}if(t(this,N)){const z=t(this,N);Z(this,N,null),this._uiManager.enableWaiting(!0),Z(this,a,this._uiManager.imageManager.getFromUrl(z).then(M=>j(this,u,be).call(this,M)).finally(()=>j(this,u,ve).call(this)));return}if(t(this,x)){const z=t(this,x);Z(this,x,null),this._uiManager.enableWaiting(!0),Z(this,a,this._uiManager.imageManager.getFromFile(z).then(M=>j(this,u,be).call(this,M)).finally(()=>j(this,u,ve).call(this)));return}const B=document.createElement("input");B.type="file",B.accept=E.supportedTypesStr,Z(this,a,new Promise(z=>{B.addEventListener("change",async()=>{if(!B.files||B.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const M=await this._uiManager.imageManager.getFromFile(B.files[0]);j(this,u,be).call(this,M)}z()}),B.addEventListener("cancel",()=>{this.remove(),z()})}).finally(()=>j(this,u,ve).call(this))),B.click()},Ei=function(){const{div:B}=this;let{width:z,height:M}=t(this,R);const[Q,y]=this.pageDimensions,C=.75;if(this.width)z=this.width*Q,M=this.height*y;else if(z>C*Q||M>C*y){const h=Math.min(C*Q/z,C*y/M);z*=h,M*=h}const[rt,O]=this.parentDimensions;this.setDims(z*rt/Q,M*O/y),this._uiManager.enableWaiting(!1);const l=Z(this,p,document.createElement("canvas"));B.append(l),B.hidden=!1,j(this,u,Pi).call(this,z,M),j(this,u,Mn).call(this),t(this,m)||(this.parent.addUndoableEditor(this),Z(this,m,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Tn=function(B,z){var C;const[M,Q]=this.parentDimensions;this.width=B/M,this.height=z/Q,this.setDims(B,z),(C=this._initialOptions)!=null&&C.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,v)!==null&&clearTimeout(t(this,v)),Z(this,v,setTimeout(()=>{Z(this,v,null),j(this,u,Pi).call(this,B,z)},200))},xn=function(B,z){const{width:M,height:Q}=t(this,R);let y=M,C=Q,rt=t(this,R);for(;y>2*B||C>2*z;){const O=y,l=C;y>2*B&&(y=y>=16384?Math.floor(y/2)-1:Math.ceil(y/2)),C>2*z&&(C=C>=16384?Math.floor(C/2)-1:Math.ceil(C/2));const h=new OffscreenCanvas(y,C);h.getContext("2d").drawImage(rt,0,0,O,l,0,0,y,C),rt=h.transferToImageBitmap()}return rt},Pi=function(B,z){B=Math.ceil(B),z=Math.ceil(z);const M=t(this,p);if(!M||M.width===B&&M.height===z)return;M.width=B,M.height=z;const Q=t(this,b)?t(this,R):j(this,u,xn).call(this,B,z),y=M.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(Q,0,0,Q.width,Q.height,0,0,B,z)},Ne=function(B){if(B){if(t(this,b)){const Q=this._uiManager.imageManager.getSvgUrl(t(this,f));if(Q)return Q}const z=document.createElement("canvas");return{width:z.width,height:z.height}=t(this,R),z.getContext("2d").drawImage(t(this,R),0,0),z.toDataURL()}if(t(this,b)){const[z,M]=this.pageDimensions,Q=Math.round(this.width*z*bt.PixelsPerInch.PDF_TO_CSS_UNITS),y=Math.round(this.height*M*bt.PixelsPerInch.PDF_TO_CSS_UNITS),C=new OffscreenCanvas(Q,y);return C.getContext("2d").drawImage(t(this,R),0,0,t(this,R).width,t(this,R).height,0,0,Q,y),C.transferToImageBitmap()}return structuredClone(t(this,R))},Mn=function(){Z(this,c,new ResizeObserver(B=>{const z=B[0].contentRect;z.width&&z.height&&j(this,u,Tn).call(this,z.width,z.height)})),t(this,c).observe(this.div)},Kt(E,"_type","stamp");let V=E;L.StampEditor=V}],__webpack_module_cache__={};function __w_pdfjs_require__(Ct){var L=__webpack_module_cache__[Ct];if(L!==void 0)return L.exports;var mt=__webpack_module_cache__[Ct]={exports:{}};return __webpack_modules__[Ct](mt,mt.exports,__w_pdfjs_require__),mt.exports}var __webpack_exports__={};return(()=>{var Ct=__webpack_exports__;Object.defineProperty(Ct,"__esModule",{value:!0}),Object.defineProperty(Ct,"AbortException",{enumerable:!0,get:function(){return L.AbortException}}),Object.defineProperty(Ct,"AnnotationEditorLayer",{enumerable:!0,get:function(){return bt.AnnotationEditorLayer}}),Object.defineProperty(Ct,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return L.AnnotationEditorParamsType}}),Object.defineProperty(Ct,"AnnotationEditorType",{enumerable:!0,get:function(){return L.AnnotationEditorType}}),Object.defineProperty(Ct,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return et.AnnotationEditorUIManager}}),Object.defineProperty(Ct,"AnnotationLayer",{enumerable:!0,get:function(){return V.AnnotationLayer}}),Object.defineProperty(Ct,"AnnotationMode",{enumerable:!0,get:function(){return L.AnnotationMode}}),Object.defineProperty(Ct,"CMapCompressionType",{enumerable:!0,get:function(){return L.CMapCompressionType}}),Object.defineProperty(Ct,"DOMSVGFactory",{enumerable:!0,get:function(){return S.DOMSVGFactory}}),Object.defineProperty(Ct,"FeatureTest",{enumerable:!0,get:function(){return L.FeatureTest}}),Object.defineProperty(Ct,"GlobalWorkerOptions",{enumerable:!0,get:function(){return R.GlobalWorkerOptions}}),Object.defineProperty(Ct,"ImageKind",{enumerable:!0,get:function(){return L.ImageKind}}),Object.defineProperty(Ct,"InvalidPDFException",{enumerable:!0,get:function(){return L.InvalidPDFException}}),Object.defineProperty(Ct,"MissingPDFException",{enumerable:!0,get:function(){return L.MissingPDFException}}),Object.defineProperty(Ct,"OPS",{enumerable:!0,get:function(){return L.OPS}}),Object.defineProperty(Ct,"PDFDataRangeTransport",{enumerable:!0,get:function(){return mt.PDFDataRangeTransport}}),Object.defineProperty(Ct,"PDFDateString",{enumerable:!0,get:function(){return S.PDFDateString}}),Object.defineProperty(Ct,"PDFWorker",{enumerable:!0,get:function(){return mt.PDFWorker}}),Object.defineProperty(Ct,"PasswordResponses",{enumerable:!0,get:function(){return L.PasswordResponses}}),Object.defineProperty(Ct,"PermissionFlag",{enumerable:!0,get:function(){return L.PermissionFlag}}),Object.defineProperty(Ct,"PixelsPerInch",{enumerable:!0,get:function(){return S.PixelsPerInch}}),Object.defineProperty(Ct,"PromiseCapability",{enumerable:!0,get:function(){return L.PromiseCapability}}),Object.defineProperty(Ct,"RenderingCancelledException",{enumerable:!0,get:function(){return S.RenderingCancelledException}}),Object.defineProperty(Ct,"SVGGraphics",{enumerable:!0,get:function(){return mt.SVGGraphics}}),Object.defineProperty(Ct,"UnexpectedResponseException",{enumerable:!0,get:function(){return L.UnexpectedResponseException}}),Object.defineProperty(Ct,"Util",{enumerable:!0,get:function(){return L.Util}}),Object.defineProperty(Ct,"VerbosityLevel",{enumerable:!0,get:function(){return L.VerbosityLevel}}),Object.defineProperty(Ct,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}}),Object.defineProperty(Ct,"build",{enumerable:!0,get:function(){return mt.build}}),Object.defineProperty(Ct,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return L.createValidAbsoluteUrl}}),Object.defineProperty(Ct,"getDocument",{enumerable:!0,get:function(){return mt.getDocument}}),Object.defineProperty(Ct,"getFilenameFromUrl",{enumerable:!0,get:function(){return S.getFilenameFromUrl}}),Object.defineProperty(Ct,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return S.getPdfFilenameFromUrl}}),Object.defineProperty(Ct,"getXfaPageViewport",{enumerable:!0,get:function(){return S.getXfaPageViewport}}),Object.defineProperty(Ct,"isDataScheme",{enumerable:!0,get:function(){return S.isDataScheme}}),Object.defineProperty(Ct,"isPdfFile",{enumerable:!0,get:function(){return S.isPdfFile}}),Object.defineProperty(Ct,"loadScript",{enumerable:!0,get:function(){return S.loadScript}}),Object.defineProperty(Ct,"noContextMenu",{enumerable:!0,get:function(){return S.noContextMenu}}),Object.defineProperty(Ct,"normalizeUnicode",{enumerable:!0,get:function(){return L.normalizeUnicode}}),Object.defineProperty(Ct,"renderTextLayer",{enumerable:!0,get:function(){return G.renderTextLayer}}),Object.defineProperty(Ct,"setLayerDimensions",{enumerable:!0,get:function(){return S.setLayerDimensions}}),Object.defineProperty(Ct,"shadow",{enumerable:!0,get:function(){return L.shadow}}),Object.defineProperty(Ct,"updateTextLayer",{enumerable:!0,get:function(){return G.updateTextLayer}}),Object.defineProperty(Ct,"version",{enumerable:!0,get:function(){return mt.version}});var L=__w_pdfjs_require__(1),mt=__w_pdfjs_require__(2),S=__w_pdfjs_require__(6),G=__w_pdfjs_require__(26),bt=__w_pdfjs_require__(27),et=__w_pdfjs_require__(5),V=__w_pdfjs_require__(29),R=__w_pdfjs_require__(14),f=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,pdf_viewer={exports:{}};(function(Ct,L){(function(S,G){Ct.exports=S.pdfjsViewer=G()})(globalThis,()=>(()=>{var mt=[,(et,V,R)=>{var z,M,Q,y,Ln,wi,Ci,Rn,kn,Fn,Ti,In,Dn,Be,ye,ue,On,xi,Mi,Ue,Nn,Li,Ri,Ae;Object.defineProperty(V,"__esModule",{value:!0}),V.PDFFindController=V.FindState=void 0;var f=R(2),a=R(3),N=R(4);const x={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};V.FindState=x;const p=250,c=-50,v=-400,b={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},m=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let u;const _=new RegExp("\\p{M}+","gu"),g=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),i=new RegExp("([^\\p{M}])\\p{M}*$","u"),e=new RegExp("^\\p{M}*([^\\p{M}])","u"),n=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,r=new Map,d="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",T=new Map;let o=null,E=null;function W(nt){const P=[];let s;for(;(s=n.exec(nt))!==null;){let{index:jt}=s;for(const $t of s[0]){let St=r.get($t);St||(St=$t.normalize("NFD").length,r.set($t,St)),P.push([St,jt++])}}let w;if(P.length===0&&o)w=o;else if(P.length>0&&E)w=E;else{const jt=Object.keys(b).join(""),$t=(0,a.getNormalizeWithNFKC)(),ut=`([${jt}])|([${$t}])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;P.length===0?w=o=new RegExp(ut+"|(\\u0000)","gum"):w=E=new RegExp(ut+`|(${d})`,"gum")}const U=[];for(;(s=_.exec(nt))!==null;)U.push([s[0].length,s.index]);let F=nt.normalize("NFD");const it=[[0,0]];let ot=0,At=0,dt=0,Mt=0,xt=0,kt=!1;return F=F.replace(w,(jt,$t,St,ht,ut,Ft,Wt,Ht,X,gt)=>{var Lt,Dt,Ot;if(gt-=Mt,$t){const Rt=b[$t],$=Rt.length;for(let H=1;H<$;H++)it.push([gt-dt+H,dt-H]);return dt-=$-1,Rt}if(St){let Rt=T.get(St);Rt||(Rt=St.normalize("NFKC"),T.set(St,Rt));const $=Rt.length;for(let H=1;H<$;H++)it.push([gt-dt+H,dt-H]);return dt-=$-1,Rt}if(ht)return kt=!0,gt+xt===((Lt=U[ot])==null?void 0:Lt[1])?++ot:(it.push([gt-1-dt+1,dt-1]),dt-=1,Mt+=1),it.push([gt-dt+1,dt]),Mt+=1,xt+=1,ht.charAt(0);if(ut){const Rt=ut.endsWith(`
`),$=Rt?ut.length-2:ut.length;kt=!0;let H=$;gt+xt===((Dt=U[ot])==null?void 0:Dt[1])&&(H-=U[ot][0],++ot);for(let st=1;st<=H;st++)it.push([gt-1-dt+st,dt-st]);return dt-=H,Mt+=H,Rt?(gt+=$-1,it.push([gt-dt+1,1+dt]),dt+=1,Mt+=1,xt+=1,ut.slice(0,$)):ut}if(Ft){const Rt=Ft.length-2;return it.push([gt-dt+Rt,1+dt]),dt+=1,Mt+=1,xt+=1,Ft.slice(0,-2)}if(Wt){const Rt=Wt.length-1;return it.push([gt-dt+Rt,dt]),Mt+=1,xt+=1,Wt.slice(0,-1)}if(Ht)return it.push([gt-dt+1,dt-1]),dt-=1,Mt+=1,xt+=1," ";if(gt+xt===((Ot=P[At])==null?void 0:Ot[1])){const Rt=P[At][0]-1;++At;for(let $=1;$<=Rt;$++)it.push([gt-(dt-$),dt-$]);dt-=Rt,Mt+=Rt}return X}),it.push([F.length,dt]),[F,it,kt]}function D(nt,P,s){if(!nt)return[P,s];const w=P,U=P+s-1;let F=(0,f.binarySearchFirstItem)(nt,Mt=>Mt[0]>=w);nt[F][0]>w&&--F;let it=(0,f.binarySearchFirstItem)(nt,Mt=>Mt[0]>=U,F);nt[it][0]>U&&--it;const ot=w+nt[F][1],dt=U+nt[it][1]+1-ot;return[ot,dt]}class B{constructor({linkService:P,eventBus:s,updateMatchesCountOnProgress:w=!0}){tt(this,y);tt(this,z,null);tt(this,M,!0);tt(this,Q,0);this._linkService=P,this._eventBus=s,Z(this,M,w),this.onIsPageVisible=null,j(this,y,wi).call(this),s._on("find",j(this,y,Ln).bind(this)),s._on("findbarclose",j(this,y,Nn).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return t(this,z)}setDocument(P){this._pdfDocument&&j(this,y,wi).call(this),P&&(this._pdfDocument=P,this._firstPageCapability.resolve())}scrollMatchIntoView({element:P=null,selectedLeft:s=0,pageIndex:w=-1,matchIndex:U=-1}){if(!this._scrollMatches||!P)return;if(U===-1||U!==this._selected.matchIdx)return;if(w===-1||w!==this._selected.pageIdx)return;this._scrollMatches=!1;const F={top:c,left:s+v};(0,f.scrollIntoView)(P,F,!0)}}z=new WeakMap,M=new WeakMap,Q=new WeakMap,y=new WeakSet,Ln=function(P){if(!P)return;P.phraseSearch===!1&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),typeof P.query=="string"&&(P.query=P.query.match(/\S+/g)));const s=this._pdfDocument,{type:w}=P;(t(this,z)===null||j(this,y,Rn).call(this,P))&&(this._dirtyMatch=!0),Z(this,z,P),w!=="highlightallchange"&&j(this,y,Ae).call(this,x.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||s&&this._pdfDocument!==s)return;j(this,y,Dn).call(this);const U=!this._highlightMatches,F=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),w?this._dirtyMatch?j(this,y,ue).call(this):w==="again"?(j(this,y,ue).call(this),U&&t(this,z).highlightAll&&j(this,y,ye).call(this)):w==="highlightallchange"?(F?j(this,y,ue).call(this):this._highlightMatches=!0,j(this,y,ye).call(this)):j(this,y,ue).call(this):this._findTimeout=setTimeout(()=>{j(this,y,ue).call(this),this._findTimeout=null},p)})},wi=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],Z(this,Q,0),Z(this,z,null),this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new N.PromiseCapability},Ci=function(){const{query:P}=t(this,z);return typeof P=="string"?(P!==this._rawQuery&&(this._rawQuery=P,[this._normalizedQuery]=W(P)),this._normalizedQuery):(P||[]).filter(s=>!!s).map(s=>W(s)[0])},Rn=function(P){var it;const s=P.query,w=t(this,z).query,U=typeof s;if(U!==typeof w)return!0;if(U==="string"){if(s!==w)return!0}else if(JSON.stringify(s)!==JSON.stringify(w))return!0;switch(P.type){case"again":const ot=this._selected.pageIdx+1,At=this._linkService;return ot>=1&&ot<=At.pagesCount&&ot!==At.page&&!(((it=this.onIsPageVisible)==null?void 0:it.call(this,ot))??!0);case"highlightallchange":return!1}return!0},kn=function(P,s,w){let U=P.slice(0,s).match(i);if(U){const F=P.charCodeAt(s),it=U[1].charCodeAt(0);if((0,a.getCharacterType)(F)===(0,a.getCharacterType)(it))return!1}if(U=P.slice(s+w).match(e),U){const F=P.charCodeAt(s+w-1),it=U[1].charCodeAt(0);if((0,a.getCharacterType)(F)===(0,a.getCharacterType)(it))return!1}return!0},Fn=function(P,s,w,U){const F=this._pageMatches[w]=[],it=this._pageMatchesLength[w]=[];if(!P)return;const ot=this._pageDiffs[w];let At;for(;(At=P.exec(U))!==null;){if(s&&!j(this,y,kn).call(this,U,At.index,At[0].length))continue;const[dt,Mt]=D(ot,At.index,At[0].length);Mt&&(F.push(dt),it.push(Mt))}},Ti=function(P,s){const{matchDiacritics:w}=t(this,z);let U=!1;P=P.replaceAll(g,(it,ot,At,dt,Mt,xt)=>ot?`[ ]*\\${ot}[ ]*`:At?`[ ]*${At}[ ]*`:dt?"[ ]+":w?Mt||xt:Mt?m.has(Mt.charCodeAt(0))?Mt:"":s?(U=!0,`${xt}\\p{M}*`):xt);const F="[ ]*";return P.endsWith(F)&&(P=P.slice(0,P.length-F.length)),w&&s&&(u||(u=String.fromCharCode(...m)),U=!0,P=`${P}(?=[${u}]|[^\\p{M}]|$)`),[U,P]},In=function(P){let s=t(this,y,Ci);if(s.length===0)return;const{caseSensitive:w,entireWord:U}=t(this,z),F=this._pageContents[P],it=this._hasDiacritics[P];let ot=!1;typeof s=="string"?[ot,s]=j(this,y,Ti).call(this,s,it):s=s.sort().reverse().map(Mt=>{const[xt,kt]=j(this,y,Ti).call(this,Mt,it);return ot||(ot=xt),`(${kt})`}).join("|");const At=`g${ot?"u":""}${w?"":"i"}`;s=s?new RegExp(s,At):null,j(this,y,Fn).call(this,s,U,P,F),t(this,z).highlightAll&&j(this,y,Be).call(this,P),this._resumePageIdx===P&&(this._resumePageIdx=null,j(this,y,xi).call(this));const dt=this._pageMatches[P].length;this._matchesCountTotal+=dt,t(this,M)?dt>0&&j(this,y,Ri).call(this):++ae(this,Q)._===this._linkService.pagesCount&&j(this,y,Ri).call(this)},Dn=function(){if(this._extractTextPromises.length>0)return;let P=Promise.resolve();const s={disableNormalization:!0};for(let w=0,U=this._linkService.pagesCount;w<U;w++){const F=new N.PromiseCapability;this._extractTextPromises[w]=F.promise,P=P.then(()=>this._pdfDocument.getPage(w+1).then(it=>it.getTextContent(s)).then(it=>{const ot=[];for(const At of it.items)ot.push(At.str),At.hasEOL&&ot.push(`
`);[this._pageContents[w],this._pageDiffs[w],this._hasDiacritics[w]]=W(ot.join("")),F.resolve()},it=>{console.error(`Unable to get text content for page ${w+1}`,it),this._pageContents[w]="",this._pageDiffs[w]=null,this._hasDiacritics[w]=!1,F.resolve()}))}},Be=function(P){this._scrollMatches&&this._selected.pageIdx===P&&(this._linkService.page=P+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:P})},ye=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},ue=function(){const P=t(this,z).findPrevious,s=this._linkService.page-1,w=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=s,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,Z(this,Q,0),this._matchesCountTotal=0,j(this,y,ye).call(this);for(let it=0;it<w;it++)this._pendingFindMatches.has(it)||(this._pendingFindMatches.add(it),this._extractTextPromises[it].then(()=>{this._pendingFindMatches.delete(it),j(this,y,In).call(this,it)}))}if(t(this,y,Ci).length===0){j(this,y,Ae).call(this,x.FOUND);return}if(this._resumePageIdx)return;const F=this._offset;if(this._pagesToSearch=w,F.matchIdx!==null){const it=this._pageMatches[F.pageIdx].length;if(!P&&F.matchIdx+1<it||P&&F.matchIdx>0){F.matchIdx=P?F.matchIdx-1:F.matchIdx+1,j(this,y,Ue).call(this,!0);return}j(this,y,Mi).call(this,P)}j(this,y,xi).call(this)},On=function(P){const s=this._offset,w=P.length,U=t(this,z).findPrevious;return w?(s.matchIdx=U?w-1:0,j(this,y,Ue).call(this,!0),!0):(j(this,y,Mi).call(this,U),s.wrapped&&(s.matchIdx=null,this._pagesToSearch<0)?(j(this,y,Ue).call(this,!1),!0):!1)},xi=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let P=null;do{const s=this._offset.pageIdx;if(P=this._pageMatches[s],!P){this._resumePageIdx=s;break}}while(!j(this,y,On).call(this,P))},Mi=function(P){const s=this._offset,w=this._linkService.pagesCount;s.pageIdx=P?s.pageIdx-1:s.pageIdx+1,s.matchIdx=null,this._pagesToSearch--,(s.pageIdx>=w||s.pageIdx<0)&&(s.pageIdx=P?w-1:0,s.wrapped=!0)},Ue=function(P=!1){let s=x.NOT_FOUND;const w=this._offset.wrapped;if(this._offset.wrapped=!1,P){const U=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,s=w?x.WRAPPED:x.FOUND,U!==-1&&U!==this._selected.pageIdx&&j(this,y,Be).call(this,U)}j(this,y,Ae).call(this,s,t(this,z).findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,j(this,y,Be).call(this,this._selected.pageIdx))},Nn=function(P){const s=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||s&&this._pdfDocument!==s||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),j(this,y,Ae).call(this,x.FOUND),this._highlightMatches=!1,j(this,y,ye).call(this))})},Li=function(){var F;const{pageIdx:P,matchIdx:s}=this._selected;let w=0,U=this._matchesCountTotal;if(s!==-1){for(let it=0;it<P;it++)w+=((F=this._pageMatches[it])==null?void 0:F.length)||0;w+=s+1}return(w<1||w>U)&&(w=U=0),{current:w,total:U}},Ri=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:j(this,y,Li).call(this)})},Ae=function(P,s=!1){var w;!t(this,M)&&(t(this,Q)!==this._linkService.pagesCount||P===x.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:P,previous:s,matchesCount:j(this,y,Li).call(this),rawQuery:((w=t(this,z))==null?void 0:w.query)??null})},V.PDFFindController=B},(et,V)=>{var ct,lt,I,q,nt;Object.defineProperty(V,"__esModule",{value:!0}),V.animationStarted=V.VERTICAL_PADDING=V.UNKNOWN_SCALE=V.TextLayerMode=V.SpreadMode=V.SidebarView=V.ScrollMode=V.SCROLLBAR_PADDING=V.RenderingStates=V.ProgressBar=V.PresentationModeState=V.OutputScale=V.MIN_SCALE=V.MAX_SCALE=V.MAX_AUTO_SCALE=V.DEFAULT_SCALE_VALUE=V.DEFAULT_SCALE_DELTA=V.DEFAULT_SCALE=V.CursorTool=V.AutoPrintRegExp=void 0,V.apiPageLayoutToViewerModes=pt,V.apiPageModeToSidebarView=vt,V.approximateFraction=z,V.backtrackBeforeAllVisibleElements=y,V.binarySearchFirstItem=B,V.docStyle=void 0,V.getActiveOrFocusedElement=ft,V.getPageSizeInches=Q,V.getVisibleElements=C,V.isPortraitOrientation=Y,V.isValidRotation=l,V.isValidScrollMode=h,V.isValidSpreadMode=A,V.normalizeWheelEventDelta=O,V.normalizeWheelEventDirection=rt,V.parseQueryString=E,V.removeNullCharacters=D,V.roundToDivide=M,V.scrollIntoView=T,V.toggleCheckedBtn=Et,V.toggleExpandedBtn=Pt,V.watchScroll=o;const R="auto";V.DEFAULT_SCALE_VALUE=R;const f=1;V.DEFAULT_SCALE=f;const a=1.1;V.DEFAULT_SCALE_DELTA=a;const N=.1;V.MIN_SCALE=N;const x=10;V.MAX_SCALE=x;const p=0;V.UNKNOWN_SCALE=p;const c=1.25;V.MAX_AUTO_SCALE=c;const v=40;V.SCROLLBAR_PADDING=v;const b=5;V.VERTICAL_PADDING=b;const m={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};V.RenderingStates=m;const u={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};V.PresentationModeState=u;const _={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};V.SidebarView=_;const g={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};V.TextLayerMode=g;const i={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};V.ScrollMode=i;const e={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};V.SpreadMode=e;const n={SELECT:0,HAND:1,ZOOM:2};V.CursorTool=n;const r=/\bprint\s*\(/;V.AutoPrintRegExp=r;class d{constructor(){const s=window.devicePixelRatio||1;this.sx=s,this.sy=s}get scaled(){return this.sx!==1||this.sy!==1}}V.OutputScale=d;function T(P,s,w=!1){let U=P.offsetParent;if(!U){console.error("offsetParent is not set -- cannot scroll");return}let F=P.offsetTop+P.clientTop,it=P.offsetLeft+P.clientLeft;for(;U.clientHeight===U.scrollHeight&&U.clientWidth===U.scrollWidth||w&&(U.classList.contains("markedContent")||getComputedStyle(U).overflow==="hidden");)if(F+=U.offsetTop,it+=U.offsetLeft,U=U.offsetParent,!U)return;s&&(s.top!==void 0&&(F+=s.top),s.left!==void 0&&(it+=s.left,U.scrollLeft=it)),U.scrollTop=F}function o(P,s){const w=function(it){F||(F=window.requestAnimationFrame(function(){F=null;const At=P.scrollLeft,dt=U.lastX;At!==dt&&(U.right=At>dt),U.lastX=At;const Mt=P.scrollTop,xt=U.lastY;Mt!==xt&&(U.down=Mt>xt),U.lastY=Mt,s(U)}))},U={right:!0,down:!0,lastX:P.scrollLeft,lastY:P.scrollTop,_eventHandler:w};let F=null;return P.addEventListener("scroll",w,!0),U}function E(P){const s=new Map;for(const[w,U]of new URLSearchParams(P))s.set(w.toLowerCase(),U);return s}const W=/[\x01-\x1F]/g;function D(P,s=!1){return typeof P!="string"?(console.error("The argument must be a string."),P):(s&&(P=P.replaceAll(W," ")),P.replaceAll("\0",""))}function B(P,s,w=0){let U=w,F=P.length-1;if(F<0||!s(P[F]))return P.length;if(s(P[U]))return U;for(;U<F;){const it=U+F>>1,ot=P[it];s(ot)?F=it:U=it+1}return U}function z(P){if(Math.floor(P)===P)return[P,1];const s=1/P,w=8;if(s>w)return[1,w];if(Math.floor(s)===s)return[1,s];const U=P>1?s:P;let F=0,it=1,ot=1,At=1;for(;;){const Mt=F+ot,xt=it+At;if(xt>w)break;U<=Mt/xt?(ot=Mt,At=xt):(F=Mt,it=xt)}let dt;return U-F/it<ot/At-U?dt=U===P?[F,it]:[it,F]:dt=U===P?[ot,At]:[At,ot],dt}function M(P,s){const w=P%s;return w===0?P:Math.round(P-w+s)}function Q({view:P,userUnit:s,rotate:w}){const[U,F,it,ot]=P,At=w%180!==0,dt=(it-U)/72*s,Mt=(ot-F)/72*s;return{width:At?Mt:dt,height:At?dt:Mt}}function y(P,s,w){if(P<2)return P;let U=s[P].div,F=U.offsetTop+U.clientTop;F>=w&&(U=s[P-1].div,F=U.offsetTop+U.clientTop);for(let it=P-2;it>=0&&(U=s[it].div,!(U.offsetTop+U.clientTop+U.clientHeight<=F));--it)P=it;return P}function C({scrollEl:P,views:s,sortByVisibility:w=!1,horizontal:U=!1,rtl:F=!1}){const it=P.scrollTop,ot=it+P.clientHeight,At=P.scrollLeft,dt=At+P.clientWidth;function Mt(Wt){const Ht=Wt.div;return Ht.offsetTop+Ht.clientTop+Ht.clientHeight>it}function xt(Wt){const Ht=Wt.div,X=Ht.offsetLeft+Ht.clientLeft,gt=X+Ht.clientWidth;return F?X<dt:gt>At}const kt=[],jt=new Set,$t=s.length;let St=B(s,U?xt:Mt);St>0&&St<$t&&!U&&(St=y(St,s,it));let ht=U?dt:-1;for(let Wt=St;Wt<$t;Wt++){const Ht=s[Wt],X=Ht.div,gt=X.offsetLeft+X.clientLeft,Lt=X.offsetTop+X.clientTop,Dt=X.clientWidth,Ot=X.clientHeight,Rt=gt+Dt,$=Lt+Ot;if(ht===-1)$>=ot&&(ht=$);else if((U?gt:Lt)>ht)break;if($<=it||Lt>=ot||Rt<=At||gt>=dt)continue;const H=Math.max(0,it-Lt)+Math.max(0,$-ot),st=Math.max(0,At-gt)+Math.max(0,Rt-dt),_t=(Ot-H)/Ot,yt=(Dt-st)/Dt,wt=_t*yt*100|0;kt.push({id:Ht.id,x:gt,y:Lt,view:Ht,percent:wt,widthPercent:yt*100|0}),jt.add(Ht.id)}const ut=kt[0],Ft=kt.at(-1);return w&&kt.sort(function(Wt,Ht){const X=Wt.percent-Ht.percent;return Math.abs(X)>.001?-X:Wt.id-Ht.id}),{first:ut,last:Ft,views:kt,ids:jt}}function rt(P){let s=Math.hypot(P.deltaX,P.deltaY);const w=Math.atan2(P.deltaY,P.deltaX);return-.25*Math.PI<w&&w<.75*Math.PI&&(s=-s),s}function O(P){const s=P.deltaMode;let w=rt(P);const U=30,F=30;return s===WheelEvent.DOM_DELTA_PIXEL?w/=U*F:s===WheelEvent.DOM_DELTA_LINE&&(w/=F),w}function l(P){return Number.isInteger(P)&&P%90===0}function h(P){return Number.isInteger(P)&&Object.values(i).includes(P)&&P!==i.UNKNOWN}function A(P){return Number.isInteger(P)&&Object.values(e).includes(P)&&P!==e.UNKNOWN}function Y(P){return P.width<=P.height}const K=new Promise(function(P){window.requestAnimationFrame(P)});V.animationStarted=K;const k=document.documentElement.style;V.docStyle=k;function J(P,s,w){return Math.min(Math.max(P,s),w)}class at{constructor(s){tt(this,ct,null);tt(this,lt,null);tt(this,I,0);tt(this,q,null);tt(this,nt,!0);Z(this,ct,s.classList),Z(this,q,s.style)}get percent(){return t(this,I)}set percent(s){if(Z(this,I,J(s,0,100)),isNaN(s)){t(this,ct).add("indeterminate");return}t(this,ct).remove("indeterminate"),t(this,q).setProperty("--progressBar-percent",`${t(this,I)}%`)}setWidth(s){if(!s)return;const U=s.parentNode.offsetWidth-s.offsetWidth;U>0&&t(this,q).setProperty("--progressBar-end-offset",`${U}px`)}setDisableAutoFetch(s=5e3){isNaN(t(this,I))||(t(this,lt)&&clearTimeout(t(this,lt)),this.show(),Z(this,lt,setTimeout(()=>{Z(this,lt,null),this.hide()},s)))}hide(){t(this,nt)&&(Z(this,nt,!1),t(this,ct).add("hidden"))}show(){t(this,nt)||(Z(this,nt,!0),t(this,ct).remove("hidden"))}}ct=new WeakMap,lt=new WeakMap,I=new WeakMap,q=new WeakMap,nt=new WeakMap,V.ProgressBar=at;function ft(){let P=document,s=P.activeElement||P.querySelector(":focus");for(;s!=null&&s.shadowRoot;)P=s.shadowRoot,s=P.activeElement||P.querySelector(":focus");return s}function pt(P){let s=i.VERTICAL,w=e.NONE;switch(P){case"SinglePage":s=i.PAGE;break;case"OneColumn":break;case"TwoPageLeft":s=i.PAGE;case"TwoColumnLeft":w=e.ODD;break;case"TwoPageRight":s=i.PAGE;case"TwoColumnRight":w=e.EVEN;break}return{scrollMode:s,spreadMode:w}}function vt(P){switch(P){case"UseNone":return _.NONE;case"UseThumbs":return _.THUMBS;case"UseOutlines":return _.OUTLINE;case"UseAttachments":return _.ATTACHMENTS;case"UseOC":return _.LAYERS}return _.NONE}function Et(P,s,w=null){P.classList.toggle("toggled",s),P.setAttribute("aria-checked",s),w==null||w.classList.toggle("hidden",!s)}function Pt(P,s,w=null){P.classList.toggle("toggled",s),P.setAttribute("aria-expanded",s),w==null||w.classList.toggle("hidden",!s)}},(et,V)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.CharacterType=void 0,V.getCharacterType=_,V.getNormalizeWithNFKC=i;const R={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};V.CharacterType=R;function f(e){return e<11904}function a(e){return(e&65408)===0}function N(e){return e>=97&&e<=122||e>=65&&e<=90}function x(e){return e>=48&&e<=57}function p(e){return e===32||e===9||e===13||e===10}function c(e){return e>=13312&&e<=40959||e>=63744&&e<=64255}function v(e){return e>=12448&&e<=12543}function b(e){return e>=12352&&e<=12447}function m(e){return e>=65376&&e<=65439}function u(e){return(e&65408)===3584}function _(e){return f(e)?a(e)?p(e)?R.SPACE:N(e)||x(e)||e===95?R.ALPHA_LETTER:R.PUNCT:u(e)?R.THAI_LETTER:e===160?R.SPACE:R.ALPHA_LETTER:c(e)?R.HAN_LETTER:v(e)?R.KATAKANA_LETTER:b(e)?R.HIRAGANA_LETTER:m(e)?R.HALFWIDTH_KATAKANA_LETTER:R.ALPHA_LETTER}let g;function i(){return g||(g=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦"),g}},et=>{et.exports=globalThis.pdfjsLib},(et,V,R)=>{var v,b,ki,u,Bn;Object.defineProperty(V,"__esModule",{value:!0}),V.SimpleLinkService=V.PDFLinkService=V.LinkTarget=void 0;var f=R(2);const a="noopener noreferrer nofollow",N={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};V.LinkTarget=N;function x(i,{url:e,target:n,rel:r,enabled:d=!0}={}){if(!e||typeof e!="string")throw new Error('A valid "url" parameter must provided.');d?i.href=i.title=e:(i.href="",i.title=`Disabled: ${e}`,i.onclick=()=>!1);let T="";switch(n){case N.NONE:break;case N.SELF:T="_self";break;case N.BLANK:T="_blank";break;case N.PARENT:T="_parent";break;case N.TOP:T="_top";break}i.target=T,i.rel=typeof r=="string"?r:a}const g=class g{constructor({eventBus:e,externalLinkTarget:n=null,externalLinkRel:r=null,ignoreDestinationZoom:d=!1}={}){tt(this,b);tt(this,v,new Map);this.eventBus=e,this.externalLinkTarget=n,this.externalLinkRel=r,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=d,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,n=null){this.baseUrl=n,this.pdfDocument=e,t(this,v).clear()}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(e){this.pdfViewer.currentPageNumber=e}get rotation(){return this.pdfViewer.pagesRotation}set rotation(e){this.pdfViewer.pagesRotation=e}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}async goToDestination(e){if(!this.pdfDocument)return;let n,r;if(typeof e=="string"?(n=e,r=await this.pdfDocument.getDestination(e)):(n=null,r=await e),!Array.isArray(r)){console.error(`PDFLinkService.goToDestination: "${r}" is not a valid destination array, for dest="${e}".`);return}j(this,b,ki).call(this,e,n,r)}goToPage(e){if(!this.pdfDocument)return;const n=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(n)&&n>0&&n<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(n)),this.pdfViewer.scrollPageIntoView({pageNumber:n})}addLinkAttributes(e,n,r=!1){x(e,{url:n,target:r?N.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){const n=JSON.stringify(e);if(n.length>0)return this.getAnchorUrl("#"+escape(n))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){var d;if(!this.pdfDocument)return;let n,r;if(e.includes("=")){const T=(0,f.parseQueryString)(e);if(T.has("search")){const o=T.get("search").replaceAll('"',""),E=T.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:E?o:o.match(/\S+/g)})}if(T.has("page")&&(n=T.get("page")|0||1),T.has("zoom")){const o=T.get("zoom").split(","),E=o[0],W=parseFloat(E);E.includes("Fit")?E==="Fit"||E==="FitB"?r=[null,{name:E}]:E==="FitH"||E==="FitBH"||E==="FitV"||E==="FitBV"?r=[null,{name:E},o.length>1?o[1]|0:null]:E==="FitR"?o.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):r=[null,{name:E},o[1]|0,o[2]|0,o[3]|0,o[4]|0]:console.error(`PDFLinkService.setHash: "${E}" is not a valid zoom value.`):r=[null,{name:"XYZ"},o.length>1?o[1]|0:null,o.length>2?o[2]|0:null,W?W/100:E]}r?this.pdfViewer.scrollPageIntoView({pageNumber:n||this.page,destArray:r,allowNegativeOffset:!0}):n&&(this.page=n),T.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:T.get("pagemode")}),T.has("nameddest")&&this.goToDestination(T.get("nameddest"))}else{r=unescape(e);try{r=JSON.parse(r),Array.isArray(r)||(r=r.toString())}catch{}if(typeof r=="string"||j(d=g,u,Bn).call(d,r)){this.goToDestination(r);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}}executeNamedAction(e){var n,r;switch(e){case"GoBack":(n=this.pdfHistory)==null||n.back();break;case"GoForward":(r=this.pdfHistory)==null||r.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:e})}async executeSetOCGState(e){const n=this.pdfDocument,r=await this.pdfViewer.optionalContentConfigPromise;if(n!==this.pdfDocument)return;let d;for(const T of e.state){switch(T){case"ON":case"OFF":case"Toggle":d=T;continue}switch(d){case"ON":r.setVisibility(T,!0);break;case"OFF":r.setVisibility(T,!1);break;case"Toggle":const o=r.getGroup(T);o&&r.setVisibility(T,!o.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(r)}cachePageRef(e,n){if(!n)return;const r=n.gen===0?`${n.num}R`:`${n.num}R${n.gen}`;t(this,v).set(r,e)}_cachedPageNumber(e){if(!e)return null;const n=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return t(this,v).get(n)||null}};v=new WeakMap,b=new WeakSet,ki=function(e,n=null,r){const d=r[0];let T;if(typeof d=="object"&&d!==null){if(T=this._cachedPageNumber(d),!T){this.pdfDocument.getPageIndex(d).then(o=>{this.cachePageRef(o+1,d),j(this,b,ki).call(this,e,n,r)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${d}" is not a valid page reference, for dest="${e}".`)});return}}else if(Number.isInteger(d))T=d+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${d}" is not a valid destination reference, for dest="${e}".`);return}if(!T||T<1||T>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${T}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:n,explicitDest:r,pageNumber:T})),this.pdfViewer.scrollPageIntoView({pageNumber:T,destArray:r,ignoreDestinationZoom:this._ignoreDestinationZoom})},u=new WeakSet,Bn=function(e){if(!Array.isArray(e))return!1;const n=e.length;if(n<2)return!1;const r=e[0];if(!(typeof r=="object"&&Number.isInteger(r.num)&&Number.isInteger(r.gen))&&!(Number.isInteger(r)&&r>=0))return!1;const d=e[1];if(!(typeof d=="object"&&typeof d.name=="string"))return!1;let T=!0;switch(d.name){case"XYZ":if(n!==5)return!1;break;case"Fit":case"FitB":return n===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(n!==3)return!1;break;case"FitR":if(n!==6)return!1;T=!1;break;default:return!1}for(let o=2;o<n;o++){const E=e[o];if(!(typeof E=="number"||T&&E===null))return!1}return!0},tt(g,u);let p=g;V.PDFLinkService=p;class c{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(e){}get rotation(){return 0}set rotation(e){}get isInPresentationMode(){return!1}async goToDestination(e){}goToPage(e){}addLinkAttributes(e,n,r=!1){x(e,{url:n,enabled:this.externalLinkEnabled})}getDestinationHash(e){return"#"}getAnchorUrl(e){return"#"}setHash(e){}executeNamedAction(e){}executeSetOCGState(e){}cachePageRef(e,n){}}V.SimpleLinkService=c},(et,V,R)=>{var p,c,Fi;Object.defineProperty(V,"__esModule",{value:!0}),V.AnnotationLayerBuilder=void 0;var f=R(4),a=R(7),N=R(2);class x{constructor({pageDiv:m,pdfPage:u,linkService:_,downloadManager:g,annotationStorage:i=null,imageResourcesPath:e="",renderForms:n=!0,l10n:r=a.NullL10n,enableScripting:d=!1,hasJSActionsPromise:T=null,fieldObjectsPromise:o=null,annotationCanvasMap:E=null,accessibilityManager:W=null}){tt(this,c);tt(this,p,null);this.pageDiv=m,this.pdfPage=u,this.linkService=_,this.downloadManager=g,this.imageResourcesPath=e,this.renderForms=n,this.l10n=r,this.annotationStorage=i,this.enableScripting=d,this._hasJSActionsPromise=T||Promise.resolve(!1),this._fieldObjectsPromise=o||Promise.resolve(null),this._annotationCanvasMap=E,this._accessibilityManager=W,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=_.eventBus}async render(m,u="display"){var n;if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:m.clone({dontFlip:!0})});return}const[_,g,i]=await Promise.all([this.pdfPage.getAnnotations({intent:u}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const e=this.div=document.createElement("div");if(e.className="annotationLayer",this.pageDiv.append(e),_.length===0){this.hide();return}this.annotationLayer=new f.AnnotationLayer({div:e,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,l10n:this.l10n,page:this.pdfPage,viewport:m.clone({dontFlip:!0})}),await this.annotationLayer.render({annotations:_,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:g,fieldObjects:i}),this.linkService.isInPresentationMode&&j(this,c,Fi).call(this,N.PresentationModeState.FULLSCREEN),t(this,p)||(Z(this,p,r=>{j(this,c,Fi).call(this,r.state)}),(n=this._eventBus)==null||n._on("presentationmodechanged",t(this,p)))}cancel(){var m;this._cancelled=!0,t(this,p)&&((m=this._eventBus)==null||m._off("presentationmodechanged",t(this,p)),Z(this,p,null))}hide(){this.div&&(this.div.hidden=!0)}}p=new WeakMap,c=new WeakSet,Fi=function(m){if(!this.div)return;let u=!1;switch(m){case N.PresentationModeState.FULLSCREEN:u=!0;break;case N.PresentationModeState.NORMAL:break;default:return}for(const _ of this.div.childNodes)_.hasAttribute("data-internal-link")||(_.inert=u)},V.AnnotationLayerBuilder=x},(et,V)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.NullL10n=void 0,V.getL10nFallback=f;const R={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};R.print_progress_percent="{{progress}}%";function f(x,p){switch(x){case"find_match_count":x=`find_match_count[${p.total===1?"one":"other"}]`;break;case"find_match_count_limit":x=`find_match_count_limit[${p.limit===1?"one":"other"}]`;break}return R[x]||""}function a(x,p){return p?x.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(c,v)=>v in p?p[v]:"{{"+v+"}}"):x}const N={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(x,p=null,c=f(x,p)){return a(c,p)},async translate(x){}};V.NullL10n=N},(et,V,R)=>{var x;Object.defineProperty(V,"__esModule",{value:!0}),V.DownloadManager=void 0;var f=R(4);function a(p,c){const v=document.createElement("a");if(!v.click)throw new Error('DownloadManager: "a.click()" is not supported.');v.href=p,v.target="_parent","download"in v&&(v.download=c),(document.body||document.documentElement).append(v),v.click(),v.remove()}class N{constructor(){tt(this,x,new WeakMap)}downloadUrl(c,v,b){if(!(0,f.createValidAbsoluteUrl)(c,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${c}`);return}a(c+"#pdfjs.action=download",v)}downloadData(c,v,b){const m=URL.createObjectURL(new Blob([c],{type:b}));a(m,v)}openOrDownloadData(c,v,b){const u=(0,f.isPdfFile)(b)?"application/pdf":"";return this.downloadData(v,b,u),!1}download(c,v,b,m){const u=URL.createObjectURL(c);a(u,b)}}x=new WeakMap,V.DownloadManager=N},(et,V)=>{var x;Object.defineProperty(V,"__esModule",{value:!0}),V.WaitOnType=V.EventBus=V.AutomationEventBus=void 0,V.waitOnEventOrTimeout=f;const R={EVENT:"event",TIMEOUT:"timeout"};V.WaitOnType=R;function f({target:p,name:c,delay:v=0}){return new Promise(function(b,m){if(typeof p!="object"||!(c&&typeof c=="string")||!(Number.isInteger(v)&&v>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function u(e){p instanceof a?p._off(c,_):p.removeEventListener(c,_),i&&clearTimeout(i),b(e)}const _=u.bind(null,R.EVENT);p instanceof a?p._on(c,_):p.addEventListener(c,_);const g=u.bind(null,R.TIMEOUT),i=setTimeout(g,v)})}class a{constructor(){tt(this,x,Object.create(null))}on(c,v,b=null){this._on(c,v,{external:!0,once:b==null?void 0:b.once})}off(c,v,b=null){this._off(c,v,{external:!0,once:b==null?void 0:b.once})}dispatch(c,v){const b=t(this,x)[c];if(!b||b.length===0)return;let m;for(const{listener:u,external:_,once:g}of b.slice(0)){if(g&&this._off(c,u),_){(m||(m=[])).push(u);continue}u(v)}if(m){for(const u of m)u(v);m=null}}_on(c,v,b=null){var u;((u=t(this,x))[c]||(u[c]=[])).push({listener:v,external:(b==null?void 0:b.external)===!0,once:(b==null?void 0:b.once)===!0})}_off(c,v,b=null){const m=t(this,x)[c];if(m){for(let u=0,_=m.length;u<_;u++)if(m[u].listener===v){m.splice(u,1);return}}}}x=new WeakMap,V.EventBus=a;class N extends a{dispatch(c,v){throw new Error("Not implemented: AutomationEventBus.dispatch")}}V.AutomationEventBus=N},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.GenericL10n=void 0,R(11);var f=R(7);const a={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function N(p){return a[p==null?void 0:p.toLowerCase()]||p}class x{constructor(c){const{webL10n:v}=document;this._lang=c,this._ready=new Promise((b,m)=>{v.setLanguage(N(c),()=>{b(v)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(c,v=null,b=(0,f.getL10nFallback)(c,v)){return(await this._ready).get(c,v,b)}async translate(c){return(await this._ready).translate(c)}}V.GenericL10n=x},()=>{document.webL10n=function(et,V){var R={},f="",a="textContent",N="",x={},p="loading",c=!0;function v(){return V.querySelectorAll('link[type="application/l10n"]')}function b(){var D=V.querySelector('script[type="application/l10n"]');return D?JSON.parse(D.innerHTML):null}function m(D){return D?D.querySelectorAll("*[data-l10n-id]"):[]}function u(D){if(!D)return{};var B=D.getAttribute("data-l10n-id"),z=D.getAttribute("data-l10n-args"),M={};if(z)try{M=JSON.parse(z)}catch{console.warn("could not parse arguments for #"+B)}return{id:B,args:M}}function _(D,B,z){B=B||function(y){},z=z||function(){};var M=new XMLHttpRequest;M.open("GET",D,c),M.overrideMimeType&&M.overrideMimeType("text/plain; charset=utf-8"),M.onreadystatechange=function(){M.readyState==4&&(M.status==200||M.status===0?B(M.responseText):z())},M.onerror=z,M.ontimeout=z;try{M.send(null)}catch{z()}}function g(D,B,z,M){var Q=D.replace(/[^\/]*$/,"")||"./";function y(rt){return rt.lastIndexOf("\\")<0?rt:rt.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function C(rt,O){var l={},h=/^\s*|\s*$/,A=/^\s*#|^\s*$/,Y=/^\s*\[(.*)\]\s*$/,K=/^\s*@import\s+url\((.*)\)\s*$/i,k=/^([^=\s]*)\s*=\s*(.+)$/;function J(ft,pt,vt){var Et=ft.replace(h,"").split(/[\r\n]+/),Pt="*",ct=B.split("-",1)[0],lt=!1,I="";function q(){for(;;){if(!Et.length){vt();return}var nt=Et.shift();if(!A.test(nt)){if(pt){if(I=Y.exec(nt),I){Pt=I[1].toLowerCase(),lt=Pt!=="*"&&Pt!==B&&Pt!==ct;continue}else if(lt)continue;if(I=K.exec(nt),I){at(Q+I[1],q);return}}var P=nt.match(k);P&&P.length==3&&(l[P[1]]=y(P[2]))}}}q()}function at(ft,pt){_(ft,function(vt){J(vt,!1,pt)},function(){console.warn(ft+" not found."),pt()})}J(rt,!0,function(){O(l)})}_(D,function(rt){f+=rt,C(rt,function(O){for(var l in O){var h,A,Y=l.lastIndexOf(".");Y>0?(h=l.substring(0,Y),A=l.substring(Y+1)):(h=l,A=a),R[h]||(R[h]={}),R[h][A]=O[l]}z&&z()})},M)}function i(D,B){D&&(D=D.toLowerCase()),B=B||function(){},e(),N=D;var z=v(),M=z.length;if(M===0){var Q=b();if(Q&&Q.locales&&Q.default_locale){if(console.log("using the embedded JSON directory, early way out"),R=Q.locales[D],!R){var y=Q.default_locale.toLowerCase();for(var C in Q.locales)if(C=C.toLowerCase(),C===D){R=Q.locales[D];break}else C===y&&(R=Q.locales[y])}B()}else console.log("no resource to load, early way out");p="complete";return}var rt=null,O=0;rt=function(){O++,O>=M&&(B(),p="complete")};function l(Y){var K=Y.href;this.load=function(k,J){g(K,k,J,function(){console.warn(K+" not found."),console.warn('"'+k+'" resource not found'),N="",J()})}}for(var h=0;h<M;h++){var A=new l(z[h]);A.load(D,rt)}}function e(){R={},f="",N=""}function n(D){var B={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function z(C,rt){return rt.indexOf(C)!==-1}function M(C,rt,O){return rt<=C&&C<=O}var Q={0:function(C){return"other"},1:function(C){return M(C%100,3,10)?"few":C===0?"zero":M(C%100,11,99)?"many":C==2?"two":C==1?"one":"other"},2:function(C){return C!==0&&C%10===0?"many":C==2?"two":C==1?"one":"other"},3:function(C){return C==1?"one":"other"},4:function(C){return M(C,0,1)?"one":"other"},5:function(C){return M(C,0,2)&&C!=2?"one":"other"},6:function(C){return C===0?"zero":C%10==1&&C%100!=11?"one":"other"},7:function(C){return C==2?"two":C==1?"one":"other"},8:function(C){return M(C,3,6)?"few":M(C,7,10)?"many":C==2?"two":C==1?"one":"other"},9:function(C){return C===0||C!=1&&M(C%100,1,19)?"few":C==1?"one":"other"},10:function(C){return M(C%10,2,9)&&!M(C%100,11,19)?"few":C%10==1&&!M(C%100,11,19)?"one":"other"},11:function(C){return M(C%10,2,4)&&!M(C%100,12,14)?"few":C%10===0||M(C%10,5,9)||M(C%100,11,14)?"many":C%10==1&&C%100!=11?"one":"other"},12:function(C){return M(C,2,4)?"few":C==1?"one":"other"},13:function(C){return M(C%10,2,4)&&!M(C%100,12,14)?"few":C!=1&&M(C%10,0,1)||M(C%10,5,9)||M(C%100,12,14)?"many":C==1?"one":"other"},14:function(C){return M(C%100,3,4)?"few":C%100==2?"two":C%100==1?"one":"other"},15:function(C){return C===0||M(C%100,2,10)?"few":M(C%100,11,19)?"many":C==1?"one":"other"},16:function(C){return C%10==1&&C!=11?"one":"other"},17:function(C){return C==3?"few":C===0?"zero":C==6?"many":C==2?"two":C==1?"one":"other"},18:function(C){return C===0?"zero":M(C,0,2)&&C!==0&&C!=2?"one":"other"},19:function(C){return M(C,2,10)?"few":M(C,0,1)?"one":"other"},20:function(C){return(M(C%10,3,4)||C%10==9)&&!(M(C%100,10,19)||M(C%100,70,79)||M(C%100,90,99))?"few":C%1e6===0&&C!==0?"many":C%10==2&&!z(C%100,[12,72,92])?"two":C%10==1&&!z(C%100,[11,71,91])?"one":"other"},21:function(C){return C===0?"zero":C==1?"one":"other"},22:function(C){return M(C,0,1)||M(C,11,99)?"one":"other"},23:function(C){return M(C%10,1,2)||C%20===0?"one":"other"},24:function(C){return M(C,3,10)||M(C,13,19)?"few":z(C,[2,12])?"two":z(C,[1,11])?"one":"other"}},y=B[D.replace(/-.*$/,"")];return y in Q?Q[y]:(console.warn("plural form unknown for ["+D+"]"),function(){return"other"})}x.plural=function(D,B,z,M){var Q=parseFloat(B);if(isNaN(Q)||M!=a)return D;x._pluralRules||(x._pluralRules=n(N));var y="["+x._pluralRules(Q)+"]";return Q===0&&z+"[zero]"in R?D=R[z+"[zero]"][M]:Q==1&&z+"[one]"in R?D=R[z+"[one]"][M]:Q==2&&z+"[two]"in R?D=R[z+"[two]"][M]:z+y in R?D=R[z+y][M]:z+"[other]"in R&&(D=R[z+"[other]"][M]),D};function r(D,B,z){var M=R[D];if(!M){if(console.warn("#"+D+" is undefined."),!z)return null;M=z}var Q={};for(var y in M){var C=M[y];C=d(C,B,D,y),C=T(C,B,D),Q[y]=C}return Q}function d(D,B,z,M){var Q=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,y=Q.exec(D);if(!y||!y.length)return D;var C=y[1],rt=y[2],O;if(B&&rt in B?O=B[rt]:rt in R&&(O=R[rt]),C in x){var l=x[C];D=l(D,O,z,M)}return D}function T(D,B,z){var M=/\{\{\s*(.+?)\s*\}\}/g;return D.replace(M,function(Q,y){return B&&y in B?B[y]:y in R?R[y]:(console.log("argument {{"+y+"}} for #"+z+" is undefined."),Q)})}function o(D){var B=u(D);if(B.id){var z=r(B.id,B.args);if(!z){console.warn("#"+B.id+" is undefined.");return}if(z[a]){if(E(D)===0)D[a]=z[a];else{for(var M=D.childNodes,Q=!1,y=0,C=M.length;y<C;y++)M[y].nodeType===3&&/\S/.test(M[y].nodeValue)&&(Q?M[y].nodeValue="":(M[y].nodeValue=z[a],Q=!0));if(!Q){var rt=V.createTextNode(z[a]);D.prepend(rt)}}delete z[a]}for(var O in z)D[O]=z[O]}}function E(D){if(D.children)return D.children.length;if(typeof D.childElementCount<"u")return D.childElementCount;for(var B=0,z=0;z<D.childNodes.length;z++)B+=D.nodeType===1?1:0;return B}function W(D){D=D||V.documentElement;for(var B=m(D),z=B.length,M=0;M<z;M++)o(B[M]);o(D)}return{get:function(D,B,z){var M=D.lastIndexOf("."),Q=a;M>0&&(Q=D.substring(M+1),D=D.substring(0,M));var y;z&&(y={},y[Q]=z);var C=r(D,B,y);return C&&Q in C?C[Q]:"{{"+D+"}}"},getData:function(){return R},getText:function(){return f},getLanguage:function(){return N},setLanguage:function(D,B){i(D,function(){B&&B()})},getDirection:function(){var D=["ar","he","fa","ps","ur"],B=N.split("-",1)[0];return D.indexOf(B)>=0?"rtl":"ltr"},translate:W,getReadyState:function(){return p},ready:function(D){if(D)p=="complete"||p=="interactive"?et.setTimeout(function(){D()}):V.addEventListener&&V.addEventListener("localized",function B(){V.removeEventListener("localized",B),D()});else return}}}(window,document)},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.PDFHistory=void 0,V.isDestArraysEqual=m,V.isDestHashesEqual=b;var f=R(2),a=R(9);const N=1e3,x=50,p=1e3;function c(){return document.location.hash}class v{constructor({linkService:_,eventBus:g}){this.linkService=_,this.eventBus=g,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",i=>{this._isPagesLoaded=!!i.pagesCount},{once:!0})})}initialize({fingerprint:_,resetHistory:g=!1,updateUrl:i=!1}){if(!_||typeof _!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const e=this._fingerprint!==""&&this._fingerprint!==_;this._fingerprint=_,this._updateUrl=i===!0,this._initialized=!0,this._bindEvents();const n=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=c(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(n,!0)||g){const{hash:d,page:T,rotation:o}=this._parseCurrentHash(!0);if(!d||e||g){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:d,page:T,rotation:o},!0);return}const r=n.destination;this._updateInternalState(r,n.uid,!0),r.rotation!==void 0&&(this._initialRotation=r.rotation),r.dest?(this._initialBookmark=JSON.stringify(r.dest),this._destination.page=null):r.hash?this._initialBookmark=r.hash:r.page&&(this._initialBookmark=`page=${r.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:_=null,explicitDest:g,pageNumber:i}){if(!this._initialized)return;if(_&&typeof _!="string"){console.error(`PDFHistory.push: "${_}" is not a valid namedDest parameter.`);return}else if(Array.isArray(g)){if(!this._isValidPage(i)&&(i!==null||this._destination)){console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${g}" is not a valid explicitDest parameter.`);return}const e=_||JSON.stringify(g);if(!e)return;let n=!1;if(this._destination&&(b(this._destination.hash,e)||m(this._destination.dest,g))){if(this._destination.page)return;n=!0}this._popStateInProgress&&!n||(this._pushOrReplaceState({dest:g,hash:e,page:i,rotation:this.linkService.rotation},n),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(_){var g;if(this._initialized){if(!this._isValidPage(_)){console.error(`PDFHistory.pushPage: "${_}" is not a valid page number.`);return}((g=this._destination)==null?void 0:g.page)!==_&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${_}`,page:_,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const _=window.history.state;this._isValidState(_)&&_.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const _=window.history.state;this._isValidState(_)&&_.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(_,g=!1){const i=g||!this._destination,e={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:_};this._updateInternalState(_,e.uid);let n;if(this._updateUrl&&(_!=null&&_.hash)){const r=document.location.href.split("#")[0];r.startsWith("file://")||(n=`${r}#${_.hash}`)}i?window.history.replaceState(e,"",n):window.history.pushState(e,"",n)}_tryPushCurrentPosition(_=!1){if(!this._position)return;let g=this._position;if(_&&(g=Object.assign(Object.create(null),this._position),g.temporary=!0),!this._destination){this._pushOrReplaceState(g);return}if(this._destination.temporary){this._pushOrReplaceState(g,!0);return}if(this._destination.hash===g.hash||!this._destination.page&&this._numPositionUpdates<=x)return;let i=!1;if(this._destination.page>=g.first&&this._destination.page<=g.page){if(this._destination.dest!==void 0||!this._destination.first)return;i=!0}this._pushOrReplaceState(g,i)}_isValidPage(_){return Number.isInteger(_)&&_>0&&_<=this.linkService.pagesCount}_isValidState(_,g=!1){if(!_)return!1;if(_.fingerprint!==this._fingerprint)if(g){if(typeof _.fingerprint!="string"||_.fingerprint.length!==this._fingerprint.length)return!1;const[i]=performance.getEntriesByType("navigation");if((i==null?void 0:i.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(_.uid)||_.uid<0||_.destination===null||typeof _.destination!="object")}_updateInternalState(_,g,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&(_!=null&&_.temporary)&&delete _.temporary,this._destination=_,this._uid=g,this._maxUid=Math.max(this._maxUid,g),this._numPositionUpdates=0}_parseCurrentHash(_=!1){const g=unescape(c()).substring(1),i=(0,f.parseQueryString)(g),e=i.get("nameddest")||"";let n=i.get("page")|0;return(!this._isValidPage(n)||_&&e.length>0)&&(n=null),{hash:g,page:n,rotation:this.linkService.rotation}}_updateViewarea({location:_}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:_.pdfOpenParams.substring(1),page:this.linkService.page,first:_.pageNumber,rotation:_.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},p))}_popState({state:_}){const g=c(),i=this._currentHash!==g;if(this._currentHash=g,!_){this._uid++;const{hash:n,page:r,rotation:d}=this._parseCurrentHash();this._pushOrReplaceState({hash:n,page:r,rotation:d},!0);return}if(!this._isValidState(_))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,(0,a.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:N}).then(()=>{this._blockHashChange--}));const e=_.destination;this._updateInternalState(e,_.uid,!0),(0,f.isValidRotation)(e.rotation)&&(this.linkService.rotation=e.rotation),e.dest?this.linkService.goToDestination(e.dest):e.hash?this.linkService.setHash(e.hash):e.page&&(this.linkService.page=e.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}V.PDFHistory=v;function b(u,_){return typeof u!="string"||typeof _!="string"?!1:u===_||(0,f.parseQueryString)(u).get("nameddest")===_}function m(u,_){function g(i,e){if(typeof i!=typeof e||Array.isArray(i)||Array.isArray(e))return!1;if(i!==null&&typeof i=="object"&&e!==null){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(const n in i)if(!g(i[n],e[n]))return!1;return!0}return i===e||Number.isNaN(i)&&Number.isNaN(e)}if(!(Array.isArray(u)&&Array.isArray(_))||u.length!==_.length)return!1;for(let i=0,e=u.length;i<e;i++)if(!g(u[i],_[i]))return!1;return!0}},(et,V,R)=>{var r,d,T,o,E,W,D,B,z,M,Q,Ve,Ii,Di,Oi,Ni,Un,Vn,Bi;Object.defineProperty(V,"__esModule",{value:!0}),V.PDFPageView=void 0;var f=R(4),a=R(2),N=R(14),x=R(6),p=R(15),c=R(7),v=R(5),b=R(16),m=R(17),u=R(18),_=R(19),g=R(20);const i=p.compatibilityParams.maxCanvasPixels||16777216,e=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new v.SimpleLinkService}});class n{constructor(k){tt(this,Q);tt(this,r,f.AnnotationMode.ENABLE_FORMS);tt(this,d,!1);tt(this,T,null);tt(this,o,null);tt(this,E,null);tt(this,W,null);tt(this,D,a.RenderingStates.INITIAL);tt(this,B,a.TextLayerMode.ENABLE);tt(this,z,{directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0});tt(this,M,new WeakMap);var pt;const J=k.container,at=k.defaultViewport;this.id=k.id,this.renderingId="page"+this.id,Z(this,T,k.layerProperties||e),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=k.scale||a.DEFAULT_SCALE,this.viewport=at,this.pdfPageRotate=at.rotation,this._optionalContentConfigPromise=k.optionalContentConfigPromise||null,Z(this,B,k.textLayerMode??a.TextLayerMode.ENABLE),Z(this,r,k.annotationMode??f.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=k.imageResourcesPath||"",this.isOffscreenCanvasSupported=k.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=k.maxCanvasPixels??i,this.pageColors=k.pageColors||null,this.eventBus=k.eventBus,this.renderingQueue=k.renderingQueue,this.l10n=k.l10n||c.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!((pt=this.renderingQueue)!=null&&pt.hasViewer()),this._container=J,k.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),this.maxCanvasPixels=0),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const ft=document.createElement("div");if(ft.className="page",ft.setAttribute("data-page-number",this.id),ft.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(vt=>{ft.setAttribute("aria-label",vt)}),this.div=ft,j(this,Q,Ve).call(this),J==null||J.append(ft),this._isStandalone){J==null||J.style.setProperty("--scale-factor",this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:vt}=k;vt&&vt.then(Et=>{vt===this._optionalContentConfigPromise&&(t(this,z).initialOptionalContent=Et.hasInitialVisibility)})}}get renderingState(){return t(this,D)}set renderingState(k){if(k!==t(this,D))switch(Z(this,D,k),t(this,o)&&(clearTimeout(t(this,o)),Z(this,o,null)),k){case a.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case a.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),Z(this,o,setTimeout(()=>{this.div.classList.add("loading"),Z(this,o,null)},0));break;case a.RenderingStates.INITIAL:case a.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}setPdfPage(k){var at,ft,pt;this._isStandalone&&(((at=this.pageColors)==null?void 0:at.foreground)==="CanvasText"||((ft=this.pageColors)==null?void 0:ft.background)==="Canvas")&&((pt=this._container)==null||pt.style.setProperty("--hcm-highligh-filter",k.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=k,this.pdfPageRotate=k.rotate;const J=(this.rotation+this.pdfPageRotate)%360;this.viewport=k.getViewport({scale:this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:J}),j(this,Q,Ve).call(this),this.reset()}destroy(){var k;this.reset(),(k=this.pdfPage)==null||k.cleanup()}get _textHighlighter(){return(0,f.shadow)(this,"_textHighlighter",new u.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:t(this,T).call(this).findController}))}_resetZoomLayer(k=!1){if(!this.zoomLayer)return;const J=this.zoomLayer.firstChild;t(this,M).delete(J),J.width=0,J.height=0,k&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:k=!1,keepAnnotationLayer:J=!1,keepAnnotationEditorLayer:at=!1,keepXfaLayer:ft=!1,keepTextLayer:pt=!1}={}){var nt,P,s,w,U;this.cancelRendering({keepAnnotationLayer:J,keepAnnotationEditorLayer:at,keepXfaLayer:ft,keepTextLayer:pt}),this.renderingState=a.RenderingStates.INITIAL;const vt=this.div,Et=vt.childNodes,Pt=k&&this.zoomLayer||null,ct=J&&((nt=this.annotationLayer)==null?void 0:nt.div)||null,lt=at&&((P=this.annotationEditorLayer)==null?void 0:P.div)||null,I=ft&&((s=this.xfaLayer)==null?void 0:s.div)||null,q=pt&&((w=this.textLayer)==null?void 0:w.div)||null;for(let F=Et.length-1;F>=0;F--){const it=Et[F];switch(it){case Pt:case ct:case lt:case I:case q:continue}it.remove()}vt.removeAttribute("data-loaded"),ct&&this.annotationLayer.hide(),lt&&this.annotationEditorLayer.hide(),I&&this.xfaLayer.hide(),q&&this.textLayer.hide(),(U=this.structTreeLayer)==null||U.hide(),Pt||(this.canvas&&(t(this,M).delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:k=0,rotation:J=null,optionalContentConfigPromise:at=null,drawingDelay:ft=-1}){var vt;this.scale=k||this.scale,typeof J=="number"&&(this.rotation=J),at instanceof Promise&&(this._optionalContentConfigPromise=at,at.then(Et=>{at===this._optionalContentConfigPromise&&(t(this,z).initialOptionalContent=Et.hasInitialVisibility)})),t(this,z).directDrawing=!0;const pt=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:pt}),j(this,Q,Ve).call(this),this._isStandalone&&((vt=this._container)==null||vt.style.setProperty("--scale-factor",this.viewport.scale)),this.canvas){let Et=!1;if(t(this,d)){if(this.maxCanvasPixels===0)Et=!0;else if(this.maxCanvasPixels>0){const{width:ct,height:lt}=this.viewport,{sx:I,sy:q}=this.outputScale;Et=(Math.floor(ct)*I|0)*(Math.floor(lt)*q|0)>this.maxCanvasPixels}}const Pt=!Et&&ft>=0&&ft<1e3;if(Pt||Et){if(Pt&&this.renderingState!==a.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:ft}),this.renderingState=a.RenderingStates.FINISHED,t(this,z).directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!Pt,hideTextLayer:Pt}),Pt)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:t(this,W)});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:k=!1,keepAnnotationEditorLayer:J=!1,keepXfaLayer:at=!1,keepTextLayer:ft=!1,cancelExtraDelay:pt=0}={}){var vt;this.renderTask&&(this.renderTask.cancel(pt),this.renderTask=null),this.resume=null,this.textLayer&&(!ft||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!k||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!J||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!at||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(vt=this._textHighlighter)==null||vt.disable())}cssTransform({target:k,redrawAnnotationLayer:J=!1,redrawAnnotationEditorLayer:at=!1,redrawXfaLayer:ft=!1,redrawTextLayer:pt=!1,hideTextLayer:vt=!1}){var Pt;if(!k.hasAttribute("zooming")){k.setAttribute("zooming",!0);const{style:ct}=k;ct.width=ct.height=""}const Et=t(this,M).get(k);if(this.viewport!==Et){const ct=this.viewport.rotation-Et.rotation,lt=Math.abs(ct);let I=1,q=1;if(lt===90||lt===270){const{width:nt,height:P}=this.viewport;I=P/nt,q=nt/P}k.style.transform=`rotate(${ct}deg) scale(${I}, ${q})`}J&&this.annotationLayer&&j(this,Q,Ii).call(this),at&&this.annotationEditorLayer&&j(this,Q,Di).call(this),ft&&this.xfaLayer&&j(this,Q,Oi).call(this),this.textLayer&&(vt?(this.textLayer.hide(),(Pt=this.structTreeLayer)==null||Pt.hide()):pt&&j(this,Q,Ni).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(k,J){return this.viewport.convertToPdfPoint(k,J)}async draw(){this.renderingState!==a.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:k,l10n:J,pageColors:at,pdfPage:ft,viewport:pt}=this;if(!ft)throw this.renderingState=a.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=a.RenderingStates.RUNNING;const vt=document.createElement("div");if(vt.classList.add("canvasWrapper"),k.append(vt),!this.textLayer&&t(this,B)!==a.TextLayerMode.DISABLE&&!ft.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new m.TextAccessibilityManager),this.textLayer=new _.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:t(this,B)===a.TextLayerMode.ENABLE_PERMISSIONS}),k.append(this.textLayer.div)),!this.annotationLayer&&t(this,r)!==f.AnnotationMode.DISABLE){const{annotationStorage:dt,downloadManager:Mt,enableScripting:xt,fieldObjectsPromise:kt,hasJSActionsPromise:jt,linkService:$t}=t(this,T).call(this);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new x.AnnotationLayerBuilder({pageDiv:k,pdfPage:ft,annotationStorage:dt,imageResourcesPath:this.imageResourcesPath,renderForms:t(this,r)===f.AnnotationMode.ENABLE_FORMS,linkService:$t,downloadManager:Mt,l10n:J,enableScripting:xt,hasJSActionsPromise:jt,fieldObjectsPromise:kt,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const Et=dt=>{if(q==null||q(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=a.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=a.RenderingStates.RUNNING,dt()};return}dt()},{width:Pt,height:ct}=pt,lt=document.createElement("canvas");lt.setAttribute("role","presentation"),lt.hidden=!0;const I=!!(at!=null&&at.background&&(at!=null&&at.foreground));let q=dt=>{(!I||dt)&&(lt.hidden=!1,q=null)};vt.append(lt),this.canvas=lt;const nt=lt.getContext("2d",{alpha:!1}),P=this.outputScale=new a.OutputScale;if(this.maxCanvasPixels===0){const dt=1/this.scale;P.sx*=dt,P.sy*=dt,Z(this,d,!0)}else if(this.maxCanvasPixels>0){const dt=Pt*ct,Mt=Math.sqrt(this.maxCanvasPixels/dt);P.sx>Mt||P.sy>Mt?(P.sx=Mt,P.sy=Mt,Z(this,d,!0)):Z(this,d,!1)}const s=(0,a.approximateFraction)(P.sx),w=(0,a.approximateFraction)(P.sy);lt.width=(0,a.roundToDivide)(Pt*P.sx,s[0]),lt.height=(0,a.roundToDivide)(ct*P.sy,w[0]);const{style:U}=lt;U.width=(0,a.roundToDivide)(Pt,s[1])+"px",U.height=(0,a.roundToDivide)(ct,w[1])+"px",t(this,M).set(lt,pt);const F=P.scaled?[P.sx,0,0,P.sy,0,0]:null,it={canvasContext:nt,transform:F,viewport:pt,annotationMode:t(this,r),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:at},ot=this.renderTask=this.pdfPage.render(it);ot.onContinue=Et;const At=ot.promise.then(async()=>{var dt;if(q==null||q(!0),await j(this,Q,Bi).call(this,ot),j(this,Q,Ni).call(this),this.annotationLayer&&await j(this,Q,Ii).call(this),!this.annotationEditorLayer){const{annotationEditorUIManager:Mt}=t(this,T).call(this);if(!Mt)return;this.annotationEditorLayer=new N.AnnotationEditorLayerBuilder({uiManager:Mt,pageDiv:k,pdfPage:ft,l10n:J,accessibilityManager:this._accessibilityManager,annotationLayer:(dt=this.annotationLayer)==null?void 0:dt.annotationLayer})}j(this,Q,Di).call(this)},dt=>(dt instanceof f.RenderingCancelledException||q==null||q(!0),j(this,Q,Bi).call(this,ot,dt)));if(ft.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&k.append(this.xfaLayer.div);else{const{annotationStorage:dt,linkService:Mt}=t(this,T).call(this);this.xfaLayer=new g.XfaLayerBuilder({pageDiv:k,pdfPage:ft,annotationStorage:dt,linkService:Mt})}j(this,Q,Oi).call(this)}return k.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),At}setPageLabel(k){this.pageLabel=typeof k=="string"?k:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:k,initialOptionalContent:J,regularAnnotations:at}=t(this,z);return k&&J&&at?this.canvas:null}}r=new WeakMap,d=new WeakMap,T=new WeakMap,o=new WeakMap,E=new WeakMap,W=new WeakMap,D=new WeakMap,B=new WeakMap,z=new WeakMap,M=new WeakMap,Q=new WeakSet,Ve=function(){const{viewport:k}=this;if(this.pdfPage){if(t(this,E)===k.rotation)return;Z(this,E,k.rotation)}(0,f.setLayerDimensions)(this.div,k,!0,!1)},Ii=async function(){let k=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(J){console.error(`#renderAnnotationLayer: "${J}".`),k=J}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:k})}},Di=async function(){let k=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(J){console.error(`#renderAnnotationEditorLayer: "${J}".`),k=J}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:k})}},Oi=async function(){let k=null;try{const J=await this.xfaLayer.render(this.viewport,"display");J!=null&&J.textDivs&&this._textHighlighter&&j(this,Q,Vn).call(this,J.textDivs)}catch(J){console.error(`#renderXfaLayer: "${J}".`),k=J}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:k})}},Ni=async function(){const{pdfPage:k,textLayer:J,viewport:at}=this;if(!J)return;let ft=null;try{if(!J.renderingDone){const pt=k.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});J.setTextContentSource(pt)}await J.render(at)}catch(pt){if(pt instanceof f.AbortException)return;console.error(`#renderTextLayer: "${pt}".`),ft=pt}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:J.numTextDivs,error:ft}),j(this,Q,Un).call(this)},Un=async function(){var at,ft,pt;if(!this.textLayer)return;this.structTreeLayer||(this.structTreeLayer=new b.StructTreeLayerBuilder);const k=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),J=(at=this.structTreeLayer)==null?void 0:at.render(k);J&&((ft=this.canvas)==null||ft.append(J)),(pt=this.structTreeLayer)==null||pt.show()},Vn=async function(k){const J=await this.pdfPage.getTextContent(),at=[];for(const ft of J.items)at.push(ft.str);this._textHighlighter.setTextMapping(k,at),this._textHighlighter.enable()},Bi=async function(k,J=null){if(k===this.renderTask&&(this.renderTask=null),J instanceof f.RenderingCancelledException){Z(this,W,null);return}if(Z(this,W,J),this.renderingState=a.RenderingStates.FINISHED,this._resetZoomLayer(!0),t(this,z).regularAnnotations=!k.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:t(this,W)}),J)throw J},V.PDFPageView=n},(et,V,R)=>{var x,p;Object.defineProperty(V,"__esModule",{value:!0}),V.AnnotationEditorLayerBuilder=void 0;var f=R(4),a=R(7);class N{constructor(v){tt(this,x,null);tt(this,p);this.pageDiv=v.pageDiv,this.pdfPage=v.pdfPage,this.accessibilityManager=v.accessibilityManager,this.l10n=v.l10n||a.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,Z(this,p,v.uiManager),Z(this,x,v.annotationLayer||null)}async render(v,b="display"){if(b!=="display"||this._cancelled)return;const m=v.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:m}),this.show();return}const u=this.div=document.createElement("div");u.className="annotationEditorLayer",u.tabIndex=0,u.hidden=!0,u.dir=t(this,p).direction,this.pageDiv.append(u),this.annotationEditorLayer=new f.AnnotationEditorLayer({uiManager:t(this,p),div:u,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:m,annotationLayer:t(this,x)});const _={viewport:m,div:u,annotations:null,intent:b};this.annotationEditorLayer.render(_),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}x=new WeakMap,p=new WeakMap,V.AnnotationEditorLayerBuilder=N},(et,V)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.compatibilityParams=V.OptionKind=V.AppOptions=void 0;const R=Object.create(null);V.compatibilityParams=R;{const p=navigator.userAgent||"",c=navigator.platform||"",v=navigator.maxTouchPoints||1,b=/Android/.test(p),m=/\b(iPad|iPhone|iPod)(?=;)/.test(p)||c==="MacIntel"&&v>1;(function(){(m||b)&&(R.maxCanvasPixels=5242880)})()}const f={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};V.OptionKind=f;const a={annotationEditorMode:{value:0,kind:f.VIEWER+f.PREFERENCE},annotationMode:{value:2,kind:f.VIEWER+f.PREFERENCE},cursorToolOnLoad:{value:0,kind:f.VIEWER+f.PREFERENCE},defaultZoomDelay:{value:400,kind:f.VIEWER+f.PREFERENCE},defaultZoomValue:{value:"",kind:f.VIEWER+f.PREFERENCE},disableHistory:{value:!1,kind:f.VIEWER},disablePageLabels:{value:!1,kind:f.VIEWER+f.PREFERENCE},enablePermissions:{value:!1,kind:f.VIEWER+f.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:f.VIEWER+f.PREFERENCE},enableScripting:{value:!0,kind:f.VIEWER+f.PREFERENCE},enableStampEditor:{value:!0,kind:f.VIEWER+f.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:f.VIEWER},externalLinkTarget:{value:0,kind:f.VIEWER+f.PREFERENCE},historyUpdateUrl:{value:!1,kind:f.VIEWER+f.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:f.VIEWER+f.PREFERENCE},imageResourcesPath:{value:"./images/",kind:f.VIEWER},maxCanvasPixels:{value:16777216,kind:f.VIEWER},forcePageColors:{value:!1,kind:f.VIEWER+f.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:f.VIEWER+f.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:f.VIEWER+f.PREFERENCE},pdfBugEnabled:{value:!1,kind:f.VIEWER+f.PREFERENCE},printResolution:{value:150,kind:f.VIEWER},sidebarViewOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},scrollModeOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},spreadModeOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},textLayerMode:{value:1,kind:f.VIEWER+f.PREFERENCE},viewerCssTheme:{value:0,kind:f.VIEWER+f.PREFERENCE},viewOnLoad:{value:0,kind:f.VIEWER+f.PREFERENCE},cMapPacked:{value:!0,kind:f.API},cMapUrl:{value:"../web/cmaps/",kind:f.API},disableAutoFetch:{value:!1,kind:f.API+f.PREFERENCE},disableFontFace:{value:!1,kind:f.API+f.PREFERENCE},disableRange:{value:!1,kind:f.API+f.PREFERENCE},disableStream:{value:!1,kind:f.API+f.PREFERENCE},docBaseUrl:{value:"",kind:f.API},enableXfa:{value:!0,kind:f.API+f.PREFERENCE},fontExtraProperties:{value:!1,kind:f.API},isEvalSupported:{value:!0,kind:f.API},isOffscreenCanvasSupported:{value:!0,kind:f.API},maxImageSize:{value:-1,kind:f.API},pdfBug:{value:!1,kind:f.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:f.API},verbosity:{value:1,kind:f.API},workerPort:{value:null,kind:f.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:f.WORKER}};a.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:f.VIEWER},a.disablePreferences={value:!1,kind:f.VIEWER},a.locale={value:navigator.language||"en-US",kind:f.VIEWER},a.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:f.VIEWER};const N=Object.create(null);class x{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(c){const v=N[c];if(v!==void 0)return v;const b=a[c];if(b!==void 0)return R[c]??b.value}static getAll(c=null){const v=Object.create(null);for(const b in a){const m=a[b];if(c){if(!(c&m.kind))continue;if(c===f.PREFERENCE){const _=m.value,g=typeof _;if(g==="boolean"||g==="string"||g==="number"&&Number.isInteger(_)){v[b]=_;continue}throw new Error(`Invalid type for preference: ${b}`)}}const u=N[b];v[b]=u!==void 0?u:R[b]??m.value}return v}static set(c,v){N[c]=v}static setAll(c){for(const v in c)N[v]=c[v]}static remove(c){delete N[c]}}V.AppOptions=x,x._hasUserOptions=function(){return Object.keys(N).length>0}},(et,V,R)=>{var p,c,Ui,Vi;Object.defineProperty(V,"__esModule",{value:!0}),V.StructTreeLayerBuilder=void 0;var f=R(2);const a={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},N=/^H(\d+)$/;class x{constructor(){tt(this,c);tt(this,p)}get renderingDone(){return t(this,p)!==void 0}render(u){if(t(this,p)!==void 0)return t(this,p);const _=j(this,c,Vi).call(this,u);return _==null||_.classList.add("structTree"),Z(this,p,_)}hide(){t(this,p)&&!t(this,p).hidden&&(t(this,p).hidden=!0)}show(){var u;(u=t(this,p))!=null&&u.hidden&&(t(this,p).hidden=!1)}}p=new WeakMap,c=new WeakSet,Ui=function(u,_){const{alt:g,id:i,lang:e}=u;g!==void 0&&_.setAttribute("aria-label",(0,f.removeNullCharacters)(g)),i!==void 0&&_.setAttribute("aria-owns",i),e!==void 0&&_.setAttribute("lang",(0,f.removeNullCharacters)(e,!0))},Vi=function(u){if(!u)return null;const _=document.createElement("span");if("role"in u){const{role:g}=u,i=g.match(N);i?(_.setAttribute("role","heading"),_.setAttribute("aria-level",i[1])):a[g]&&_.setAttribute("role",a[g])}if(j(this,c,Ui).call(this,u,_),u.children)if(u.children.length===1&&"id"in u.children[0])j(this,c,Ui).call(this,u.children[0],_);else for(const g of u.children)_.append(j(this,c,Vi).call(this,g));return _},V.StructTreeLayerBuilder=x},(et,V,R)=>{var N,x,p,c,v,He,m,Hi;Object.defineProperty(V,"__esModule",{value:!0}),V.TextAccessibilityManager=void 0;var f=R(2);const _=class _{constructor(){tt(this,m);tt(this,N,!1);tt(this,x,null);tt(this,p,new Map);tt(this,c,new Map)}setTextMapping(i){Z(this,x,i)}enable(){if(t(this,N))throw new Error("TextAccessibilityManager is already enabled.");if(!t(this,x))throw new Error("Text divs and strings have not been set.");if(Z(this,N,!0),Z(this,x,t(this,x).slice()),t(this,x).sort(j(_,v,He)),t(this,p).size>0){const i=t(this,x);for(const[e,n]of t(this,p)){if(!document.getElementById(e)){t(this,p).delete(e);continue}j(this,m,Hi).call(this,e,i[n])}}for(const[i,e]of t(this,c))this.addPointerInTextLayer(i,e);t(this,c).clear()}disable(){t(this,N)&&(t(this,c).clear(),Z(this,x,null),Z(this,N,!1))}removePointerInTextLayer(i){if(!t(this,N)){t(this,c).delete(i);return}const e=t(this,x);if(!e||e.length===0)return;const{id:n}=i,r=t(this,p).get(n);if(r===void 0)return;const d=e[r];t(this,p).delete(n);let T=d.getAttribute("aria-owns");T!=null&&T.includes(n)&&(T=T.split(" ").filter(o=>o!==n).join(" "),T?d.setAttribute("aria-owns",T):(d.removeAttribute("aria-owns"),d.setAttribute("role","presentation")))}addPointerInTextLayer(i,e){const{id:n}=i;if(!n)return null;if(!t(this,N))return t(this,c).set(i,e),null;e&&this.removePointerInTextLayer(i);const r=t(this,x);if(!r||r.length===0)return null;const d=(0,f.binarySearchFirstItem)(r,W=>{var D;return j(D=_,v,He).call(D,i,W)<0}),T=Math.max(0,d-1),o=r[T];j(this,m,Hi).call(this,n,o),t(this,p).set(n,T);const E=o.parentNode;return E!=null&&E.classList.contains("markedContent")?E.id:null}moveElementInDOM(i,e,n,r){const d=this.addPointerInTextLayer(n,r);if(!i.hasChildNodes())return i.append(e),d;const T=Array.from(i.childNodes).filter(W=>W!==e);if(T.length===0)return d;const o=n||e,E=(0,f.binarySearchFirstItem)(T,W=>{var D;return j(D=_,v,He).call(D,o,W)<0});return E===0?T[0].before(e):T[E-1].after(e),d}};N=new WeakMap,x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakSet,He=function(i,e){const n=i.getBoundingClientRect(),r=e.getBoundingClientRect();if(n.width===0&&n.height===0)return 1;if(r.width===0&&r.height===0)return-1;const d=n.y,T=n.y+n.height,o=n.y+n.height/2,E=r.y,W=r.y+r.height,D=r.y+r.height/2;if(o<=E&&D>=T)return-1;if(D<=d&&o>=W)return 1;const B=n.x+n.width/2,z=r.x+r.width/2;return B-z},m=new WeakSet,Hi=function(i,e){const n=e.getAttribute("aria-owns");n!=null&&n.includes(i)||e.setAttribute("aria-owns",n?`${n} ${i}`:i),e.removeAttribute("role")},tt(_,v);let a=_;V.TextAccessibilityManager=a},(et,V)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.TextHighlighter=void 0;class R{constructor({findController:a,eventBus:N,pageIndex:x}){this.findController=a,this.matches=[],this.eventBus=N,this.pageIdx=x,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(a,N){this.textDivs=a,this.textContentItemsStr=N}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=a=>{(a.pageIndex===this.pageIdx||a.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(a,N){if(!a)return[];const{textContentItemsStr:x}=this;let p=0,c=0;const v=x.length-1,b=[];for(let m=0,u=a.length;m<u;m++){let _=a[m];for(;p!==v&&_>=c+x[p].length;)c+=x[p].length,p++;p===x.length&&console.error("Could not find a matching mapping");const g={begin:{divIdx:p,offset:_-c}};for(_+=N[m];p!==v&&_>c+x[p].length;)c+=x[p].length,p++;g.end={divIdx:p,offset:_-c},b.push(g)}return b}_renderMatches(a){if(a.length===0)return;const{findController:N,pageIdx:x}=this,{textContentItemsStr:p,textDivs:c}=this,v=x===N.selected.pageIdx,b=N.selected.matchIdx,m=N.state.highlightAll;let u=null;const _={offset:void 0};function g(T,o){const E=T.divIdx;return c[E].textContent="",i(E,0,T.offset,o)}function i(T,o,E,W){let D=c[T];if(D.nodeType===Node.TEXT_NODE){const M=document.createElement("span");D.before(M),M.append(D),c[T]=M,D=M}const B=p[T].substring(o,E),z=document.createTextNode(B);if(W){const M=document.createElement("span");return M.className=`${W} appended`,M.append(z),D.append(M),W.includes("selected")?M.offsetLeft:0}return D.append(z),0}let e=b,n=e+1;if(m)e=0,n=a.length;else if(!v)return;let r=-1,d=-1;for(let T=e;T<n;T++){const o=a[T],E=o.begin;if(E.divIdx===r&&E.offset===d)continue;r=E.divIdx,d=E.offset;const W=o.end,D=v&&T===b,B=D?" selected":"";let z=0;if(!u||E.divIdx!==u.divIdx?(u!==null&&i(u.divIdx,u.offset,_.offset),g(E)):i(u.divIdx,u.offset,E.offset),E.divIdx===W.divIdx)z=i(E.divIdx,E.offset,W.offset,"highlight"+B);else{z=i(E.divIdx,E.offset,_.offset,"highlight begin"+B);for(let M=E.divIdx+1,Q=W.divIdx;M<Q;M++)c[M].className="highlight middle"+B;g(W,"highlight end"+B)}u=W,D&&N.scrollMatchIntoView({element:c[E.divIdx],selectedLeft:z,pageIndex:x,matchIndex:b})}u&&i(u.divIdx,u.offset,_.offset)}_updateMatches(a=!1){if(!this.enabled&&!a)return;const{findController:N,matches:x,pageIdx:p}=this,{textContentItemsStr:c,textDivs:v}=this;let b=-1;for(const _ of x){const g=Math.max(b,_.begin.divIdx);for(let i=g,e=_.end.divIdx;i<=e;i++){const n=v[i];n.textContent=c[i],n.className=""}b=_.end.divIdx+1}if(!(N!=null&&N.highlightMatches)||a)return;const m=N.pageMatches[p]||null,u=N.pageMatchesLength[p]||null;this.matches=this._convertMatches(m,u),this._renderMatches(this.matches)}}V.TextHighlighter=R},(et,V,R)=>{var x,p,c,v,b,Hn,Wn;Object.defineProperty(V,"__esModule",{value:!0}),V.TextLayerBuilder=void 0;var f=R(4),a=R(2);class N{constructor({highlighter:g=null,accessibilityManager:i=null,isOffscreenCanvasSupported:e=!0,enablePermissions:n=!1}){tt(this,b);tt(this,x,!1);tt(this,p,0);tt(this,c,0);tt(this,v,null);this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=g,this.accessibilityManager=i,this.isOffscreenCanvasSupported=e,Z(this,x,n===!0),this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}get numTextDivs(){return this.textDivs.length}async render(g){var n,r,d;if(!t(this,v))throw new Error('No "textContentSource" parameter specified.');const i=g.scale*(globalThis.devicePixelRatio||1),{rotation:e}=g;if(this.renderingDone){const T=e!==t(this,p),o=i!==t(this,c);(T||o)&&(this.hide(),(0,f.updateTextLayer)({container:this.div,viewport:g,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:o,mustRotate:T}),Z(this,c,i),Z(this,p,e)),this.show();return}this.cancel(),(n=this.highlighter)==null||n.setTextMapping(this.textDivs,this.textContentItemsStr),(r=this.accessibilityManager)==null||r.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,f.renderTextLayer)({textContentSource:t(this,v),container:this.div,viewport:g,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,j(this,b,Hn).call(this),Z(this,c,i),Z(this,p,e),this.show(),(d=this.accessibilityManager)==null||d.enable()}hide(){var g;this.div.hidden||((g=this.highlighter)==null||g.disable(),this.div.hidden=!0)}show(){var g;this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,(g=this.highlighter)==null||g.enable())}cancel(){var g,i;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(g=this.highlighter)==null||g.disable(),(i=this.accessibilityManager)==null||i.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(g){this.cancel(),Z(this,v,g)}}x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakSet,Hn=function(){this.renderingDone=!0;const g=document.createElement("div");g.className="endOfContent",this.div.append(g),j(this,b,Wn).call(this)},Wn=function(){const{div:g}=this;g.addEventListener("mousedown",i=>{const e=g.querySelector(".endOfContent");if(!e)return;let n=i.target!==g;if(n&&(n=getComputedStyle(e).getPropertyValue("-moz-user-select")!=="none"),n){const r=g.getBoundingClientRect(),d=Math.max(0,(i.pageY-r.top)/r.height);e.style.top=(d*100).toFixed(2)+"%"}e.classList.add("active")}),g.addEventListener("mouseup",()=>{const i=g.querySelector(".endOfContent");i&&(i.style.top="",i.classList.remove("active"))}),g.addEventListener("copy",i=>{if(!t(this,x)){const e=document.getSelection();i.clipboardData.setData("text/plain",(0,a.removeNullCharacters)((0,f.normalizeUnicode)(e.toString())))}i.preventDefault(),i.stopPropagation()})},V.TextLayerBuilder=N},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.XfaLayerBuilder=void 0;var f=R(4);class a{constructor({pageDiv:x,pdfPage:p,annotationStorage:c=null,linkService:v,xfaHtml:b=null}){this.pageDiv=x,this.pdfPage=p,this.annotationStorage=c,this.linkService=v,this.xfaHtml=b,this.div=null,this._cancelled=!1}async render(x,p="display"){if(p==="print"){const b={viewport:x.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:p},m=document.createElement("div");return this.pageDiv.append(m),b.div=m,f.XfaLayer.render(b)}const c=await this.pdfPage.getXfa();if(this._cancelled||!c)return{textDivs:[]};const v={viewport:x.clone({dontFlip:!0}),div:this.div,xfaHtml:c,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:p};return this.div?f.XfaLayer.update(v):(this.div=document.createElement("div"),this.pageDiv.append(this.div),v.div=this.div,f.XfaLayer.render(v))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}V.XfaLayerBuilder=a},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.PDFScriptingManager=void 0;var f=R(22),a=R(23);class N extends a.PDFScriptingManager{constructor(p){p.externalServices||window.addEventListener("updatefromsandbox",c=>{p.eventBus.dispatch("updatefromsandbox",{source:window,detail:c.detail})}),p.externalServices||(p.externalServices={createScripting:({sandboxBundleSrc:c})=>new f.GenericScripting(c)}),p.docProperties||(p.docProperties=c=>(0,f.docProperties)(c)),super(p)}}V.PDFScriptingManager=N},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.GenericScripting=void 0,V.docProperties=a;var f=R(4);async function a(x){const p="",c=p.split("#")[0];let{info:v,metadata:b,contentDispositionFilename:m,contentLength:u}=await x.getMetadata();if(!u){const{length:_}=await x.getDownloadInfo();u=_}return{...v,baseURL:c,filesize:u,filename:m||(0,f.getPdfFilenameFromUrl)(p),metadata:b==null?void 0:b.getRaw(),authors:b==null?void 0:b.get("dc:creator"),numPages:x.numPages,URL:p}}class N{constructor(p){this._ready=(0,f.loadScript)(p,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(p){(await this._ready).create(p)}async dispatchEventInSandbox(p){const c=await this._ready;setTimeout(()=>c.dispatchEvent(p),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}V.GenericScripting=N},(et,V,R)=>{var x,p,c,v,b,m,u,_,g,i,e,n,jn,We,Wi,zn,Se;Object.defineProperty(V,"__esModule",{value:!0}),V.PDFScriptingManager=void 0;var f=R(2),a=R(4);class N{constructor({eventBus:D,sandboxBundleSrc:B=null,externalServices:z=null,docProperties:M=null}){tt(this,n);tt(this,x,null);tt(this,p,null);tt(this,c,null);tt(this,v,null);tt(this,b,null);tt(this,m,null);tt(this,u,null);tt(this,_,!1);tt(this,g,null);tt(this,i,null);tt(this,e,null);Z(this,v,D),Z(this,g,B),Z(this,b,z),Z(this,c,M)}setViewer(D){Z(this,u,D)}async setDocument(D){var Q;if(t(this,m)&&await j(this,n,Se).call(this),Z(this,m,D),!D)return;const[B,z,M]=await Promise.all([D.getFieldObjects(),D.getCalculationOrderIds(),D.getJSActions()]);if(!B&&!M){await j(this,n,Se).call(this);return}if(D===t(this,m)){try{Z(this,i,j(this,n,zn).call(this))}catch(y){console.error(`setDocument: "${y.message}".`),await j(this,n,Se).call(this);return}this._internalEvents.set("updatefromsandbox",y=>{(y==null?void 0:y.source)===window&&j(this,n,jn).call(this,y.detail)}),this._internalEvents.set("dispatcheventinsandbox",y=>{var C;(C=t(this,i))==null||C.dispatchEventInSandbox(y.detail)}),this._internalEvents.set("pagechanging",({pageNumber:y,previous:C})=>{y!==C&&(j(this,n,Wi).call(this,C),j(this,n,We).call(this,y))}),this._internalEvents.set("pagerendered",({pageNumber:y})=>{this._pageOpenPending.has(y)&&y===t(this,u).currentPageNumber&&j(this,n,We).call(this,y)}),this._internalEvents.set("pagesdestroy",async()=>{var y,C;await j(this,n,Wi).call(this,t(this,u).currentPageNumber),await((y=t(this,i))==null?void 0:y.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(C=t(this,x))==null||C.resolve()});for(const[y,C]of this._internalEvents)t(this,v)._on(y,C);try{const y=await t(this,c).call(this,D);if(D!==t(this,m))return;await t(this,i).createSandbox({objects:B,calculationOrder:z,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...y,actions:M}}),t(this,v).dispatch("sandboxcreated",{source:this})}catch(y){console.error(`setDocument: "${y.message}".`),await j(this,n,Se).call(this);return}await((Q=t(this,i))==null?void 0:Q.dispatchEventInSandbox({id:"doc",name:"Open"})),await j(this,n,We).call(this,t(this,u).currentPageNumber,!0),Promise.resolve().then(()=>{D===t(this,m)&&Z(this,_,!0)})}}async dispatchWillSave(){var D;return(D=t(this,i))==null?void 0:D.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){var D;return(D=t(this,i))==null?void 0:D.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){var D;if(t(this,i)){await((D=t(this,e))==null?void 0:D.promise),Z(this,e,new a.PromiseCapability);try{await t(this,i).dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(B){throw t(this,e).resolve(),Z(this,e,null),B}await t(this,e).promise}}async dispatchDidPrint(){var D;return(D=t(this,i))==null?void 0:D.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var D;return((D=t(this,p))==null?void 0:D.promise)||null}get ready(){return t(this,_)}get _internalEvents(){return(0,a.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,a.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,a.shadow)(this,"_visitedPages",new Map)}}x=new WeakMap,p=new WeakMap,c=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap,u=new WeakMap,_=new WeakMap,g=new WeakMap,i=new WeakMap,e=new WeakMap,n=new WeakSet,jn=async function(D){var O,l;const B=t(this,u),z=B.isInPresentationMode||B.isChangingPresentationMode,{id:M,siblings:Q,command:y,value:C}=D;if(!M){switch(y){case"clear":console.clear();break;case"error":console.error(C);break;case"layout":if(!z){const h=(0,f.apiPageLayoutToViewerModes)(C);B.spreadMode=h.spreadMode}break;case"page-num":B.currentPageNumber=C+1;break;case"print":await B.pagesPromise,t(this,v).dispatch("print",{source:this});break;case"println":console.log(C);break;case"zoom":z||(B.currentScaleValue=C);break;case"SaveAs":t(this,v).dispatch("download",{source:this});break;case"FirstPage":B.currentPageNumber=1;break;case"LastPage":B.currentPageNumber=B.pagesCount;break;case"NextPage":B.nextPage();break;case"PrevPage":B.previousPage();break;case"ZoomViewIn":z||B.increaseScale();break;case"ZoomViewOut":z||B.decreaseScale();break;case"WillPrintFinished":(O=t(this,e))==null||O.resolve(),Z(this,e,null);break}return}if(z&&D.focus)return;delete D.id,delete D.siblings;const rt=Q?[M,...Q]:[M];for(const h of rt){const A=document.querySelector(`[data-element-id="${h}"]`);A?A.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:D})):(l=t(this,m))==null||l.annotationStorage.setValue(h,D)}},We=async function(D,B=!1){const z=t(this,m),M=this._visitedPages;if(B&&Z(this,x,new a.PromiseCapability),!t(this,x))return;const Q=t(this,u).getPageView(D-1);if((Q==null?void 0:Q.renderingState)!==f.RenderingStates.FINISHED){this._pageOpenPending.add(D);return}this._pageOpenPending.delete(D);const y=(async()=>{var rt,O;const C=await(M.has(D)?null:(rt=Q.pdfPage)==null?void 0:rt.getJSActions());z===t(this,m)&&await((O=t(this,i))==null?void 0:O.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:D,actions:C}))})();M.set(D,y)},Wi=async function(D){var Q;const B=t(this,m),z=this._visitedPages;if(!t(this,x)||this._pageOpenPending.has(D))return;const M=z.get(D);M&&(z.set(D,null),await M,B===t(this,m)&&await((Q=t(this,i))==null?void 0:Q.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:D})))},zn=function(){if(Z(this,p,new a.PromiseCapability),t(this,i))throw new Error("#initScripting: Scripting already exists.");return t(this,b).createScripting({sandboxBundleSrc:t(this,g)})},Se=async function(){var D,B,z;if(!t(this,i)){Z(this,m,null),(D=t(this,p))==null||D.resolve();return}t(this,x)&&(await Promise.race([t(this,x).promise,new Promise(M=>{setTimeout(M,1e3)})]).catch(()=>{}),Z(this,x,null)),Z(this,m,null);try{await t(this,i).destroySandbox()}catch{}(B=t(this,e))==null||B.reject(new Error("Scripting destroyed.")),Z(this,e,null);for(const[M,Q]of this._internalEvents)t(this,v)._off(M,Q);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),Z(this,i,null),Z(this,_,!1),(z=t(this,p))==null||z.resolve()},V.PDFScriptingManager=N},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.PDFSinglePageViewer=void 0;var f=R(2),a=R(25);class N extends a.PDFViewer{_resetView(){super._resetView(),this._scrollMode=f.ScrollMode.PAGE,this._spreadMode=f.SpreadMode.NONE}set scrollMode(p){}_updateScrollMode(){}set spreadMode(p){}_updateSpreadMode(){}}V.PDFSinglePageViewer=N},(et,V,R)=>{var g,i,e,ji,r,d,T,o,E,W,D,B,z,M,Q,y,C,rt,O,l,h,A,$n,Gn,Xn,qn,Ee,je,Yn,zi,Kn,ie,$i,Jn,Qn,Gi,Zn;Object.defineProperty(V,"__esModule",{value:!0}),V.PagesCountLimit=V.PDFViewer=V.PDFPageViewBuffer=void 0;var f=R(4),a=R(2),N=R(7),x=R(13),p=R(26),c=R(5);const v=10,b={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};V.PagesCountLimit=b;function m(P){return Object.values(f.AnnotationEditorType).includes(P)&&P!==f.AnnotationEditorType.DISABLE}class u{constructor(s){tt(this,e);tt(this,g,new Set);tt(this,i,0);Z(this,i,s)}push(s){const w=t(this,g);w.has(s)&&w.delete(s),w.add(s),w.size>t(this,i)&&j(this,e,ji).call(this)}resize(s,w=null){Z(this,i,s);const U=t(this,g);if(w){const F=U.size;let it=1;for(const ot of U)if(w.has(ot.id)&&(U.delete(ot),U.add(ot)),++it>F)break}for(;U.size>t(this,i);)j(this,e,ji).call(this)}has(s){return t(this,g).has(s)}[Symbol.iterator](){return t(this,g).keys()}}g=new WeakMap,i=new WeakMap,e=new WeakSet,ji=function(){const s=t(this,g).keys().next().value;s==null||s.destroy(),t(this,g).delete(s)},V.PDFPageViewBuffer=u;class _{constructor(s){tt(this,A);tt(this,r,null);tt(this,d,null);tt(this,T,f.AnnotationEditorType.NONE);tt(this,o,null);tt(this,E,f.AnnotationMode.ENABLE_FORMS);tt(this,W,null);tt(this,D,null);tt(this,B,!1);tt(this,z,!1);tt(this,M,null);tt(this,Q,!1);tt(this,y,0);tt(this,C,new ResizeObserver(j(this,A,Zn).bind(this)));tt(this,rt,null);tt(this,O,null);tt(this,l,null);tt(this,h,a.TextLayerMode.ENABLE);var U,F;const w="3.11.174";if(f.version!==w)throw new Error(`The API version "${f.version}" does not match the Viewer version "${w}".`);if(this.container=s.container,this.viewer=s.viewer||s.container.firstElementChild,((U=this.container)==null?void 0:U.tagName)!=="DIV"||((F=this.viewer)==null?void 0:F.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");t(this,C).observe(this.container),this.eventBus=s.eventBus,this.linkService=s.linkService||new c.SimpleLinkService,this.downloadManager=s.downloadManager||null,this.findController=s.findController||null,Z(this,d,s.altTextManager||null),this.findController&&(this.findController.onIsPageVisible=it=>this._getVisiblePages().ids.has(it)),this._scriptingManager=s.scriptingManager||null,Z(this,h,s.textLayerMode??a.TextLayerMode.ENABLE),Z(this,E,s.annotationMode??f.AnnotationMode.ENABLE_FORMS),Z(this,T,s.annotationEditorMode??f.AnnotationEditorType.NONE),this.imageResourcesPath=s.imageResourcesPath||"",this.enablePrintAutoRotate=s.enablePrintAutoRotate||!1,this.removePageBorders=s.removePageBorders||!1,s.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),s.maxCanvasPixels=0),this.isOffscreenCanvasSupported=s.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=s.maxCanvasPixels,this.l10n=s.l10n||N.NullL10n,Z(this,B,s.enablePermissions||!1),this.pageColors=s.pageColors||null,this.defaultRenderingQueue=!s.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new p.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=s.renderingQueue,this.scroll=(0,a.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=a.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),j(this,A,Gi).call(this),this.eventBus._on("thumbnailrendered",({pageNumber:it,pdfPage:ot})=>{const At=this._pages[it-1];t(this,r).has(At)||ot==null||ot.cleanup()})}get pagesCount(){return this._pages.length}getPageView(s){return this._pages[s]}getCachedPageViews(){return new Set(t(this,r))}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(s=>s==null?void 0:s.pdfPage)}get renderForms(){return t(this,E)===f.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(s){if(!Number.isInteger(s))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(s,!0)||console.error(`currentPageNumber: "${s}" is not a valid page.`))}_setCurrentPageNumber(s,w=!1){var F;if(this._currentPageNumber===s)return w&&j(this,A,$i).call(this),!0;if(!(0<s&&s<=this.pagesCount))return!1;const U=this._currentPageNumber;return this._currentPageNumber=s,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:s,pageLabel:((F=this._pageLabels)==null?void 0:F[s-1])??null,previous:U}),w&&j(this,A,$i).call(this),!0}get currentPageLabel(){var s;return((s=this._pageLabels)==null?void 0:s[this._currentPageNumber-1])??null}set currentPageLabel(s){if(!this.pdfDocument)return;let w=s|0;if(this._pageLabels){const U=this._pageLabels.indexOf(s);U>=0&&(w=U+1)}this._setCurrentPageNumber(w,!0)||console.error(`currentPageLabel: "${s}" is not a valid page.`)}get currentScale(){return this._currentScale!==a.UNKNOWN_SCALE?this._currentScale:a.DEFAULT_SCALE}set currentScale(s){if(isNaN(s))throw new Error("Invalid numeric scale.");this.pdfDocument&&j(this,A,ie).call(this,s,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(s){this.pdfDocument&&j(this,A,ie).call(this,s,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(s){if(!(0,a.isValidRotation)(s))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(s%=360,s<0&&(s+=360),this._pagesRotation===s))return;this._pagesRotation=s;const w=this._currentPageNumber;this.refresh(!0,{rotation:s}),this._currentScaleValue&&j(this,A,ie).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:s,pageNumber:w}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}async getAllText(){const s=[],w=[];for(let U=1,F=this.pdfDocument.numPages;U<=F;++U){if(t(this,Q))return null;w.length=0;const it=await this.pdfDocument.getPage(U),{items:ot}=await it.getTextContent();for(const At of ot)At.str&&w.push(At.str),At.hasEOL&&w.push(`
`);s.push((0,a.removeNullCharacters)(w.join("")))}return s.join(`
`)}setDocument(s){var ot,At;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(ot=this.findController)==null||ot.setDocument(null),(At=this._scriptingManager)==null||At.setDocument(null),t(this,o)&&(t(this,o).destroy(),Z(this,o,null))),this.pdfDocument=s,!s)return;const w=s.numPages,U=s.getPage(1),F=s.getOptionalContentConfig(),it=t(this,B)?s.getPermissions():Promise.resolve();if(w>b.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const dt=this._scrollMode=a.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:dt})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:w})},()=>{}),this._onBeforeDraw=dt=>{const Mt=this._pages[dt.pageNumber-1];Mt&&t(this,r).push(Mt)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=dt=>{dt.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:dt.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,t(this,O)&&(document.removeEventListener("visibilitychange",t(this,O)),Z(this,O,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([U,it]).then(([dt,Mt])=>{var Wt,Ht;if(s!==this.pdfDocument)return;this._firstPageCapability.resolve(dt),this._optionalContentConfigPromise=F;const{annotationEditorMode:xt,annotationMode:kt,textLayerMode:jt}=j(this,A,Gn).call(this,Mt);if(jt!==a.TextLayerMode.DISABLE){const X=Z(this,M,document.createElement("div"));X.id="hiddenCopyElement",this.viewer.before(X)}if(xt!==f.AnnotationEditorType.DISABLE){const X=xt;s.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):m(X)?(Z(this,o,new f.AnnotationEditorUIManager(this.container,this.viewer,t(this,d),this.eventBus,s,this.pageColors)),X!==f.AnnotationEditorType.NONE&&t(this,o).updateMode(X)):console.error(`Invalid AnnotationEditor mode: ${X}`)}const $t=j(this,A,$n).bind(this),St=this._scrollMode===a.ScrollMode.PAGE?null:this.viewer,ht=this.currentScale,ut=dt.getViewport({scale:ht*f.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",ut.scale),(((Wt=this.pageColors)==null?void 0:Wt.foreground)==="CanvasText"||((Ht=this.pageColors)==null?void 0:Ht.background)==="Canvas")&&this.viewer.style.setProperty("--hcm-highligh-filter",s.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"));for(let X=1;X<=w;++X){const gt=new x.PDFPageView({container:St,eventBus:this.eventBus,id:X,scale:ht,defaultViewport:ut.clone(),optionalContentConfigPromise:F,renderingQueue:this.renderingQueue,textLayerMode:jt,annotationMode:kt,imageResourcesPath:this.imageResourcesPath,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:$t});this._pages.push(gt)}const Ft=this._pages[0];Ft&&(Ft.setPdfPage(dt),this.linkService.cachePageRef(1,dt.ref)),this._scrollMode===a.ScrollMode.PAGE?j(this,A,Ee).call(this):this._spreadMode!==a.SpreadMode.NONE&&this._updateSpreadMode(),j(this,A,Xn).call(this).then(async()=>{var gt,Lt;if((gt=this.findController)==null||gt.setDocument(s),(Lt=this._scriptingManager)==null||Lt.setDocument(s),t(this,M)&&(Z(this,D,j(this,A,qn).bind(this,jt)),document.addEventListener("copy",t(this,D))),t(this,o)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:t(this,T)}),s.loadingParams.disableAutoFetch||w>b.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let X=w-1;if(X<=0){this._pagesCapability.resolve();return}for(let Dt=2;Dt<=w;++Dt){const Ot=s.getPage(Dt).then(Rt=>{const $=this._pages[Dt-1];$.pdfPage||$.setPdfPage(Rt),this.linkService.cachePageRef(Dt,Rt.ref),--X===0&&this._pagesCapability.resolve()},Rt=>{console.error(`Unable to get page ${Dt} to initialize viewer`,Rt),--X===0&&this._pagesCapability.resolve()});Dt%b.PAUSE_EAGER_PAGE_INIT===0&&await Ot}}),this.eventBus.dispatch("pagesinit",{source:this}),s.getMetadata().then(({info:X})=>{s===this.pdfDocument&&X.Language&&(this.viewer.lang=X.Language)}),this.defaultRenderingQueue&&this.update()}).catch(dt=>{console.error("Unable to initialize viewer",dt),this._pagesCapability.reject(dt)})}setPageLabels(s){var w;if(this.pdfDocument){s?Array.isArray(s)&&this.pdfDocument.numPages===s.length?this._pageLabels=s:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let U=0,F=this._pages.length;U<F;U++)this._pages[U].setPageLabel(((w=this._pageLabels)==null?void 0:w[U])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=a.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,Z(this,r,new u(v)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new f.PromiseCapability,this._onePageRenderedCapability=new f.PromiseCapability,this._pagesCapability=new f.PromiseCapability,this._scrollMode=a.ScrollMode.VERTICAL,this._previousScrollMode=a.ScrollMode.UNKNOWN,this._spreadMode=a.SpreadMode.NONE,Z(this,rt,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),t(this,O)&&(document.removeEventListener("visibilitychange",t(this,O)),Z(this,O,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),t(this,M)&&(document.removeEventListener("copy",t(this,D)),Z(this,D,null),t(this,M).remove(),Z(this,M,null))}_scrollUpdate(){this.pagesCount!==0&&this.update()}pageLabelToPageNumber(s){if(!this._pageLabels)return null;const w=this._pageLabels.indexOf(s);return w<0?null:w+1}scrollPageIntoView({pageNumber:s,destArray:w=null,allowNegativeOffset:U=!1,ignoreDestinationZoom:F=!1}){if(!this.pdfDocument)return;const it=Number.isInteger(s)&&this._pages[s-1];if(!it){console.error(`scrollPageIntoView: "${s}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!w){this._setCurrentPageNumber(s,!0);return}let ot=0,At=0,dt=0,Mt=0,xt,kt;const jt=it.rotation%180!==0,$t=(jt?it.height:it.width)/it.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS,St=(jt?it.width:it.height)/it.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS;let ht=0;switch(w[1].name){case"XYZ":ot=w[2],At=w[3],ht=w[4],ot=ot!==null?ot:0,At=At!==null?At:St;break;case"Fit":case"FitB":ht="page-fit";break;case"FitH":case"FitBH":At=w[2],ht="page-width",At===null&&this._location?(ot=this._location.left,At=this._location.top):(typeof At!="number"||At<0)&&(At=St);break;case"FitV":case"FitBV":ot=w[2],dt=$t,Mt=St,ht="page-height";break;case"FitR":ot=w[2],At=w[3],dt=w[4]-ot,Mt=w[5]-At;let Ht=a.SCROLLBAR_PADDING,X=a.VERTICAL_PADDING;this.removePageBorders&&(Ht=X=0),xt=(this.container.clientWidth-Ht)/dt/f.PixelsPerInch.PDF_TO_CSS_UNITS,kt=(this.container.clientHeight-X)/Mt/f.PixelsPerInch.PDF_TO_CSS_UNITS,ht=Math.min(Math.abs(xt),Math.abs(kt));break;default:console.error(`scrollPageIntoView: "${w[1].name}" is not a valid destination type.`);return}if(F||(ht&&ht!==this._currentScale?this.currentScaleValue=ht:this._currentScale===a.UNKNOWN_SCALE&&(this.currentScaleValue=a.DEFAULT_SCALE_VALUE)),ht==="page-fit"&&!w[4]){j(this,A,je).call(this,it);return}const ut=[it.viewport.convertToViewportPoint(ot,At),it.viewport.convertToViewportPoint(ot+dt,At+Mt)];let Ft=Math.min(ut[0][0],ut[1][0]),Wt=Math.min(ut[0][1],ut[1][1]);U||(Ft=Math.max(Ft,0),Wt=Math.max(Wt,0)),j(this,A,je).call(this,it,{left:Ft,top:Wt})}_updateLocation(s){const w=this._currentScale,U=this._currentScaleValue,F=parseFloat(U)===w?Math.round(w*1e4)/100:U,it=s.id,ot=this._pages[it-1],At=this.container,dt=ot.getPagePoint(At.scrollLeft-s.x,At.scrollTop-s.y),Mt=Math.round(dt[0]),xt=Math.round(dt[1]);let kt=`#page=${it}`;this.isInPresentationMode||(kt+=`&zoom=${F},${Mt},${xt}`),this._location={pageNumber:it,scale:F,top:xt,left:Mt,rotation:this._pagesRotation,pdfOpenParams:kt}}update(){const s=this._getVisiblePages(),w=s.views,U=w.length;if(U===0)return;const F=Math.max(v,2*U+1);t(this,r).resize(F,s.ids),this.renderingQueue.renderHighestPriority(s);const it=this._spreadMode===a.SpreadMode.NONE&&(this._scrollMode===a.ScrollMode.PAGE||this._scrollMode===a.ScrollMode.VERTICAL),ot=this._currentPageNumber;let At=!1;for(const dt of w){if(dt.percent<100)break;if(dt.id===ot&&it){At=!0;break}}this._setCurrentPageNumber(At?ot:w[0].id),this._updateLocation(s.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(s){return this.container.contains(s)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===a.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===a.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const s=this._scrollMode===a.ScrollMode.PAGE?t(this,rt).pages:this._pages,w=this._scrollMode===a.ScrollMode.HORIZONTAL,U=w&&this._isContainerRtl;return(0,a.getVisibleElements)({scrollEl:this.container,views:s,sortByVisibility:!0,horizontal:w,rtl:U})}cleanup(){for(const s of this._pages)s.renderingState!==a.RenderingStates.FINISHED&&s.reset()}_cancelRendering(){for(const s of this._pages)s.cancelRendering()}forceRendering(s){const w=s||this._getVisiblePages(),U=j(this,A,Qn).call(this,w),F=this._spreadMode!==a.SpreadMode.NONE&&this._scrollMode!==a.ScrollMode.HORIZONTAL,it=this.renderingQueue.getHighestPriority(w,this._pages,U,F);return it?(j(this,A,Jn).call(this,it).then(()=>{this.renderingQueue.renderView(it)}),!0):!1}get hasEqualPageSizes(){const s=this._pages[0];for(let w=1,U=this._pages.length;w<U;++w){const F=this._pages[w];if(F.width!==s.width||F.height!==s.height)return!1}return!0}getPagesOverview(){let s;return this._pages.map(w=>{const U=w.pdfPage.getViewport({scale:1}),F=(0,a.isPortraitOrientation)(U);if(s===void 0)s=F;else if(this.enablePrintAutoRotate&&F!==s)return{width:U.height,height:U.width,rotation:(U.rotation-90)%360};return{width:U.width,height:U.height,rotation:U.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(s){if(!(s instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${s}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=s,this.refresh(!1,{optionalContentConfigPromise:s}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:s}))}get scrollMode(){return this._scrollMode}set scrollMode(s){if(this._scrollMode!==s){if(!(0,a.isValidScrollMode)(s))throw new Error(`Invalid scroll mode: ${s}`);this.pagesCount>b.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=s,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:s}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(s=null){const w=this._scrollMode,U=this.viewer;U.classList.toggle("scrollHorizontal",w===a.ScrollMode.HORIZONTAL),U.classList.toggle("scrollWrapped",w===a.ScrollMode.WRAPPED),!(!this.pdfDocument||!s)&&(w===a.ScrollMode.PAGE?j(this,A,Ee).call(this):this._previousScrollMode===a.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&j(this,A,ie).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(s,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(s){if(this._spreadMode!==s){if(!(0,a.isValidSpreadMode)(s))throw new Error(`Invalid spread mode: ${s}`);this._spreadMode=s,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:s}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(s=null){if(!this.pdfDocument)return;const w=this.viewer,U=this._pages;if(this._scrollMode===a.ScrollMode.PAGE)j(this,A,Ee).call(this);else if(w.textContent="",this._spreadMode===a.SpreadMode.NONE)for(const F of this._pages)w.append(F.div);else{const F=this._spreadMode-1;let it=null;for(let ot=0,At=U.length;ot<At;++ot)it===null?(it=document.createElement("div"),it.className="spread",w.append(it)):ot%2===F&&(it=it.cloneNode(!1),w.append(it)),it.append(U[ot].div)}s&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&j(this,A,ie).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(s,!0),this.update())}_getPageAdvance(s,w=!1){switch(this._scrollMode){case a.ScrollMode.WRAPPED:{const{views:U}=this._getVisiblePages(),F=new Map;for(const{id:it,y:ot,percent:At,widthPercent:dt}of U){if(At===0||dt<100)continue;let Mt=F.get(ot);Mt||F.set(ot,Mt||(Mt=[])),Mt.push(it)}for(const it of F.values()){const ot=it.indexOf(s);if(ot===-1)continue;const At=it.length;if(At===1)break;if(w)for(let dt=ot-1,Mt=0;dt>=Mt;dt--){const xt=it[dt],kt=it[dt+1]-1;if(xt<kt)return s-kt}else for(let dt=ot+1,Mt=At;dt<Mt;dt++){const xt=it[dt],kt=it[dt-1]+1;if(xt>kt)return kt-s}if(w){const dt=it[0];if(dt<s)return s-dt+1}else{const dt=it[At-1];if(dt>s)return dt-s+1}break}break}case a.ScrollMode.HORIZONTAL:break;case a.ScrollMode.PAGE:case a.ScrollMode.VERTICAL:{if(this._spreadMode===a.SpreadMode.NONE)break;const U=this._spreadMode-1;if(w&&s%2!==U)break;if(!w&&s%2===U)break;const{views:F}=this._getVisiblePages(),it=w?s-1:s+1;for(const{id:ot,percent:At,widthPercent:dt}of F)if(ot===it){if(At>0&&dt===100)return 2;break}break}}return 1}nextPage(){const s=this._currentPageNumber,w=this.pagesCount;if(s>=w)return!1;const U=this._getPageAdvance(s,!1)||1;return this.currentPageNumber=Math.min(s+U,w),!0}previousPage(){const s=this._currentPageNumber;if(s<=1)return!1;const w=this._getPageAdvance(s,!0)||1;return this.currentPageNumber=Math.max(s-w,1),!0}increaseScale({drawingDelay:s,scaleFactor:w,steps:U}={}){if(!this.pdfDocument)return;let F=this._currentScale;if(w>1)F=Math.round(F*w*100)/100;else{U??(U=1);do F=Math.ceil((F*a.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--U>0&&F<a.MAX_SCALE)}j(this,A,ie).call(this,Math.min(a.MAX_SCALE,F),{noScroll:!1,drawingDelay:s})}decreaseScale({drawingDelay:s,scaleFactor:w,steps:U}={}){if(!this.pdfDocument)return;let F=this._currentScale;if(w>0&&w<1)F=Math.round(F*w*100)/100;else{U??(U=1);do F=Math.floor((F/a.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--U>0&&F>a.MIN_SCALE)}j(this,A,ie).call(this,Math.max(a.MIN_SCALE,F),{noScroll:!1,drawingDelay:s})}get containerTopLeft(){return t(this,W)||Z(this,W,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return t(this,o)?t(this,T):f.AnnotationEditorType.DISABLE}set annotationEditorMode({mode:s,editId:w=null}){if(!t(this,o))throw new Error("The AnnotationEditor is not enabled.");if(t(this,T)!==s){if(!m(s))throw new Error(`Invalid AnnotationEditor mode: ${s}`);this.pdfDocument&&(Z(this,T,s),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:s}),t(this,o).updateMode(s,w))}}set annotationEditorParams({type:s,value:w}){if(!t(this,o))throw new Error("The AnnotationEditor is not enabled.");t(this,o).updateParams(s,w)}refresh(s=!1,w=Object.create(null)){if(this.pdfDocument){for(const U of this._pages)U.update(w);t(this,l)!==null&&(clearTimeout(t(this,l)),Z(this,l,null)),s||this.update()}}}r=new WeakMap,d=new WeakMap,T=new WeakMap,o=new WeakMap,E=new WeakMap,W=new WeakMap,D=new WeakMap,B=new WeakMap,z=new WeakMap,M=new WeakMap,Q=new WeakMap,y=new WeakMap,C=new WeakMap,rt=new WeakMap,O=new WeakMap,l=new WeakMap,h=new WeakMap,A=new WeakSet,$n=function(){const s=this;return{get annotationEditorUIManager(){return t(s,o)},get annotationStorage(){var w;return(w=s.pdfDocument)==null?void 0:w.annotationStorage},get downloadManager(){return s.downloadManager},get enableScripting(){return!!s._scriptingManager},get fieldObjectsPromise(){var w;return(w=s.pdfDocument)==null?void 0:w.getFieldObjects()},get findController(){return s.findController},get hasJSActionsPromise(){var w;return(w=s.pdfDocument)==null?void 0:w.hasJSActions()},get linkService(){return s.linkService}}},Gn=function(s){const w={annotationEditorMode:t(this,T),annotationMode:t(this,E),textLayerMode:t(this,h)};return s&&(!s.includes(f.PermissionFlag.COPY)&&t(this,h)===a.TextLayerMode.ENABLE&&(w.textLayerMode=a.TextLayerMode.ENABLE_PERMISSIONS),s.includes(f.PermissionFlag.MODIFY_CONTENTS)||(w.annotationEditorMode=f.AnnotationEditorType.DISABLE),!s.includes(f.PermissionFlag.MODIFY_ANNOTATIONS)&&!s.includes(f.PermissionFlag.FILL_INTERACTIVE_FORMS)&&t(this,E)===f.AnnotationMode.ENABLE_FORMS&&(w.annotationMode=f.AnnotationMode.ENABLE)),w},Xn=function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const s=new Promise(w=>{Z(this,O,()=>{document.visibilityState==="hidden"&&(w(),document.removeEventListener("visibilitychange",t(this,O)),Z(this,O,null))}),document.addEventListener("visibilitychange",t(this,O))});return Promise.race([this._onePageRenderedCapability.promise,s])},qn=function(s,w){const U=document.getSelection(),{focusNode:F,anchorNode:it}=U;if(it&&F&&U.containsNode(t(this,M))){if(t(this,z)||s===a.TextLayerMode.ENABLE_PERMISSIONS){w.preventDefault(),w.stopPropagation();return}Z(this,z,!0);const ot=this.container.style.cursor;this.container.style.cursor="wait";const At=dt=>Z(this,Q,dt.key==="Escape");window.addEventListener("keydown",At),this.getAllText().then(async dt=>{dt!==null&&await navigator.clipboard.writeText(dt)}).catch(dt=>{console.warn(`Something goes wrong when extracting the text: ${dt.message}`)}).finally(()=>{Z(this,z,!1),Z(this,Q,!1),window.removeEventListener("keydown",At),this.container.style.cursor=ot}),w.preventDefault(),w.stopPropagation()}},Ee=function(){if(this._scrollMode!==a.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const s=this._currentPageNumber,w=t(this,rt),U=this.viewer;if(U.textContent="",w.pages.length=0,this._spreadMode===a.SpreadMode.NONE&&!this.isInPresentationMode){const F=this._pages[s-1];U.append(F.div),w.pages.push(F)}else{const F=new Set,it=this._spreadMode-1;it===-1?F.add(s-1):s%2!==it?(F.add(s-1),F.add(s)):(F.add(s-2),F.add(s-1));const ot=document.createElement("div");if(ot.className="spread",this.isInPresentationMode){const At=document.createElement("div");At.className="dummyPage",ot.append(At)}for(const At of F){const dt=this._pages[At];dt&&(ot.append(dt.div),w.pages.push(dt))}U.append(ot)}w.scrollDown=s>=w.previousPageNumber,w.previousPageNumber=s},je=function(s,w=null){const{div:U,id:F}=s;if(this._currentPageNumber!==F&&this._setCurrentPageNumber(F),this._scrollMode===a.ScrollMode.PAGE&&(j(this,A,Ee).call(this),this.update()),!w&&!this.isInPresentationMode){const it=U.offsetLeft+U.clientLeft,ot=it+U.clientWidth,{scrollLeft:At,clientWidth:dt}=this.container;(this._scrollMode===a.ScrollMode.HORIZONTAL||it<At||ot>At+dt)&&(w={left:0,top:0})}(0,a.scrollIntoView)(U,w),!this._currentScaleValue&&this._location&&(this._location=null)},Yn=function(s){return s===this._currentScale||Math.abs(s-this._currentScale)<1e-15},zi=function(s,w,{noScroll:U=!1,preset:F=!1,drawingDelay:it=-1}){if(this._currentScaleValue=w.toString(),j(this,A,Yn).call(this,s)){F&&this.eventBus.dispatch("scalechanging",{source:this,scale:s,presetValue:w});return}this.viewer.style.setProperty("--scale-factor",s*f.PixelsPerInch.PDF_TO_CSS_UNITS);const ot=it>=0&&it<1e3;if(this.refresh(!0,{scale:s,drawingDelay:ot?it:-1}),ot&&Z(this,l,setTimeout(()=>{Z(this,l,null),this.refresh()},it)),this._currentScale=s,!U){let At=this._currentPageNumber,dt;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(At=this._location.pageNumber,dt=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:At,destArray:dt,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:s,presetValue:F?w:void 0}),this.defaultRenderingQueue&&this.update()},Kn=function(){return this._spreadMode!==a.SpreadMode.NONE&&this._scrollMode!==a.ScrollMode.HORIZONTAL?2:1},ie=function(s,w){let U=parseFloat(s);if(U>0)w.preset=!1,j(this,A,zi).call(this,U,s,w);else{const F=this._pages[this._currentPageNumber-1];if(!F)return;let it=a.SCROLLBAR_PADDING,ot=a.VERTICAL_PADDING;this.isInPresentationMode?(it=ot=4,this._spreadMode!==a.SpreadMode.NONE&&(it*=2)):this.removePageBorders?it=ot=0:this._scrollMode===a.ScrollMode.HORIZONTAL&&([it,ot]=[ot,it]);const At=(this.container.clientWidth-it)/F.width*F.scale/t(this,A,Kn),dt=(this.container.clientHeight-ot)/F.height*F.scale;switch(s){case"page-actual":U=1;break;case"page-width":U=At;break;case"page-height":U=dt;break;case"page-fit":U=Math.min(At,dt);break;case"auto":const Mt=(0,a.isPortraitOrientation)(F)?At:Math.min(dt,At);U=Math.min(a.MAX_AUTO_SCALE,Mt);break;default:console.error(`#setScale: "${s}" is an unknown zoom value.`);return}w.preset=!0,j(this,A,zi).call(this,U,s,w)}},$i=function(){const s=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&j(this,A,ie).call(this,this._currentScaleValue,{noScroll:!0}),j(this,A,je).call(this,s)},Jn=async function(s){var w,U;if(s.pdfPage)return s.pdfPage;try{const F=await this.pdfDocument.getPage(s.id);return s.pdfPage||s.setPdfPage(F),(U=(w=this.linkService)._cachedPageNumber)!=null&&U.call(w,F.ref)||this.linkService.cachePageRef(s.id,F.ref),F}catch(F){return console.error("Unable to get page for page view",F),null}},Qn=function(s){var w,U;if(((w=s.first)==null?void 0:w.id)===1)return!0;if(((U=s.last)==null?void 0:U.id)===this.pagesCount)return!1;switch(this._scrollMode){case a.ScrollMode.PAGE:return t(this,rt).scrollDown;case a.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},Gi=function(s=this.container.clientHeight){s!==t(this,y)&&(Z(this,y,s),a.docStyle.setProperty("--viewer-container-height",`${s}px`))},Zn=function(s){for(const w of s)if(w.target===this.container){j(this,A,Gi).call(this,Math.floor(w.borderBoxSize[0].blockSize)),Z(this,W,null);break}},V.PDFViewer=_},(et,V,R)=>{Object.defineProperty(V,"__esModule",{value:!0}),V.PDFRenderingQueue=void 0;var f=R(4),a=R(2);const N=3e4;class x{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(c){this.pdfViewer=c}setThumbnailViewer(c){this.pdfThumbnailViewer=c}isHighestPriority(c){return this.highestPriorityPage===c.renderingId}renderHighestPriority(c){var v;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(c)&&(this.isThumbnailViewEnabled&&((v=this.pdfThumbnailViewer)!=null&&v.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),N)))}getHighestPriority(c,v,b,m=!1){const u=c.views,_=u.length;if(_===0)return null;for(let r=0;r<_;r++){const d=u[r].view;if(!this.isViewFinished(d))return d}const g=c.first.id,i=c.last.id;if(i-g+1>_){const r=c.ids;for(let d=1,T=i-g;d<T;d++){const o=b?g+d:i-d;if(r.has(o))continue;const E=v[o-1];if(!this.isViewFinished(E))return E}}let e=b?i:g-2,n=v[e];return n&&!this.isViewFinished(n)||m&&(e+=b?1:-1,n=v[e],n&&!this.isViewFinished(n))?n:null}isViewFinished(c){return c.renderingState===a.RenderingStates.FINISHED}renderView(c){switch(c.renderingState){case a.RenderingStates.FINISHED:return!1;case a.RenderingStates.PAUSED:this.highestPriorityPage=c.renderingId,c.resume();break;case a.RenderingStates.RUNNING:this.highestPriorityPage=c.renderingId;break;case a.RenderingStates.INITIAL:this.highestPriorityPage=c.renderingId,c.draw().finally(()=>{this.renderHighestPriority()}).catch(v=>{v instanceof f.RenderingCancelledException||console.error(`renderView: "${v}"`)});break}return!0}}V.PDFRenderingQueue=x}],S={};function G(et){var V=S[et];if(V!==void 0)return V.exports;var R=S[et]={exports:{}};return mt[et](R,R.exports,G),R.exports}var bt={};return(()=>{var et=bt;Object.defineProperty(et,"__esModule",{value:!0}),Object.defineProperty(et,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return a.AnnotationLayerBuilder}}),Object.defineProperty(et,"DownloadManager",{enumerable:!0,get:function(){return N.DownloadManager}}),Object.defineProperty(et,"EventBus",{enumerable:!0,get:function(){return x.EventBus}}),Object.defineProperty(et,"FindState",{enumerable:!0,get:function(){return V.FindState}}),Object.defineProperty(et,"GenericL10n",{enumerable:!0,get:function(){return p.GenericL10n}}),Object.defineProperty(et,"LinkTarget",{enumerable:!0,get:function(){return R.LinkTarget}}),Object.defineProperty(et,"NullL10n",{enumerable:!0,get:function(){return c.NullL10n}}),Object.defineProperty(et,"PDFFindController",{enumerable:!0,get:function(){return V.PDFFindController}}),Object.defineProperty(et,"PDFHistory",{enumerable:!0,get:function(){return v.PDFHistory}}),Object.defineProperty(et,"PDFLinkService",{enumerable:!0,get:function(){return R.PDFLinkService}}),Object.defineProperty(et,"PDFPageView",{enumerable:!0,get:function(){return b.PDFPageView}}),Object.defineProperty(et,"PDFScriptingManager",{enumerable:!0,get:function(){return m.PDFScriptingManager}}),Object.defineProperty(et,"PDFSinglePageViewer",{enumerable:!0,get:function(){return u.PDFSinglePageViewer}}),Object.defineProperty(et,"PDFViewer",{enumerable:!0,get:function(){return _.PDFViewer}}),Object.defineProperty(et,"ProgressBar",{enumerable:!0,get:function(){return f.ProgressBar}}),Object.defineProperty(et,"RenderingStates",{enumerable:!0,get:function(){return f.RenderingStates}}),Object.defineProperty(et,"ScrollMode",{enumerable:!0,get:function(){return f.ScrollMode}}),Object.defineProperty(et,"SimpleLinkService",{enumerable:!0,get:function(){return R.SimpleLinkService}}),Object.defineProperty(et,"SpreadMode",{enumerable:!0,get:function(){return f.SpreadMode}}),Object.defineProperty(et,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return g.StructTreeLayerBuilder}}),Object.defineProperty(et,"TextLayerBuilder",{enumerable:!0,get:function(){return i.TextLayerBuilder}}),Object.defineProperty(et,"XfaLayerBuilder",{enumerable:!0,get:function(){return e.XfaLayerBuilder}}),Object.defineProperty(et,"parseQueryString",{enumerable:!0,get:function(){return f.parseQueryString}});var V=G(1),R=G(5),f=G(2),a=G(6),N=G(8),x=G(9),p=G(10),c=G(7),v=G(12),b=G(13),m=G(21),u=G(24),_=G(25),g=G(16),i=G(19),e=G(20)})(),bt})())})(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;const workerSrc="/assets/pdf.worker.min-DKQKFyKK.js",_hoisted_1$1={class:"pdf-root"},_hoisted_2$1={key:0,class:"error"},_hoisted_3$1={key:1,class:"viewer"},_hoisted_4$1={key:0,class:"loading"},_sfc_main$1=defineComponent({__name:"PdfView",props:{src:{},sources:{},paperId:{},zoom:{},fit:{type:Boolean}},emits:["anchorCreated"],setup(Ct,{emit:L}){pdfExports.GlobalWorkerOptions.workerSrc=workerSrc;const mt=L,S=Ct,G=ref(null),bt=ref(!0),et=ref("");let V=!1,R=0,f=[];const a={};async function N(u){return await pdfExports.getDocument({url:u,withCredentials:!1}).promise}function x(u,_,g){const i=f[u];if(!i)return;let e=i.querySelector(".overlay");e||(e=document.createElement("div"),e.className="overlay",i.appendChild(e));const n=i.clientWidth,r=i.clientHeight;e.innerHTML="";const d=a[u]||[];for(const T of d){const o=document.createElement("div");o.className="hl",o.style.left=`${Math.round(T.x*n)}px`,o.style.top=`${Math.round(T.y*r)}px`,o.style.width=`${Math.round(T.w*n)}px`,o.style.height=`${Math.round(T.h*r)}px`,e.appendChild(o)}}function p(u){try{const _=u.match(/p=(\d+)/),g=_?parseInt(_[1],10):void 0,i=u.split("rects=")[1],e=[];if(i)for(const n of i.split("|")){const r=n.split(",").map(d=>parseFloat(d));if(r.length===4&&r.every(d=>!Number.isNaN(d))){const d=T=>Math.max(0,Math.min(1,T));e.push({x:d(r[0]),y:d(r[1]),w:d(r[2]),h:d(r[3])})}}return{page:g,rects:e}}catch{return{}}}async function c(){if(S.paperId)try{const{anchored:u}=await __vitePreload(async()=>{const{anchored:g}=await import("./index-Bgr5SMnN.js").then(i=>i.z);return{anchored:g}},__vite__mapDeps([0,1])),{anchors:_}=await u.listByPaper({paperId:S.paperId});for(const g of _){const{page:i,rects:e}=p(g.ref||"");if(i!=null&&e&&e.length){const n=i-1;a[n]=(a[n]||[]).concat(e)}}}catch{}}async function v(){const u=++R;et.value="",bt.value=!0,G.value&&(G.value.innerHTML=""),f.forEach(_=>_==null?void 0:_.remove()),f=[],Object.keys(a).forEach(_=>delete a[_]);try{const _=(S.sources&&S.sources.length?S.sources:S.src?[S.src]:[]).filter(Boolean);if(!_.length)throw new Error("No PDF source provided");let g=null,i=null;for(const T of _)try{if(g=await N(T),g)break}catch(o){i=o;continue}if(!g)throw i??new Error("Failed to load PDF");if(f=[],await c(),V||u!==R)return;const e=g.numPages,n=new pdf_viewerExports.EventBus,r=G.value,d=r.clientWidth||800;for(let T=1;T<=e;T++){if(V||u!==R)return;const o=await g.getPage(T),E=document.createElement("div");E.className="page-wrapper",r.appendChild(E),f[T-1]=E;const W=o.getViewport({scale:1}),D=d,B=S.zoom??1,M=S.fit??!0?D/W.width*B:B,Q=new pdf_viewerExports.PDFPageView({container:E,id:T,scale:M,defaultViewport:W,eventBus:n,textLayerMode:1,annotationMode:1});await Q.setPdfPage(o),await Q.draw(),x(T-1,0,0)}}catch(_){et.value=(_==null?void 0:_.message)??String(_)}finally{bt.value=!1}}onMounted(()=>{V=!1,v(),document.addEventListener("mouseup",m)}),onBeforeUnmount(()=>{V=!0,document.removeEventListener("mouseup",m)}),watch(()=>[S.src,S.sources,S.zoom,S.fit],()=>{V=!1,v()});function b(){const u=window.getSelection();return u?u.toString().trim():""}function m(){const u=window.getSelection();if(!u||u.rangeCount===0)return;const _=b();if(!_)return;let g=-1;for(let o=0;o<f.length;o++)if(f[o]&&(f[o].contains(u.anchorNode)||f[o].contains(u.focusNode))){g=o;break}if(g<0)return;const e=f[g].querySelector(".textLayer");if(!e)return;const n=e.getBoundingClientRect(),r=u.getRangeAt(0),d=Array.from(r.getClientRects());if(!d.length||!confirm("Highlight & discuss this selection?"))return;const T=[];for(const o of d.slice(0,8)){const E=(o.left-n.left)/n.width,W=(o.top-n.top)/n.height,D=o.width/n.width,B=o.height/n.height;D>0&&B>0&&E>=0&&W>=0&&E<=1&&W<=1&&T.push({x:E,y:W,w:D,h:B})}T.length&&(async()=>{try{if(!S.paperId)return;const{anchored:o}=await __vitePreload(async()=>{const{anchored:B}=await import("./index-Bgr5SMnN.js").then(z=>z.z);return{anchored:B}},__vite__mapDeps([0,1])),E=T.map(B=>[B.x,B.y,B.w,B.h].map(z=>Number(z.toFixed(4))).join(",")).join("|"),W=`p=${g+1};rects=${E}`,{anchorId:D}=await o.create({paperId:S.paperId,kind:"Lines",ref:W,snippet:_.slice(0,300)});a[g]=(a[g]||[]).concat(T),x(g,0,0),mt("anchorCreated",D);try{window.dispatchEvent(new CustomEvent("anchor-created",{detail:D}))}catch{}try{u.removeAllRanges()}catch{}}catch(o){console.error("Failed to create anchor",o)}})()}return(u,_)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[et.value?(openBlock(),createElementBlock("div",_hoisted_2$1,toDisplayString(et.value),1)):(openBlock(),createElementBlock("div",_hoisted_3$1,[bt.value?(openBlock(),createElementBlock("div",_hoisted_4$1,"Loading PDF…")):createCommentVNode("",!0),createBaseVNode("div",{ref_key:"pagesContainer",ref:G,class:"pages"},null,512)]))]))}}),PdfView=_export_sfc(_sfc_main$1,[["__scopeId","data-v-75836cc0"]]),_hoisted_1={class:"paper"},_hoisted_2={class:"card header"},_hoisted_3={class:"title-row"},_hoisted_4={class:"title"},_hoisted_5={class:"actions"},_hoisted_6=["href"],_hoisted_7={class:"meta"},_hoisted_8={key:0},_hoisted_9=["href"],_hoisted_10={key:1},_hoisted_11={key:0,class:"banner"},_hoisted_12={class:"columns"},_hoisted_13={class:"center"},_hoisted_14={class:"pdf-scroll"},_hoisted_15={class:"toolbar"},_hoisted_16={class:"z"},_sfc_main=defineComponent({__name:"PaperPage",props:{id:{}},setup(Ct){const L=Ct,mt=ref(L.id),S=reactive({}),G=useSessionStore(),bt=ref(""),et=computed(()=>`${BASE_URL}/pdf/${encodeURIComponent(mt.value)}`),V=computed(()=>`https://arxiv.org/pdf/${encodeURIComponent(mt.value)}.pdf`),R=ref(1),f=ref(!0);onMounted(async()=>{try{if(!/^\d{4}\.\d{4,5}(v\d+)?$/.test(L.id)){window.location.assign(`/search?q=${encodeURIComponent(L.id)}`);return}const{id:u,title:_}=await paper.get({id:mt.value});S.title=_,S.doi=mt.value,S.link=`https://arxiv.org/abs/${encodeURIComponent(mt.value)}`,_||(bt.value="This paper is not yet in your index.")}catch{}});function a(){}const N=computed(()=>mt.value);function x(){if(!G.userId){alert("Please sign in first.");return}const m=`library:${G.userId}`,u=JSON.parse(localStorage.getItem(m)||"[]");u.includes(N.value)||(u.push(N.value),localStorage.setItem(m,JSON.stringify(u)))}async function p(){try{await paper.ensure({id:mt.value});const{title:m}=await paper.get({id:mt.value});S.title=m,bt.value=""}catch(m){bt.value=String((m==null?void 0:m.message)??"Failed to ensure paper")}}function c(){f.value=!1,R.value=Math.min(R.value+.1,3)}function v(){f.value=!1,R.value=Math.max(R.value-.1,.3)}function b(){f.value=!0}return(m,u)=>(openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("header",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("h2",_hoisted_4,toDisplayString(S.title||N.value),1),createBaseVNode("div",_hoisted_5,[createBaseVNode("a",{class:"ghost",href:V.value,target:"_blank",rel:"noreferrer"},"Open PDF",8,_hoisted_6),createBaseVNode("button",{class:"primary",onClick:a},"Add Anchor"),createBaseVNode("button",{class:"ghost",onClick:x},"Add to library"),u[0]||(u[0]=createBaseVNode("a",{class:"ghost",href:"/"},"Back to Feed",-1))])]),createBaseVNode("div",_hoisted_7,[S.doi?(openBlock(),createElementBlock("span",_hoisted_8,[createBaseVNode("a",{href:S.link,target:"_blank",rel:"noreferrer"},toDisplayString(S.doi),9,_hoisted_9)])):createCommentVNode("",!0),S.authors?(openBlock(),createElementBlock("span",_hoisted_10," · "+toDisplayString(S.authors),1)):createCommentVNode("",!0)]),bt.value?(openBlock(),createElementBlock("p",_hoisted_11,[createTextVNode(toDisplayString(bt.value)+" ",1),createBaseVNode("button",{class:"primary inline",onClick:p},"Ensure")])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_12,[createBaseVNode("section",_hoisted_13,[createBaseVNode("div",_hoisted_14,[createBaseVNode("div",_hoisted_15,[createBaseVNode("button",{class:"ghost",onClick:v},"-"),createBaseVNode("span",_hoisted_16,toDisplayString(Math.round(R.value*100))+"%",1),createBaseVNode("button",{class:"ghost",onClick:c},"+"),createBaseVNode("button",{class:"ghost",onClick:b},"Fit width")]),createVNode(PdfView,{paperId:N.value,sources:[et.value,V.value],zoom:R.value,fit:f.value},null,8,["paperId","sources","zoom","fit"])])])])]))}}),PaperPage=_export_sfc(_sfc_main,[["__scopeId","data-v-f11de190"]]);export{PaperPage as default};
